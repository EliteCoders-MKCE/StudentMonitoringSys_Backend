/*! For license information please see 3.d233d165.chunk.js.LICENSE.txt */
(this["webpackJsonpstudent-monitoring"]=this["webpackJsonpstudent-monitoring"]||[]).push([[3],Array(65).concat([function(t,e,n){"use strict";n.r(e),n.d(e,"AdadeltaOptimizer",(function(){return Pe})),n.d(e,"AdagradOptimizer",(function(){return Be})),n.d(e,"AdamOptimizer",(function(){return Ue})),n.d(e,"AdamaxOptimizer",(function(){return He})),n.d(e,"MomentumOptimizer",(function(){return Ke})),n.d(e,"Optimizer",(function(){return Me})),n.d(e,"RMSPropOptimizer",(function(){return Xe})),n.d(e,"SGDOptimizer",(function(){return qe})),n.d(e,"Tensor",(function(){return ft.a})),n.d(e,"TensorBuffer",(function(){return ft.b})),n.d(e,"Variable",(function(){return ft.c})),n.d(e,"Rank",(function(){return Ye.a})),n.d(e,"sumOutType",(function(){return Ye.b})),n.d(e,"upcastType",(function(){return Ye.c})),n.d(e,"abs",(function(){return Qe.b})),n.d(e,"acos",(function(){return Qe.c})),n.d(e,"acosh",(function(){return Qe.d})),n.d(e,"add",(function(){return Qe.e})),n.d(e,"addN",(function(){return Qe.f})),n.d(e,"all",(function(){return Qe.g})),n.d(e,"any",(function(){return Qe.h})),n.d(e,"argMax",(function(){return Qe.i})),n.d(e,"argMin",(function(){return Qe.j})),n.d(e,"asin",(function(){return Qe.k})),n.d(e,"asinh",(function(){return Qe.l})),n.d(e,"atan",(function(){return Qe.m})),n.d(e,"atan2",(function(){return Qe.n})),n.d(e,"atanh",(function(){return Qe.o})),n.d(e,"avgPool",(function(){return Qe.p})),n.d(e,"avgPool3d",(function(){return Qe.q})),n.d(e,"basicLSTMCell",(function(){return Qe.r})),n.d(e,"batchToSpaceND",(function(){return Qe.w})),n.d(e,"batchNorm",(function(){return Qe.s})),n.d(e,"batchNorm2d",(function(){return Qe.t})),n.d(e,"batchNorm3d",(function(){return Qe.u})),n.d(e,"batchNorm4d",(function(){return Qe.v})),n.d(e,"bincount",(function(){return Qe.x})),n.d(e,"broadcastTo",(function(){return Qe.z})),n.d(e,"buffer",(function(){return Qe.A})),n.d(e,"cast",(function(){return Qe.B})),n.d(e,"ceil",(function(){return Qe.C})),n.d(e,"clipByValue",(function(){return Qe.D})),n.d(e,"clone",(function(){return Qe.E})),n.d(e,"complex",(function(){return Qe.F})),n.d(e,"concat",(function(){return Qe.G})),n.d(e,"concat1d",(function(){return Qe.H})),n.d(e,"concat2d",(function(){return Qe.I})),n.d(e,"concat3d",(function(){return Qe.J})),n.d(e,"concat4d",(function(){return Qe.K})),n.d(e,"conv1d",(function(){return Qe.L})),n.d(e,"conv2d",(function(){return Qe.M})),n.d(e,"conv2dTranspose",(function(){return Qe.N})),n.d(e,"conv3d",(function(){return Qe.O})),n.d(e,"conv3dTranspose",(function(){return Qe.P})),n.d(e,"cos",(function(){return Qe.Q})),n.d(e,"cosh",(function(){return Qe.R})),n.d(e,"cumsum",(function(){return Qe.T})),n.d(e,"denseBincount",(function(){return Qe.U})),n.d(e,"depthToSpace",(function(){return Qe.V})),n.d(e,"depthwiseConv2d",(function(){return Qe.W})),n.d(e,"diag",(function(){return Qe.X})),n.d(e,"dilation2d",(function(){return Qe.Y})),n.d(e,"div",(function(){return Qe.Z})),n.d(e,"divNoNan",(function(){return Qe.ab})),n.d(e,"dot",(function(){return Qe.bb})),n.d(e,"einsum",(function(){return Qe.db})),n.d(e,"elu",(function(){return Qe.eb})),n.d(e,"equal",(function(){return Qe.gb})),n.d(e,"erf",(function(){return Qe.hb})),n.d(e,"exp",(function(){return Qe.ib})),n.d(e,"expandDims",(function(){return Qe.jb})),n.d(e,"expm1",(function(){return Qe.kb})),n.d(e,"eye",(function(){return Qe.lb})),n.d(e,"fill",(function(){return Qe.nb})),n.d(e,"floor",(function(){return Qe.ob})),n.d(e,"floorDiv",(function(){return Qe.pb})),n.d(e,"gather",(function(){return Qe.rb})),n.d(e,"greater",(function(){return Qe.tb})),n.d(e,"greaterEqual",(function(){return Qe.ub})),n.d(e,"imag",(function(){return Qe.wb})),n.d(e,"isFinite",(function(){return Qe.Ab})),n.d(e,"isInf",(function(){return Qe.Bb})),n.d(e,"isNaN",(function(){return Qe.Cb})),n.d(e,"leakyRelu",(function(){return Qe.Db})),n.d(e,"less",(function(){return Qe.Eb})),n.d(e,"lessEqual",(function(){return Qe.Fb})),n.d(e,"linspace",(function(){return Qe.Hb})),n.d(e,"localResponseNormalization",(function(){return Qe.Ib})),n.d(e,"log",(function(){return Qe.Jb})),n.d(e,"log1p",(function(){return Qe.Kb})),n.d(e,"logSigmoid",(function(){return Qe.Lb})),n.d(e,"logSoftmax",(function(){return Qe.Mb})),n.d(e,"logSumExp",(function(){return Qe.Nb})),n.d(e,"logicalAnd",(function(){return Qe.Ob})),n.d(e,"logicalNot",(function(){return Qe.Pb})),n.d(e,"logicalOr",(function(){return Qe.Qb})),n.d(e,"logicalXor",(function(){return Qe.Rb})),n.d(e,"matMul",(function(){return Qe.Tb})),n.d(e,"max",(function(){return Qe.Ub})),n.d(e,"maxPool",(function(){return Qe.Vb})),n.d(e,"maxPool3d",(function(){return Qe.Wb})),n.d(e,"maxPoolWithArgmax",(function(){return Qe.Xb})),n.d(e,"maximum",(function(){return Qe.Yb})),n.d(e,"mean",(function(){return Qe.Zb})),n.d(e,"meshgrid",(function(){return Qe.ac})),n.d(e,"min",(function(){return Qe.bc})),n.d(e,"minimum",(function(){return Qe.cc})),n.d(e,"mirrorPad",(function(){return Qe.dc})),n.d(e,"mod",(function(){return Qe.ec})),n.d(e,"moments",(function(){return Qe.fc})),n.d(e,"mul",(function(){return Qe.hc})),n.d(e,"multiRNNCell",(function(){return Qe.ic})),n.d(e,"multinomial",(function(){return Qe.jc})),n.d(e,"neg",(function(){return Qe.kc})),n.d(e,"notEqual",(function(){return Qe.mc})),n.d(e,"oneHot",(function(){return Qe.nc})),n.d(e,"ones",(function(){return Qe.oc})),n.d(e,"onesLike",(function(){return Qe.pc})),n.d(e,"outerProduct",(function(){return Qe.rc})),n.d(e,"pad",(function(){return Qe.sc})),n.d(e,"pad1d",(function(){return Qe.tc})),n.d(e,"pad2d",(function(){return Qe.uc})),n.d(e,"pad3d",(function(){return Qe.vc})),n.d(e,"pad4d",(function(){return Qe.wc})),n.d(e,"pool",(function(){return Qe.xc})),n.d(e,"pow",(function(){return Qe.yc})),n.d(e,"prelu",(function(){return Qe.zc})),n.d(e,"print",(function(){return Qe.Ac})),n.d(e,"prod",(function(){return Qe.Bc})),n.d(e,"rand",(function(){return Qe.Cc})),n.d(e,"randomGamma",(function(){return Qe.Dc})),n.d(e,"randomNormal",(function(){return Qe.Ec})),n.d(e,"randomUniform",(function(){return Qe.Fc})),n.d(e,"range",(function(){return Qe.Gc})),n.d(e,"real",(function(){return Qe.Hc})),n.d(e,"reciprocal",(function(){return Qe.Ic})),n.d(e,"relu",(function(){return Qe.Jc})),n.d(e,"relu6",(function(){return Qe.Kc})),n.d(e,"reshape",(function(){return Qe.Lc})),n.d(e,"reverse",(function(){return Qe.Mc})),n.d(e,"reverse1d",(function(){return Qe.Nc})),n.d(e,"reverse2d",(function(){return Qe.Oc})),n.d(e,"reverse3d",(function(){return Qe.Pc})),n.d(e,"reverse4d",(function(){return Qe.Qc})),n.d(e,"round",(function(){return Qe.Sc})),n.d(e,"rsqrt",(function(){return Qe.Tc})),n.d(e,"scalar",(function(){return Qe.Uc})),n.d(e,"selu",(function(){return Qe.Wc})),n.d(e,"separableConv2d",(function(){return Qe.Xc})),n.d(e,"setdiff1dAsync",(function(){return Qe.Yc})),n.d(e,"sigmoid",(function(){return Qe.Zc})),n.d(e,"sign",(function(){return Qe.ad})),n.d(e,"sin",(function(){return Qe.cd})),n.d(e,"sinh",(function(){return Qe.dd})),n.d(e,"slice",(function(){return Qe.ed})),n.d(e,"slice1d",(function(){return Qe.fd})),n.d(e,"slice2d",(function(){return Qe.gd})),n.d(e,"slice3d",(function(){return Qe.hd})),n.d(e,"slice4d",(function(){return Qe.id})),n.d(e,"softmax",(function(){return Qe.jd})),n.d(e,"softplus",(function(){return Qe.kd})),n.d(e,"spaceToBatchND",(function(){return Qe.ld})),n.d(e,"fft",(function(){return Qe.mb})),n.d(e,"ifft",(function(){return Qe.vb})),n.d(e,"irfft",(function(){return Qe.zb})),n.d(e,"rfft",(function(){return Qe.Rc})),n.d(e,"split",(function(){return Qe.pd})),n.d(e,"sqrt",(function(){return Qe.qd})),n.d(e,"square",(function(){return Qe.rd})),n.d(e,"squaredDifference",(function(){return Qe.sd})),n.d(e,"squeeze",(function(){return Qe.td})),n.d(e,"stack",(function(){return Qe.ud})),n.d(e,"step",(function(){return Qe.vd})),n.d(e,"stridedSlice",(function(){return Qe.wd})),n.d(e,"sub",(function(){return Qe.yd})),n.d(e,"sum",(function(){return Qe.zd})),n.d(e,"tan",(function(){return Qe.Ad})),n.d(e,"tanh",(function(){return Qe.Bd})),n.d(e,"tensor",(function(){return Qe.Cd})),n.d(e,"tensor1d",(function(){return Qe.Dd})),n.d(e,"tensor2d",(function(){return Qe.Ed})),n.d(e,"tensor3d",(function(){return Qe.Fd})),n.d(e,"tensor4d",(function(){return Qe.Gd})),n.d(e,"tensor5d",(function(){return Qe.Hd})),n.d(e,"tensor6d",(function(){return Qe.Id})),n.d(e,"tile",(function(){return Qe.Jd})),n.d(e,"topk",(function(){return Qe.Kd})),n.d(e,"truncatedNormal",(function(){return Qe.Md})),n.d(e,"unique",(function(){return Qe.Nd})),n.d(e,"unsortedSegmentSum",(function(){return Qe.Od})),n.d(e,"unstack",(function(){return Qe.Pd})),n.d(e,"variable",(function(){return Qe.Qd})),n.d(e,"where",(function(){return Qe.Rd})),n.d(e,"whereAsync",(function(){return Qe.Sd})),n.d(e,"zeros",(function(){return Qe.Td})),n.d(e,"zerosLike",(function(){return Qe.Ud})),n.d(e,"booleanMaskAsync",(function(){return Qe.y})),n.d(e,"transpose",(function(){return Qe.Ld})),n.d(e,"norm",(function(){return Qe.lc})),n.d(e,"movingAverage",(function(){return Qe.gc})),n.d(e,"scatterND",(function(){return Qe.Vc})),n.d(e,"sparseToDense",(function(){return Qe.nd})),n.d(e,"gatherND",(function(){return Qe.sb})),n.d(e,"dropout",(function(){return Qe.cb})),n.d(e,"enclosingPowerOfTwo",(function(){return Qe.fb})),n.d(e,"cosineWindow",(function(){return Qe.S})),n.d(e,"inTopKAsync",(function(){return Qe.yb})),n.d(e,"op",(function(){return Qe.qc})),n.d(e,"OP_SCOPE_SUFFIX",(function(){return Qe.a})),n.d(e,"image",(function(){return Qe.xb})),n.d(e,"linalg",(function(){return Qe.Gb})),n.d(e,"losses",(function(){return Qe.Sb})),n.d(e,"spectral",(function(){return Qe.od})),n.d(e,"fused",(function(){return Qe.qb})),n.d(e,"signal",(function(){return Qe.bd})),n.d(e,"sparse",(function(){return Qe.md})),n.d(e,"string",(function(){return Qe.xd})),n.d(e,"Reduction",(function(){return Ze.a})),n.d(e,"train",(function(){return $e})),n.d(e,"enableProdMode",(function(){return Ne.g})),n.d(e,"enableDebugMode",(function(){return Ne.f})),n.d(e,"disableDeprecationWarnings",(function(){return Ne.c})),n.d(e,"deprecationWarn",(function(){return Ne.b})),n.d(e,"disposeVariables",(function(){return Ne.e})),n.d(e,"engine",(function(){return Ne.h})),n.d(e,"memory",(function(){return Ne.m})),n.d(e,"profile",(function(){return Ne.n})),n.d(e,"tidy",(function(){return Ne.t})),n.d(e,"dispose",(function(){return Ne.d})),n.d(e,"keep",(function(){return Ne.l})),n.d(e,"time",(function(){return Ne.u})),n.d(e,"setBackend",(function(){return Ne.r})),n.d(e,"ready",(function(){return Ne.o})),n.d(e,"getBackend",(function(){return Ne.k})),n.d(e,"removeBackend",(function(){return Ne.q})),n.d(e,"findBackend",(function(){return Ne.i})),n.d(e,"findBackendFactory",(function(){return Ne.j})),n.d(e,"registerBackend",(function(){return Ne.p})),n.d(e,"backend",(function(){return Ne.a})),n.d(e,"setPlatform",(function(){return Ne.s})),n.d(e,"getKernel",(function(){return Ht.c})),n.d(e,"getGradient",(function(){return Ht.b})),n.d(e,"getKernelsForBackend",(function(){return Ht.d})),n.d(e,"registerKernel",(function(){return Ht.f})),n.d(e,"registerGradient",(function(){return Ht.e})),n.d(e,"unregisterKernel",(function(){return Ht.h})),n.d(e,"unregisterGradient",(function(){return Ht.g})),n.d(e,"copyRegisteredKernels",(function(){return Ht.a})),n.d(e,"customGrad",(function(){return Fe.a})),n.d(e,"grad",(function(){return Fe.b})),n.d(e,"grads",(function(){return Fe.c})),n.d(e,"valueAndGrad",(function(){return Fe.d})),n.d(e,"valueAndGrads",(function(){return Fe.e})),n.d(e,"variableGrads",(function(){return Fe.f})),n.d(e,"Environment",(function(){return b.b})),n.d(e,"env",(function(){return b.c})),n.d(e,"ENV",(function(){return b.a})),n.d(e,"version_core",(function(){return je})),n.d(e,"nextFrame",(function(){return tn.a})),n.d(e,"browser",(function(){return o})),n.d(e,"io",(function(){return r})),n.d(e,"math",(function(){return a})),n.d(e,"serialization",(function(){return u})),n.d(e,"test_util",(function(){return we})),n.d(e,"util",(function(){return ke})),n.d(e,"backend_util",(function(){return l})),n.d(e,"tensor_util",(function(){return Oe})),n.d(e,"slice_util",(function(){return c})),n.d(e,"gather_util",(function(){return i})),n.d(e,"scatter_util",(function(){return ee})),n.d(e,"device_util",(function(){return Xn})),n.d(e,"kernel_impls",(function(){return d})),n.d(e,"KernelBackend",(function(){return Zn.b})),n.d(e,"DataStorage",(function(){return Zn.a})),n.d(e,"Abs",(function(){return Gt.a})),n.d(e,"Acos",(function(){return Gt.b})),n.d(e,"Acosh",(function(){return Gt.c})),n.d(e,"Add",(function(){return Gt.d})),n.d(e,"AddN",(function(){return Gt.e})),n.d(e,"All",(function(){return Gt.f})),n.d(e,"Any",(function(){return Gt.g})),n.d(e,"ArgMax",(function(){return Gt.h})),n.d(e,"ArgMin",(function(){return Gt.i})),n.d(e,"Asin",(function(){return Gt.j})),n.d(e,"Asinh",(function(){return Gt.k})),n.d(e,"Atan",(function(){return Gt.l})),n.d(e,"Atanh",(function(){return Gt.n})),n.d(e,"Atan2",(function(){return Gt.m})),n.d(e,"AvgPool",(function(){return Gt.o})),n.d(e,"AvgPoolGrad",(function(){return Gt.r})),n.d(e,"AvgPool3D",(function(){return Gt.p})),n.d(e,"AvgPool3DGrad",(function(){return Gt.q})),n.d(e,"BatchMatMul",(function(){return Gt.s})),n.d(e,"BatchToSpaceND",(function(){return Gt.t})),n.d(e,"Bincount",(function(){return Gt.u})),n.d(e,"BroadcastTo",(function(){return Gt.v})),n.d(e,"Cast",(function(){return Gt.w})),n.d(e,"Ceil",(function(){return Gt.x})),n.d(e,"ClipByValue",(function(){return Gt.y})),n.d(e,"Complex",(function(){return Gt.z})),n.d(e,"ComplexAbs",(function(){return Gt.A})),n.d(e,"Concat",(function(){return Gt.B})),n.d(e,"Conv2D",(function(){return Gt.C})),n.d(e,"Conv2DBackpropFilter",(function(){return Gt.D})),n.d(e,"Conv2DBackpropInput",(function(){return Gt.E})),n.d(e,"Conv3D",(function(){return Gt.F})),n.d(e,"Conv3DBackpropFilterV2",(function(){return Gt.G})),n.d(e,"Conv3DBackpropInputV2",(function(){return Gt.H})),n.d(e,"Cos",(function(){return Gt.I})),n.d(e,"Cosh",(function(){return Gt.J})),n.d(e,"Cumsum",(function(){return Gt.L})),n.d(e,"CropAndResize",(function(){return Gt.K})),n.d(e,"DenseBincount",(function(){return Gt.M})),n.d(e,"DepthToSpace",(function(){return Gt.N})),n.d(e,"DepthwiseConv2dNative",(function(){return Gt.O})),n.d(e,"DepthwiseConv2dNativeBackpropFilter",(function(){return Gt.P})),n.d(e,"DepthwiseConv2dNativeBackpropInput",(function(){return Gt.Q})),n.d(e,"Diag",(function(){return Gt.R})),n.d(e,"Dilation2D",(function(){return Gt.S})),n.d(e,"Dilation2DBackpropInput",(function(){return Gt.U})),n.d(e,"Dilation2DBackpropFilter",(function(){return Gt.T})),n.d(e,"RealDiv",(function(){return Gt.lc})),n.d(e,"Einsum",(function(){return Gt.V})),n.d(e,"Elu",(function(){return Gt.W})),n.d(e,"EluGrad",(function(){return Gt.X})),n.d(e,"Erf",(function(){return Gt.Z})),n.d(e,"Equal",(function(){return Gt.Y})),n.d(e,"Exp",(function(){return Gt.ab})),n.d(e,"ExpandDims",(function(){return Gt.bb})),n.d(e,"Expm1",(function(){return Gt.cb})),n.d(e,"FFT",(function(){return Gt.db})),n.d(e,"Fill",(function(){return Gt.eb})),n.d(e,"FlipLeftRight",(function(){return Gt.fb})),n.d(e,"Floor",(function(){return Gt.gb})),n.d(e,"FloorDiv",(function(){return Gt.hb})),n.d(e,"FusedBatchNorm",(function(){return Gt.jb})),n.d(e,"GatherV2",(function(){return Gt.nb})),n.d(e,"GatherNd",(function(){return Gt.mb})),n.d(e,"Greater",(function(){return Gt.ob})),n.d(e,"GreaterEqual",(function(){return Gt.pb})),n.d(e,"Identity",(function(){return Gt.rb})),n.d(e,"IFFT",(function(){return Gt.qb})),n.d(e,"Imag",(function(){return Gt.sb})),n.d(e,"IsFinite",(function(){return Gt.tb})),n.d(e,"IsInf",(function(){return Gt.ub})),n.d(e,"IsNan",(function(){return Gt.vb})),n.d(e,"LeakyRelu",(function(){return Gt.yb})),n.d(e,"Less",(function(){return Gt.zb})),n.d(e,"LessEqual",(function(){return Gt.Ab})),n.d(e,"LinSpace",(function(){return Gt.Bb})),n.d(e,"Log",(function(){return Gt.Cb})),n.d(e,"Log1p",(function(){return Gt.Db})),n.d(e,"LogicalAnd",(function(){return Gt.Fb})),n.d(e,"LogicalNot",(function(){return Gt.Gb})),n.d(e,"LogicalOr",(function(){return Gt.Hb})),n.d(e,"LogSoftmax",(function(){return Gt.Eb})),n.d(e,"LRN",(function(){return Gt.wb})),n.d(e,"LRNGrad",(function(){return Gt.xb})),n.d(e,"Max",(function(){return Gt.Ib})),n.d(e,"Maximum",(function(){return Gt.Ob})),n.d(e,"MaxPool",(function(){return Gt.Jb})),n.d(e,"MaxPoolGrad",(function(){return Gt.Mb})),n.d(e,"MaxPool3D",(function(){return Gt.Kb})),n.d(e,"MaxPool3DGrad",(function(){return Gt.Lb})),n.d(e,"MaxPoolWithArgmax",(function(){return Gt.Nb})),n.d(e,"Mean",(function(){return Gt.Pb})),n.d(e,"Min",(function(){return Gt.Qb})),n.d(e,"Minimum",(function(){return Gt.Rb})),n.d(e,"MirrorPad",(function(){return Gt.Sb})),n.d(e,"Mod",(function(){return Gt.Tb})),n.d(e,"Multinomial",(function(){return Gt.Ub})),n.d(e,"Multiply",(function(){return Gt.Vb})),n.d(e,"Neg",(function(){return Gt.Wb})),n.d(e,"NotEqual",(function(){return Gt.ac})),n.d(e,"NonMaxSuppressionV3",(function(){return Gt.Xb})),n.d(e,"NonMaxSuppressionV4",(function(){return Gt.Yb})),n.d(e,"NonMaxSuppressionV5",(function(){return Gt.Zb})),n.d(e,"OnesLike",(function(){return Gt.cc})),n.d(e,"OneHot",(function(){return Gt.bc})),n.d(e,"Pack",(function(){return Gt.dc})),n.d(e,"PadV2",(function(){return Gt.ec})),n.d(e,"Pool",(function(){return Gt.fc})),n.d(e,"Pow",(function(){return Gt.gc})),n.d(e,"Prelu",(function(){return Gt.hc})),n.d(e,"Prod",(function(){return Gt.ic})),n.d(e,"Range",(function(){return Gt.jc})),n.d(e,"Real",(function(){return Gt.kc})),n.d(e,"Reciprocal",(function(){return Gt.mc})),n.d(e,"Relu",(function(){return Gt.nc})),n.d(e,"Reshape",(function(){return Gt.pc})),n.d(e,"ResizeNearestNeighbor",(function(){return Gt.sc})),n.d(e,"ResizeNearestNeighborGrad",(function(){return Gt.tc})),n.d(e,"ResizeBilinear",(function(){return Gt.qc})),n.d(e,"ResizeBilinearGrad",(function(){return Gt.rc})),n.d(e,"Relu6",(function(){return Gt.oc})),n.d(e,"Reverse",(function(){return Gt.uc})),n.d(e,"Round",(function(){return Gt.wc})),n.d(e,"Rsqrt",(function(){return Gt.xc})),n.d(e,"ScatterNd",(function(){return Gt.yc})),n.d(e,"Select",(function(){return Gt.zc})),n.d(e,"Selu",(function(){return Gt.Ac})),n.d(e,"Slice",(function(){return Gt.Fc})),n.d(e,"Sin",(function(){return Gt.Dc})),n.d(e,"Sinh",(function(){return Gt.Ec})),n.d(e,"Sign",(function(){return Gt.Cc})),n.d(e,"Sigmoid",(function(){return Gt.Bc})),n.d(e,"Softplus",(function(){return Gt.Hc})),n.d(e,"Sqrt",(function(){return Gt.Pc})),n.d(e,"Sum",(function(){return Gt.Yc})),n.d(e,"SpaceToBatchND",(function(){return Gt.Ic})),n.d(e,"SplitV",(function(){return Gt.Oc})),n.d(e,"Softmax",(function(){return Gt.Gc})),n.d(e,"SparseFillEmptyRows",(function(){return Gt.Jc})),n.d(e,"SparseReshape",(function(){return Gt.Kc})),n.d(e,"SparseSegmentMean",(function(){return Gt.Lc})),n.d(e,"SparseSegmentSum",(function(){return Gt.Mc})),n.d(e,"SparseToDense",(function(){return Gt.Nc})),n.d(e,"SquaredDifference",(function(){return Gt.Rc})),n.d(e,"Square",(function(){return Gt.Qc})),n.d(e,"StridedSlice",(function(){return Gt.Tc})),n.d(e,"StringNGrams",(function(){return Gt.Uc})),n.d(e,"StringSplit",(function(){return Gt.Vc})),n.d(e,"StringToHashBucketFast",(function(){return Gt.Wc})),n.d(e,"Sub",(function(){return Gt.Xc})),n.d(e,"Tan",(function(){return Gt.Zc})),n.d(e,"Tanh",(function(){return Gt.ad})),n.d(e,"Tile",(function(){return Gt.bd})),n.d(e,"TopK",(function(){return Gt.cd})),n.d(e,"Transform",(function(){return Gt.dd})),n.d(e,"Transpose",(function(){return Gt.ed})),n.d(e,"Unique",(function(){return Gt.fd})),n.d(e,"Unpack",(function(){return Gt.gd})),n.d(e,"UnsortedSegmentSum",(function(){return Gt.hd})),n.d(e,"ZerosLike",(function(){return Gt.id})),n.d(e,"Step",(function(){return Gt.Sc})),n.d(e,"FromPixels",(function(){return Gt.ib})),n.d(e,"RotateWithOffset",(function(){return Gt.vc})),n.d(e,"_FusedMatMul",(function(){return Gt.jd})),n.d(e,"FusedConv2D",(function(){return Gt.kb})),n.d(e,"FusedDepthwiseConv2D",(function(){return Gt.lb}));var r={};n.r(r),n.d(r,"copyModel",(function(){return rt})),n.d(r,"listModels",(function(){return $})),n.d(r,"moveModel",(function(){return ot})),n.d(r,"removeModel",(function(){return et})),n.d(r,"browserFiles",(function(){return gt})),n.d(r,"browserHTTPRequest",(function(){return Rt})),n.d(r,"concatenateArrayBuffers",(function(){return x.d})),n.d(r,"decodeWeights",(function(){return x.e})),n.d(r,"encodeWeights",(function(){return x.f})),n.d(r,"fromMemory",(function(){return Dt})),n.d(r,"getLoadHandlers",(function(){return T})),n.d(r,"getModelArtifactsForJSON",(function(){return x.g})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return x.h})),n.d(r,"getSaveHandlers",(function(){return j})),n.d(r,"http",(function(){return At})),n.d(r,"isHTTPScheme",(function(){return It})),n.d(r,"loadWeights",(function(){return jt})),n.d(r,"registerLoadRouter",(function(){return k})),n.d(r,"registerSaveRouter",(function(){return w})),n.d(r,"weightsLoaderFactory",(function(){return St})),n.d(r,"withSaveHandler",(function(){return Mt}));var a={};n.r(a),n.d(a,"confusionMatrix",(function(){return Wt}));var o={};n.r(o),n.d(o,"fromPixelsAsync",(function(){return Yt})),n.d(o,"toPixels",(function(){return Zt})),n.d(o,"fromPixels",(function(){return $t}));var i={};n.r(i),n.d(i,"prepareAndValidate",(function(){return te}));var c={};n.r(c),n.d(c,"assertParamsValid",(function(){return ne})),n.d(c,"maskToAxes",(function(){return re})),n.d(c,"computeOutShape",(function(){return ae})),n.d(c,"stridesWithElidedDims",(function(){return oe})),n.d(c,"getNormalizedAxes",(function(){return ue})),n.d(c,"startIndicesWithElidedDims",(function(){return se})),n.d(c,"stopIndicesWithElidedDims",(function(){return le})),n.d(c,"stridesForAxis",(function(){return de})),n.d(c,"startForAxis",(function(){return fe})),n.d(c,"stopForAxis",(function(){return pe})),n.d(c,"isSliceContinous",(function(){return he})),n.d(c,"computeFlatOffset",(function(){return be})),n.d(c,"parseSliceParams",(function(){return me})),n.d(c,"sliceInfo",(function(){return ve}));var u={};n.r(u),n.d(u,"Serializable",(function(){return ge})),n.d(u,"SerializationMap",(function(){return ye})),n.d(u,"registerClass",(function(){return xe}));var s={};n.r(s),n.d(s,"segOpComputeOptimalWindowSize",(function(){return Wn})),n.d(s,"computeOutShape",(function(){return Gn})),n.d(s,"collectGatherOpShapeInfo",(function(){return Hn}));var l={};n.r(l),n.d(l,"axesAreInnerMostDims",(function(){return en.b})),n.d(l,"combineLocations",(function(){return en.c})),n.d(l,"computeOutAndReduceShapes",(function(){return en.d})),n.d(l,"expandShapeToKeepDim",(function(){return en.e})),n.d(l,"assertAxesAreInnerMostDims",(function(){return en.a})),n.d(l,"getAxesPermutation",(function(){return en.f})),n.d(l,"getUndoAxesPermutation",(function(){return en.h})),n.d(l,"getInnerMostAxes",(function(){return en.g})),n.d(l,"getBroadcastDims",(function(){return nn.b})),n.d(l,"getReductionAxes",(function(){return nn.c})),n.d(l,"assertAndGetBroadcastShape",(function(){return nn.a})),n.d(l,"assertParamsConsistent",(function(){return rn})),n.d(l,"computeOutShape",(function(){return an})),n.d(l,"computeDilation2DInfo",(function(){return on.d})),n.d(l,"computePool2DInfo",(function(){return on.e})),n.d(l,"computePool3DInfo",(function(){return on.f})),n.d(l,"computeConv2DInfo",(function(){return on.a})),n.d(l,"computeConv3DInfo",(function(){return on.b})),n.d(l,"computeDefaultPad",(function(){return on.c})),n.d(l,"tupleValuesAreOne",(function(){return on.i})),n.d(l,"eitherStridesOrDilationsAreOne",(function(){return on.h})),n.d(l,"convertConv2DDataFormat",(function(){return on.g})),n.d(l,"getFusedDyActivation",(function(){return cn.c})),n.d(l,"getFusedBiasGradient",(function(){return cn.b})),n.d(l,"applyActivation",(function(){return cn.a})),n.d(l,"shouldFuse",(function(){return cn.d})),n.d(l,"PARALLELIZE_THRESHOLD",(function(){return un})),n.d(l,"computeOptimalWindowSize",(function(){return sn})),n.d(l,"slice_util",(function(){return c})),n.d(l,"upcastType",(function(){return Ye.c})),n.d(l,"getImageCenter",(function(){return ln})),n.d(l,"getReshaped",(function(){return dn})),n.d(l,"getPermuted",(function(){return fn})),n.d(l,"getReshapedPermuted",(function(){return pn})),n.d(l,"getSliceBeginCoords",(function(){return hn})),n.d(l,"getSliceSize",(function(){return bn})),n.d(l,"prepareAndValidate",(function(){return te})),n.d(l,"validateUpdateShape",(function(){return ee.validateUpdateShape})),n.d(l,"validateInput",(function(){return ee.validateInput})),n.d(l,"calculateShapes",(function(){return ee.calculateShapes})),n.d(l,"SELU_SCALEALPHA",(function(){return mn})),n.d(l,"SELU_SCALE",(function(){return vn})),n.d(l,"ERF_P",(function(){return gn})),n.d(l,"ERF_A1",(function(){return yn})),n.d(l,"ERF_A2",(function(){return xn})),n.d(l,"ERF_A3",(function(){return On})),n.d(l,"ERF_A4",(function(){return wn})),n.d(l,"ERF_A5",(function(){return kn})),n.d(l,"warn",(function(){return jn})),n.d(l,"log",(function(){return Tn})),n.d(l,"mergeRealAndImagArrays",(function(){return Sn})),n.d(l,"splitRealAndImagArrays",(function(){return Nn})),n.d(l,"complexWithEvenIndex",(function(){return Cn})),n.d(l,"complexWithOddIndex",(function(){return In})),n.d(l,"getComplexWithIndex",(function(){return En})),n.d(l,"assignToTypedArray",(function(){return An})),n.d(l,"exponents",(function(){return Rn})),n.d(l,"exponent",(function(){return _n})),n.d(l,"decodeEinsumEquation",(function(){return Mn})),n.d(l,"getEinsumPermutation",(function(){return Pn})),n.d(l,"checkEinsumDimSizes",(function(){return Ln})),n.d(l,"getEinsumComputePath",(function(){return Bn})),n.d(l,"isIdentityPermutation",(function(){return Vn})),n.d(l,"prepareSplitSize",(function(){return Un})),n.d(l,"segment_util",(function(){return s})),n.d(l,"fromUint8ToStringArray",(function(){return qn})),n.d(l,"fromStringArrayToUint8",(function(){return Kn}));var d={};n.r(d),n.d(d,"nonMaxSuppressionV3Impl",(function(){return Yn.a})),n.d(d,"nonMaxSuppressionV4Impl",(function(){return Yn.b})),n.d(d,"nonMaxSuppressionV5Impl",(function(){return Yn.c})),n.d(d,"whereImpl",(function(){return Qn.a}));var f=n(68),p=(n(135),n(70)),h=n(73),b=n(84),m=n(94),v=n(75),g=n.n(v),y=n(76),x=n(97),O=function(){function t(){Object(p.a)(this,t),this.saveRouters=[],this.loadRouters=[]}return Object(h.a)(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerSaveRouter",value:function(e){t.getInstance().saveRouters.push(e)}},{key:"registerLoadRouter",value:function(e){t.getInstance().loadRouters.push(e)}},{key:"getSaveHandlers",value:function(e){return t.getHandlers(e,"save")}},{key:"getLoadHandlers",value:function(e,n){return t.getHandlers(e,"load",n)}},{key:"getHandlers",value:function(e,n,r){var a=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&a.push(n)})),a}}]),t}(),w=function(t){return O.registerSaveRouter(t)},k=function(t){return O.registerLoadRouter(t)},j=function(t){return O.getSaveHandlers(t)},T=function(t,e){return O.getLoadHandlers(t,e)},S="tensorflowjs",N="models_store",C="model_info_store";function I(){if(!Object(b.c)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function E(t){var e=t.result;e.createObjectStore(N,{keyPath:"modelPath"}),e.createObjectStore(C,{keyPath:"modelPath"})}var A=function(){function t(e){if(Object(p.a)(this,t),this.indexedDB=I(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return Object(h.a)(t,[{key:"save",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return t.abrupt("return",this.databaseAction(this.modelPath,e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"databaseAction",value:function(t,e){var n=this;return new Promise((function(t,r){var a=n.indexedDB.open(S,1);a.onupgradeneeded=function(){return E(a)},a.onsuccess=function(){var o=a.result;if(null==e){var i=o.transaction(N,"readonly"),c=i.objectStore(N).get(n.modelPath);c.onsuccess=function(){if(null==c.result)return o.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));t(c.result.modelArtifacts)},c.onerror=function(t){return o.close(),r(c.error)},i.oncomplete=function(){return o.close()}}else{var u,s=Object(x.h)(e),l=o.transaction(C,"readwrite"),d=l.objectStore(C),f=d.put({modelPath:n.modelPath,modelArtifactsInfo:s});f.onsuccess=function(){var a=(u=o.transaction(N,"readwrite")).objectStore(N).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:s});a.onsuccess=function(){return t({modelArtifactsInfo:s})},a.onerror=function(t){var e=(d=l.objectStore(C)).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(a.error)},e.onerror=function(t){return o.close(),r(a.error)}}},f.onerror=function(t){return o.close(),r(f.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},a.onerror=function(t){return r(a.error)}}))}}]),t}();A.URL_SCHEME="indexeddb://";var R=function(t){return Object(b.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(A.URL_SCHEME)?(e=t.slice(A.URL_SCHEME.length),new A(e)):null;var e};O.registerSaveRouter(R),O.registerLoadRouter(R);var _=function(){function t(){Object(p.a)(this,t),this.indexedDB=I()}return Object(h.a)(t,[{key:"listModels",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e=this;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.indexedDB.open(S,1);r.onupgradeneeded=function(){return E(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(C,"readonly"),o=a.objectStore(C).getAll();o.onsuccess=function(){var e,n={},r=Object(m.a)(o.result);try{for(r.s();!(e=r.n()).done;){var a=e.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(i){r.e(i)}finally{r.f()}t(n)},o.onerror=function(t){return e.close(),n(o.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(t){return n(r.error)}})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"removeModel",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n=this;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(r=e).startsWith(A.URL_SCHEME)?r.slice(A.URL_SCHEME.length):r,t.abrupt("return",new Promise((function(t,r){var a=n.indexedDB.open(S,1);a.onupgradeneeded=function(){return E(a)},a.onsuccess=function(){var n,o=a.result,i=o.transaction(C,"readwrite"),c=i.objectStore(C),u=c.get(e);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));var a=c.delete(e),i=function(){var a=(n=o.transaction(N,"readwrite")).objectStore(N).delete(e);a.onsuccess=function(){return t(u.result.modelArtifactsInfo)},a.onerror=function(t){return r(u.error)}};a.onsuccess=i,a.onerror=function(t){return i(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},i.oncomplete=function(){null==n?o.close():n.oncomplete=function(){return o.close()}}},a.onerror=function(t){return r(a.error)}})));case 2:case"end":return t.stop()}var r}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),F=n(123),D="/",M="tensorflowjs_models",P="info",L="model_topology",B="weight_specs",V="weight_data",z="model_metadata";function U(t){return{info:[M,t,P].join(D),topology:[M,t,L].join(D),weightSpecs:[M,t,B].join(D),weightData:[M,t,V].join(D),modelMetadata:[M,t,z].join(D)}}function W(t){for(var e=0,n=Object.values(t);e<n.length;e++){var r=n[e];window.localStorage.removeItem(r)}}function G(t){var e=t.split(D);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(D)}var H=function(){function t(e){if(Object(p.a)(this,t),!Object(b.c)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=U(this.modelPath)}return Object(h.a)(t,[{key:"save",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r,a,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=Object(x.h)(e),t.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(x.a)(e.weightData)),o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),t.abrupt("return",{modelArtifactsInfo:a});case 17:throw t.prev=17,t.t0=t.catch(7),W(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 21:case"end":return t.stop()}}),t,this,[[7,17]])})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e,n,r,a,o,i,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(e=JSON.parse(this.LS.getItem(this.keys.info)))){t.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===e.modelTopologyType){t.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){t.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){t.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(o),n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,null!=i.signature&&(n.signature=i.signature),null!=i.userDefinedMetadata&&(n.userDefinedMetadata=i.userDefinedMetadata),null!=i.modelInitializer&&(n.modelInitializer=i.modelInitializer),null!=i.trainingConfig&&(n.trainingConfig=i.trainingConfig)),null!=(c=this.LS.getItem(this.keys.weightData))){t.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Object(x.b)(c),t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();H.URL_SCHEME="localstorage://";var q=function(t){return Object(b.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(H.URL_SCHEME)?(e=t.slice(H.URL_SCHEME.length),new H(e)):null;var e};O.registerSaveRouter(q),O.registerLoadRouter(q);var K=function(){function t(){Object(p.a)(this,t),Object(F.b)(Object(b.c)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Object(F.b)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return Object(h.a)(t,[{key:"listModels",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e,n,r,a,o,i;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e={},n=M+D,r=D+P,a=0;a<this.LS.length;++a)(o=this.LS.key(a)).startsWith(n)&&o.endsWith(r)&&(i=G(o),e[i]=JSON.parse(this.LS.getItem(o)));return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"removeModel",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=(a=e).startsWith(H.URL_SCHEME)?a.slice(H.URL_SCHEME.length):a,n=U(e),null!=this.LS.getItem(n.info)){t.next=4;break}throw new Error("Cannot find model at path '".concat(e,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),W(n),t.abrupt("return",r);case 7:case"end":return t.stop()}var a}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),X="://",Y=function(){function t(){Object(p.a)(this,t),this.managers={}}return Object(h.a)(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerManager",value:function(e,n){Object(F.b)(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(X)&&(e=e.slice(0,e.indexOf(X))),Object(F.b)(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();Object(F.b)(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '".concat(e,"'.")})),r.managers[e]=n}},{key:"getManager",value:function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),t}();function Q(t){if(-1===t.indexOf(X))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Y.getSchemes().join(",")));return{scheme:t.split(X)[0],path:t.split(X)[1]}}function Z(t,e){return J.apply(this,arguments)}function J(){return(J=Object(y.a)(g.a.mark((function t(e,n){var r,a,o,i,c,u,s,l,d,f,p=arguments;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>2&&void 0!==p[2]&&p[2],Object(F.b)(e!==n,(function(){return"Old path and new path are the same: '".concat(e,"'")})),a=O.getLoadHandlers(e),Object(F.b)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(e,".")})),Object(F.b)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(e,".")})),o=a[0],i=O.getSaveHandlers(n),Object(F.b)(i.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Object(F.b)(i.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),c=i[0],u=Q(e).scheme,s=Q(e).path,l=u===Q(e).scheme,t.next=15,o.load();case 15:if(d=t.sent,!r||!l){t.next=19;break}return t.next=19,Y.getManager(u).removeModel(s);case 19:return t.next=21,c.save(d);case 21:if(f=t.sent,!r||l){t.next=25;break}return t.next=25,Y.getManager(u).removeModel(s);case 25:return t.abrupt("return",f.modelArtifactsInfo);case 26:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(){return tt.apply(this,arguments)}function tt(){return(tt=Object(y.a)(g.a.mark((function t(){var e,n,r,a,o,i,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Y.getSchemes(),n={},r=Object(m.a)(e),t.prev=3,r.s();case 5:if((a=r.n()).done){t.next=13;break}return o=a.value,t.next=9,Y.getManager(o).listModels();case 9:for(c in i=t.sent)n[o+X+c]=i[c];case 11:t.next=5;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),r.e(t.t0);case 18:return t.prev=18,r.f(),t.finish(18);case 21:return t.abrupt("return",n);case 22:case"end":return t.stop()}}),t,null,[[3,15,18,21]])})))).apply(this,arguments)}function et(t){return nt.apply(this,arguments)}function nt(){return(nt=Object(y.a)(g.a.mark((function t(e){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Q(e),r=Y.getManager(n.scheme),t.abrupt("return",r.removeModel(n.path));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rt(t,e){return at.apply(this,arguments)}function at(){return(at=Object(y.a)(g.a.mark((function t(e,n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!1,t.abrupt("return",Z(e,n,false));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ot(t,e){return it.apply(this,arguments)}function it(){return(it=Object(y.a)(g.a.mark((function t(e,n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!0,t.abrupt("return",Z(e,n,true));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ct=function(){function t(){Object(p.a)(this,t)}return Object(h.a)(t,[{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return fetch(t,e)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return new TextDecoder(e).decode(t)}}]),t}();if(Object(b.c)().get("IS_BROWSER")){Object(b.c)().setPlatform("browser",new ct);try{Y.registerManager(H.URL_SCHEME,new K)}catch(Jn){}try{Y.registerManager(A.URL_SCHEME,new _)}catch(Jn){}}n(323);var ut=n(105),st=n(88),lt=n(124),dt=n(185),ft=n(92);Object(f.b)();var pt={buffer:ut.a,cast:st.a,clone:lt.a,print:dt.a};Object(ft.e)(pt);var ht=n(77);function bt(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var mt=function(){function t(e){if(Object(p.a)(this,t),!Object(b.c)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return Object(h.a)(t,[{key:"save",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r,a,o,i,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof document){t.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer)){t.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=Object(x.i)(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,i.href=o,t.next=15,bt((function(){return i.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==e.weightData){t.next=21;break}return(c=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,c.href=n,t.next=21,bt((function(){return c.dispatchEvent(new MouseEvent("click"))}));case 21:return t.abrupt("return",{modelArtifactsInfo:Object(x.h)(e)});case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();mt.URL_SCHEME="downloads://";var vt=function(){function t(e){if(Object(p.a)(this,t),null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}return Object(h.a)(t,[{key:"load",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e=this;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),o=a.modelTopology;if(null!=o)if(null!=a.weightsManifest)if(0!==e.weightsFiles.length){var i=Object(x.g)(a,(function(t){return e.loadWeights(t)}));t(i)}else t({modelTopology:o});else n(new Error("weightManifest field is missing from file ".concat(e.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(e.jsonFile.name)))},r.onerror=function(t){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(e.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(e.jsonFile)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"loadWeights",value:function(t){var e,n=this,r=[],a=[],o=Object(m.a)(t);try{for(o.s();!(e=o.n()).done;){var i=e.value;r.push.apply(r,Object(ht.a)(i.weights)),a.push.apply(a,Object(ht.a)(i.paths))}}catch(Jn){o.e(Jn)}finally{o.f()}var c=this.checkManifestAndWeightFiles(t),u=a.map((function(t){return n.loadWeightsFile(t,c[t])}));return Promise.all(u).then((function(t){return[r,Object(x.d)(t)]}))}},{key:"loadWeightsFile",value:function(t,e){return new Promise((function(n,r){var a=new FileReader;a.onload=function(t){var e=t.target.result;n(e)},a.onerror=function(e){return r("Failed to weights data from file of path '".concat(t,"'."))},a.readAsArrayBuffer(e)}))}},{key:"checkManifestAndWeightFiles",value:function(t){var e,n=this,r=[],a=this.weightsFiles.map((function(t){return Object(x.c)(t.name)})),o={},i=Object(m.a)(t);try{for(i.s();!(e=i.n()).done;){e.value.paths.forEach((function(t){var e=Object(x.c)(t);if(-1!==r.indexOf(e))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(e,"'"));if(r.push(e),-1===a.indexOf(e))throw new Error("Weight file with basename '".concat(e,"' is not provided."));o[t]=n.weightsFiles[a.indexOf(e)]}))}}catch(Jn){i.e(Jn)}finally{i.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return o}}]),t}();function gt(t){return new vt(t)}O.registerSaveRouter((function(t){return Object(b.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(mt.URL_SCHEME)?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new mt(t)}(t.slice(mt.URL_SCHEME.length)):null}));var yt=n(72);function xt(t,e,n,r){!function(t){Object(F.b)(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){Object(F.b)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)})),Object(F.b)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)})),Object(F.b)(e>=t,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(t.map((function(o){return o.then((function(o){var i=n+ ++a/t.length*(r-n);return e(i),o})),o})))}var Ot=n(235);function wt(t,e){return kt.apply(this,arguments)}function kt(){return(kt=Object(y.a)(g.a.mark((function t(e,n){var r,a,o,i,c,u,s,l,d;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Object(b.c)().platform.fetch:n.fetchFunc,a=e.map((function(t){return r(t,n.requestInit,{isBinary:!0})})),o=0,i=.5,null!=n.onProgress){t.next=11;break}return t.next=8,Promise.all(a);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,xt(a,n.onProgress,o,i);case 13:t.t0=t.sent;case 14:if(c=t.t0,u=c.map((function(t){return t.arrayBuffer()})),s=.5,l=1,null!=n.onProgress){t.next=24;break}return t.next=21,Promise.all(u);case 21:t.t1=t.sent,t.next=27;break;case 24:return t.next=26,xt(u,n.onProgress,s,l);case 26:t.t1=t.sent;case 27:return d=t.t1,t.abrupt("return",d);case 29:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jt(t){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(y.a)(g.a.mark((function t(e){var n,r,a,o,i=arguments;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",r=i.length>2?i[2]:void 0,a=i.length>3?i[3]:void 0,o=St((function(t){return wt(t,{requestInit:a})})),t.abrupt("return",o(e,n,r));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function St(t){return function(){var e=Object(y.a)(g.a.mark((function e(n){var r,a,o,i,c,u,s,l,d,f,p,h,b=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.length>1&&void 0!==b[1]?b[1]:"",a=b.length>2?b[2]:void 0,o=n.map((function(){return!1})),i={},c=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(t,e){var n=0;t.weights.forEach((function(t){var r="quantization"in t?t.quantization.dtype:t.dtype,s=Ot.a[r]*F.O(t.shape),l=function(){o[e]=!0,null==i[e]&&(i[e]=[]),i[e].push({manifestEntry:t,groupOffset:n,sizeBytes:s})};null!=a?a.forEach((function(e,n){e===t.name&&(l(),c[n]=!0)})):l(),u.push(t.name),n+=s}))})),c.every((function(t){return t}))){e.next=10;break}throw s=a.filter((function(t,e){return!c[e]})),new Error("Could not find weights in manifest with names: "+"".concat(s.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=o.reduce((function(t,e,n){return e&&t.push(n),t}),[]),d=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;d.push(e)}))})),e.next=15,t(d);case 15:return f=e.sent,p={},h=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,a=0;a<e;a++)r+=f[h+a].byteLength;for(var o=new ArrayBuffer(r),c=new Uint8Array(o),u=0,s=0;s<e;s++){var l=new Uint8Array(f[h+s]);c.set(l,u),u+=l.byteLength}i[t].forEach((function(t){var e=o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=Object(x.e)(e,[t.manifestEntry]);for(var r in n)p[r]=n[r]})),h+=e})),e.abrupt("return",p);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var Nt=function(){function t(e,n){if(Object(p.a)(this,t),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Object(F.b)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Object(b.c)().platform.fetch,Object(F.b)(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&Object(F.b)(2===e.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")})),this.path=e,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return Object(h.a)(t,[{key:"save",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r,a,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=Object(x.i)(e,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=e.weightData&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),t.next=10,this.fetch(this.path,n);case 10:if(!(o=t.sent).ok){t.next=15;break}return t.abrupt("return",{modelArtifactsInfo:Object(x.h)(e),responses:[o]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."));case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e,n,r,a,o,i=this;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(this.path,this.requestInit);case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return t.prev=5,t.next=8,e.json();case 8:n=t.sent,t.next=16;break;case 11:throw t.prev=11,t.t0=t.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,o=n.weightsManifest,null!=a||null!=o){t.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return t.abrupt("return",Object(x.g)(n,(function(t){return i.loadWeights(t)})));case 21:case"end":return t.stop()}}),t,this,[[5,11]])})));return function(){return t.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r,a,o,i,c,u,s,l,d,f,p,h,b,v,y,O,w,k;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Ct(n),a=Object(yt.a)(r,2),o=a[0],i=a[1],c=this.weightPathPrefix||o,u=[],s=Object(m.a)(e);try{for(s.s();!(l=s.n()).done;)d=l.value,u.push.apply(u,Object(ht.a)(d.weights))}catch(Jn){s.e(Jn)}finally{s.f()}f=[],p=[],h=Object(m.a)(e);try{for(h.s();!(b=h.n()).done;){v=b.value,y=Object(m.a)(v.paths);try{for(y.s();!(O=y.n()).done;)w=O.value,null!=this.weightUrlConverter?p.push(this.weightUrlConverter(w)):f.push(c+w+i)}catch(Jn){y.e(Jn)}finally{y.f()}}}catch(Jn){h.e(Jn)}finally{h.f()}if(!this.weightUrlConverter){t.next=19;break}return t.t0=f.push,t.t1=f,t.t2=ht.a,t.next=16,Promise.all(p);case 16:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 19:return t.next=21,wt(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return k=t.sent,t.abrupt("return",[u,Object(x.d)(k)]);case 23:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();function Ct(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}function It(t){return null!=t.match(Nt.URL_SCHEME_REGEX)}Nt.URL_SCHEME_REGEX=/^https?:\/\//;var Et=function(t,e){if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;return(Array.isArray(t)?t.every((function(t){return It(t)})):It(t))?At(t,e):null};function At(t,e){return new Nt(t,e)}function Rt(t,e){return At(t,e)}O.registerSaveRouter(Et),O.registerLoadRouter(Et);var _t=function(){function t(e){Object(p.a)(this,t),this.modelArtifacts=e}return Object(h.a)(t,[{key:"load",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.modelArtifacts);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),Ft=function(){function t(e){Object(p.a)(this,t),this.saveHandler=e}return Object(h.a)(t,[{key:"save",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.saveHandler(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();function Dt(t,e,n,r){if(1===arguments.length){var a=null!=t.modelTopology||null!=t.weightSpecs;return a?new _t(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new _t({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new _t({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function Mt(t){return new Ft(t)}var Pt=n(67),Lt=n(108),Bt=n(209),Vt=n(66),zt=n(172);var Ut,Wt=Object(Vt.b)({confusionMatrix_:function(t,e,n){var r=Object(Pt.a)(t,"labels","confusionMatrix"),a=Object(Pt.a)(e,"predictions","confusionMatrix");F.b(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),F.b(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),F.b(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),F.b(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),F.b(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var o=Object(Bt.a)(Object(st.a)(r,"int32"),n),i=Object(Bt.a)(Object(st.a)(a,"int32"),n),c=Object(zt.a)(o),u=Object(Lt.a)(c,i);return Object(st.a)(u,"int32")}}),Gt=n(69),Ht=n(155),qt=n(219);function Kt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,o=!1,i=!1,c=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)o=!0;else if(null!=t.getContext)i=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));c=!0}if(a){var u=2;if(a&&t.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var s=Object(Ht.c)(Gt.ib,f.a.backendName);if(null!=s){var l={pixels:t},d={numChannels:e};return f.a.runKernel(Gt.ib,l,d)}var p,h,b=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],m=Object(yt.a)(b,2),v=m[0],g=m[1];if(i?p=t.getContext("2d").getImageData(0,0,v,g).data:r||n?p=t.data:(o||a||c)&&(null==Ut&&(Ut=document.createElement("canvas").getContext("2d")),Ut.canvas.width=v,Ut.canvas.height=g,Ut.drawImage(t,0,0,v,g),p=Ut.getImageData(0,0,v,g).data),4===e)h=new Int32Array(p);else{var y=v*g;h=new Int32Array(y*e);for(var x=0;x<y;x++)for(var O=0;O<e;++O)h[x*e+O]=p[4*x+O]}var w=[g,v,e];return Object(qt.a)(h,w,"int32")}function Xt(t){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}function Yt(t){return Qt.apply(this,arguments)}function Qt(){return(Qt=Object(y.a)(g.a.mark((function t(e){var n,r,a,o=arguments;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:3,r=null,!Object(b.c)().getBool("WRAP_TO_IMAGEBITMAP")||!Xt(e)){t.next=15;break}return t.prev=3,t.next=6,createImageBitmap(e,{premultiplyAlpha:"none"});case 6:a=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),a=null;case 12:r=null!=a&&a.width===e.width&&a.height===e.height?a:e,t.next=16;break;case 15:r=e;case 16:return t.abrupt("return",Kt(r,n));case 17:case"end":return t.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function Zt(t,e){return Jt.apply(this,arguments)}function Jt(){return(Jt=Object(y.a)(g.a.mark((function t(e,n){var r,a,o,i,c,u,s,l,d,f,p,h,b,m,v,y,x;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(Pt.a)(e,"img","toPixels"),e instanceof ft.a||(a=r,r=Object(st.a)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){t.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(o=r.shape.slice(0,2),i=Object(yt.a)(o,2),c=i[0],u=i[1],!((s=2===r.rank?1:r.shape[2])>4||2===s)){t.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(s));case 8:if("float32"===r.dtype||"int32"===r.dtype){t.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return t.next=12,r.data();case 12:l=t.sent,d="float32"===r.dtype?255:1,f=new Uint8ClampedArray(u*c*4),p=0;case 16:if(!(p<c*u)){t.next=41;break}h=[0,0,0,255],b=0;case 19:if(!(b<s)){t.next=33;break}if(m=l[p*s+b],"float32"!==r.dtype){t.next=26;break}if(!(m<0||m>1)){t.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(m,"."));case 24:t.next=29;break;case 26:if("int32"!==r.dtype){t.next=29;break}if(!(m<0||m>255)){t.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(m,"."));case 29:1===s?(h[0]=m*d,h[1]=m*d,h[2]=m*d):h[b]=m*d;case 30:b++,t.next=19;break;case 33:f[(v=4*p)+0]=Math.round(h[0]),f[v+1]=Math.round(h[1]),f[v+2]=Math.round(h[2]),f[v+3]=Math.round(h[3]);case 38:++p,t.next=16;break;case 41:return null!=n&&(n.width=u,n.height=c,y=n.getContext("2d"),x=new ImageData(f,u,c),y.putImageData(x,0,0)),r!==e&&r.dispose(),t.abrupt("return",f);case 44:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var $t=Object(Vt.b)({fromPixels_:Kt});function te(t,e){var n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===Object(F.O)(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));for(var a=e.shape,o=a[a.length-1],i=1,c=0;c<a.length-1;++c)i*=a[c];var u=t.shape,s=a.slice();s.pop();for(var l=1,d=o;d<n;++d)l*=u[d],s.push(u[d]);var f=[].concat(Object(ht.a)(Object(F.j)(t.shape).map((function(t){return t/l}))),[1]).slice(0,o);return[s,i,l,f]}var ee=n(147);function ne(t,e,n){var r=t.shape.length;F.b(r===e.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(r,").")})),F.b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){F.b(e[a]+n[a]<=t.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(t.shape[a],")")}))},o=0;o<r;++o)a(o)}function re(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function ae(t,e,n){for(var r=[],a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function oe(t,e,n,r){for(var a=Object(ht.a)(t),o=a.length;o<r.length;o++)a.push(1);for(var i=0;i<n;i++)0===i?a[e]=1:(a.splice(e,0,1),a.pop());return a}function ie(t,e,n){return n<=t?n:n-(e-1)}function ce(t,e){for(var n=[],r=0;r<t;r++)n.push(e+r);return n}function ue(t,e,n,r,a,o,i,c,u){var s=t.length,l=new Array(s),d=new Array(s),f=new Array(s);if(e.length&&n>0){var p=e[0],h=n+1;l=se(i,p,h,r,t),d=le(c,p,h,a,t),f=oe(o,p,h,t)}else for(var b=0;b<s;b++)l[b]=fe(i,r,o,t,b,u),d[b]=pe(c,a,o,t,b,u),f[b]=de(o,b,u);return{begin:l,end:d,strides:f}}function se(t,e,n,r,a){for(var o=Object(ht.a)(a),i=ce(n,e),c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=0;else{var u=ie(e,n,c),s=r[u];t&1<<u&&(s=0),o[c]=s}return o}function le(t,e,n,r,a){for(var o=Object(ht.a)(a),i=ce(n,e),c=0;c<o.length;c++)if(i.indexOf(c)>-1)o[c]=Number.MAX_SAFE_INTEGER;else{var u=ie(e,n,c),s=r[u];t&1<<u&&(s=Number.MAX_SAFE_INTEGER),o[c]=s}for(var l=0;l<o.length;l++){var d=a[l];o[l]<0&&(o[l]+=d),o[l]=F.i(0,o[l],a[l])}return o}function de(t,e,n){var r=t[e];return(n&1<<e||null==r)&&(r=1),r}function fe(t,e,n,r,a,o){var i=e[a],c=n[a]||1;(t&1<<a||o&1<<a||null==i)&&(i=c>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=r[a];return i<0&&(i+=u),i=F.i(0,i,u-1)}function pe(t,e,n,r,a,o){var i=e[a],c=n[a]||1;(t&1<<a||o&1<<a||null==i)&&(i=c>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return i<0&&(i+=u),i=c>0?F.i(0,i,u):F.i(-1,i,u-1)}function he(t,e,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function be(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function me(t,e,n){var r,a,o=t.shape.length;return(r="number"===typeof e?[e].concat(Object(ht.a)(new Array(o-1).fill(0))):e.length<o?e.concat(new Array(o-e.length).fill(0)):e.slice()).forEach((function(t){F.b(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(o).fill(-1):"number"===typeof n?[n].concat(Object(ht.a)(new Array(o-1).fill(-1))):n.length<o?n.concat(new Array(o-n.length).fill(-1)):n).map((function(e,n){return e>=0?e:(F.b(-1===e,(function(){return"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,".")})),t.shape[n]-r[n])})),[r,a]}function ve(t,e,n,r,a,o,i,c,u){var s=e.slice(),l=n.slice(),d=r;null==r&&(d=new Array(s.length));var f=re(i);if(f.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==i&&0!==c)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==i&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var p=t.length-s.length,h=re(c),b=t.slice();h.forEach((function(t){s[t]=0,l[t]=1,b.splice(t,0,1)}));var m=ue(b,f,p,s,l,d,a,o,i),v=m.begin,g=m.end,y=m.strides;s=v,l=g,d=y;var x=re(u);x.forEach((function(t){l[t]=s[t]+1,d[t]=1}));var O=ae(s,l,d),w=O.filter((function(t,e){return-1===x.indexOf(e)}));return{nonStrided:d.every((function(t){return 1===t})),$begin:s,$end:l,$strides:d,size:O,newShape:b,outShape:w}}var ge=function(){function t(){Object(p.a)(this,t)}return Object(h.a)(t,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(t,e){return new t(e)}}]),t}(),ye=function(){function t(){Object(p.a)(this,t),this.classNameMap={}}return Object(h.a)(t,null,[{key:"getMap",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"register",value:function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]}}]),t}();function xe(t){Object(F.b)(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),Object(F.b)("string"===typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),Object(F.b)(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),ye.register(t)}var Oe=n(78),we=n(212),ke=n(71),je="3.8.0",Te=n(81),Se=n(80),Ne=n(98),Ce=n(83),Ie=n(91),Ee=n(79),Ae=n(125),Re=n(107),_e=n(106),Fe=n(93),De=n(87),Me=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"minimize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(t,n),a=r.value,o=r.grads;if(null!=n){var i=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(i)}else this.applyGradients(o);return Object(Ne.d)(o),e?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(t,e){return Object(Fe.f)(t,e)}},{key:"dispose",value:function(){null!=this.iterations_&&Object(Ne.d)(this.iterations_)}},{key:"saveIterations",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==this.iterations_&&(this.iterations_=0),t.abrupt("return",{name:"iter",tensor:Object(De.a)(this.iterations_,"int32")});case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e[0].tensor.data();case 2:return this.iterations_=t.sent[0],t.abrupt("return",e.slice(1));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(ge);Object.defineProperty(Me,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Pe=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t,r){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(p.a)(this,n),(a=e.call(this)).learningRate=t,a.rho=r,a.epsilon=o,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==o&&(a.epsilon=f.a.backend.epsilon()),a}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=f.a.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(false)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(false)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var i=e.accumulatedGrads[r].variable,c=e.accumulatedUpdates[r].variable;Object(Ne.t)((function(){var t=Object(Ce.a)(Object(Ee.a)(i,e.rho),Object(Ee.a)(Object(Re.a)(o),1-e.rho)),n=Object(Ee.a)(Object(Ie.a)(Object(Ae.a)(Object(Ce.a)(c,e.epsilon)),Object(Ae.a)(Object(Ce.a)(i,e.epsilon))),o),r=Object(Ce.a)(Object(Ee.a)(c,e.rho),Object(Ee.a)(Object(Re.a)(n),1-e.rho));i.assign(t),c.assign(r);var u=Object(Ce.a)(Object(Ee.a)(n,-e.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Object(Ne.d)(this.accumulatedGrads.map((function(t){return t.variable}))),Object(Ne.d)(this.accumulatedUpdates.map((function(t){return t.variable}))))}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(Object(ht.a)(this.accumulatedGrads),Object(ht.a)(this.accumulatedUpdates)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,n=e.length/2,!1,this.accumulatedGrads=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}})),this.accumulatedUpdates=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}]),n}(Me);Pe.className="Adadelta",xe(Pe);var Le=n(137),Be=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Object(p.a)(this,n),(r=e.call(this)).learningRate=t,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==e.accumulatedGrads[r]){e.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Object(Ne.t)((function(){return Object(Le.a)(a.shape,e.initialAccumulatorValue).variable(false)}))}}var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var i=e.accumulatedGrads[r].variable;Object(Ne.t)((function(){var t=Object(Ce.a)(i,Object(Re.a)(o));i.assign(t);var n=Object(Ce.a)(Object(Ee.a)(Object(Ie.a)(o,Object(Ae.a)(Object(Ce.a)(t,f.a.backend.epsilon()))),-e.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Object(Ne.d)(this.accumulatedGrads.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,!1,this.accumulatedGrads=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}]),n}(Me);Be.className="Adagrad",xe(Be);var Ve=n(138),ze=n(85),Ue=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t,r,a){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Object(p.a)(this,n),(o=e.call(this)).learningRate=t,o.beta1=r,o.beta2=a,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],Object(Ne.t)((function(){o.accBeta1=Object(De.a)(r).variable(),o.accBeta2=Object(De.a)(a).variable()})),null==i&&(o.epsilon=f.a.backend.epsilon()),o}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Object(Ne.t)((function(){var r=Object(ze.a)(1,e.accBeta1),a=Object(ze.a)(1,e.accBeta2);n.forEach((function(n,o){var i=f.a.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:"".concat(n,"/m"),variable:Object(Ne.t)((function(){return Object(_e.a)(i).variable(false)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:"".concat(n,"/v"),variable:Object(Ne.t)((function(){return Object(_e.a)(i).variable(false)}))});var c=Array.isArray(t)?t[o].tensor:t[n];if(null!=c){var u=e.accumulatedFirstMoment[o].variable,s=e.accumulatedSecondMoment[o].variable,l=Object(Ce.a)(Object(Ee.a)(u,e.beta1),Object(Ee.a)(c,1-e.beta1)),d=Object(Ce.a)(Object(Ee.a)(s,e.beta2),Object(Ee.a)(Object(Re.a)(c),1-e.beta2)),p=Object(Ie.a)(l,r),h=Object(Ie.a)(d,a);u.assign(l),s.assign(d);var b=Object(Ce.a)(Object(Ee.a)(Object(Ie.a)(p,Object(Ce.a)(Object(Ae.a)(h),e.epsilon)),-e.learningRate),i);i.assign(b)}})),e.accBeta1.assign(Object(Ee.a)(e.accBeta1,e.beta1)),e.accBeta2.assign(Object(Ee.a)(e.accBeta2,e.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(Ne.d)(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Object(Ne.d)(this.accumulatedSecondMoment.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(Object(ht.a)(this.accumulatedFirstMoment),Object(ht.a)(this.accumulatedSecondMoment)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r=this;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,Object(Ne.t)((function(){r.accBeta1.assign(Object(Ve.a)(r.beta1,r.iterations_+1)),r.accBeta2.assign(Object(Ve.a)(r.beta2,r.iterations_+1))})),n=e.length/2,!1,this.accumulatedFirstMoment=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}})),this.accumulatedSecondMoment=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}]),n}(Me);Ue.className="Adam",xe(Ue);var We=n(115),Ge=n(187),He=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t,r,a){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(p.a)(this,n),(o=e.call(this)).learningRate=t,o.beta1=r,o.beta2=a,o.epsilon=i,o.decay=c,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Object(Ne.t)((function(){o.iteration=Object(De.a)(0).variable(),o.accBeta1=Object(De.a)(r).variable()})),null==i&&(o.epsilon=f.a.backend.epsilon()),o}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Object(Ne.t)((function(){var r=Object(ze.a)(1,e.accBeta1),a=Object(Ie.a)(-e.learningRate,Object(Ce.a)(Object(Ee.a)(e.iteration,e.decay),1));n.forEach((function(n,o){var i=f.a.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:"".concat(n,"/m"),variable:Object(_e.a)(i).variable(false)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:"".concat(n,"/v"),variable:Object(_e.a)(i).variable(false)});var c=Array.isArray(t)?t[o].tensor:t[n];if(null!=c){var u=e.accumulatedFirstMoment[o].variable,s=e.accumulatedWeightedInfNorm[o].variable,l=Object(Ce.a)(Object(Ee.a)(u,e.beta1),Object(Ee.a)(c,1-e.beta1)),d=Object(Ee.a)(s,e.beta2),p=Object(We.a)(c),h=Object(Ge.a)(d,p);u.assign(l),s.assign(h);var b=Object(Ce.a)(Object(Ee.a)(Object(Ie.a)(a,r),Object(Ie.a)(l,Object(Ce.a)(h,e.epsilon))),i);i.assign(b)}})),e.iteration.assign(Object(Ce.a)(e.iteration,1)),e.accBeta1.assign(Object(Ee.a)(e.accBeta1,e.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(Ne.d)(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Object(Ne.d)(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}]),n}(Me);He.className="Adamax",xe(He);var qe=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this)).learningRate=t,r.setLearningRate(t),r}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=f.a.registeredVariables[n];Object(Ne.t)((function(){var t=Object(Ce.a)(Object(Ee.a)(e.c,a),o);o.assign(t)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Object(Ne.l)(Object(De.a)(-t))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:if(0===(e=t.sent).length){t.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate)}}]),n}(Me);qe.className="SGD",xe(qe);var Ke=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t,r){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(p.a)(this,n),(a=e.call(this,t)).learningRate=t,a.momentum=r,a.useNesterov=o,a.accumulations=[],a.m=Object(De.a)(a.momentum),a}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==e.accumulations[r]){e.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(false)}))}}var o=e.accumulations[r].variable,i=Array.isArray(t)?t[r].tensor:t[n];null!=i&&Object(Ne.t)((function(){var t,n=Object(Ce.a)(Object(Ee.a)(e.m,o),i);t=e.useNesterov?Object(Ce.a)(Object(Ee.a)(e.c,Object(Ce.a)(i,Object(Ee.a)(n,e.m))),a):Object(Ce.a)(Object(Ee.a)(e.c,n),a),o.assign(n),a.assign(t)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Object(Ne.d)(this.accumulations.map((function(t){return t.variable})))}},{key:"setMomentum",value:function(t){this.momentum=t}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,!1,this.accumulations=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}]),n}(qe);Ke.className="Momentum",xe(Ke);var Xe=function(t){Object(Te.a)(n,t);var e=Object(Se.a)(n);function n(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(p.a)(this,n),(r=e.call(this)).learningRate=t,r.decay=a,r.momentum=o,r.epsilon=i,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=c,null==i&&(r.epsilon=f.a.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return Object(h.a)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=f.a.registeredVariables[n],o=!1;null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(o)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(o)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Object(Ne.t)((function(){return Object(_e.a)(a).variable(o)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var c=e.accumulatedMeanSquares[r].variable,u=e.accumulatedMoments[r].variable;Object(Ne.t)((function(){var t=Object(Ce.a)(Object(Ee.a)(c,e.decay),Object(Ee.a)(Object(Re.a)(i),1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,o=Object(Ce.a)(Object(Ee.a)(n,e.decay),Object(Ee.a)(i,1-e.decay)),s=Object(Ie.a)(Object(Ee.a)(i,e.learningRate),Object(Ae.a)(Object(ze.a)(t,Object(Ce.a)(Object(Re.a)(o),e.epsilon)))),l=Object(Ce.a)(Object(Ee.a)(u,e.momentum),s);c.assign(t),n.assign(o),u.assign(l);var d=Object(ze.a)(a,l);a.assign(d)}else{var f=Object(Ce.a)(Object(Ee.a)(c,e.decay),Object(Ee.a)(Object(Re.a)(i),1-e.decay)),p=Object(Ce.a)(Object(Ee.a)(u,e.momentum),Object(Ie.a)(Object(Ee.a)(i,e.learningRate),Object(Ae.a)(Object(Ce.a)(f,e.epsilon))));c.assign(f),u.assign(p);var h=Object(ze.a)(a,p);a.assign(h)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Object(Ne.d)(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Object(Ne.d)(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Object(Ne.d)(this.accumulatedMoments.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(Object(ht.a)(this.accumulatedMeanSquares),Object(ht.a)(this.accumulatedMoments)),this.centered&&e.push.apply(e,Object(ht.a)(this.accumulatedMeanGrads)),t.next=4,this.saveIterations();case 4:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=Object(y.a)(g.a.mark((function t(e){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,n=this.centered?e.length/3:e.length/2,r=!1,this.accumulatedMeanSquares=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})),this.accumulatedMoments=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}]),n}(Me);Xe.className="RMSProp",xe(Xe);var Ye=n(113),Qe=n(133),Ze=n(101),Je=function(){function t(){Object(p.a)(this,t)}return Object(h.a)(t,null,[{key:"sgd",value:function(t){return new qe(t)}},{key:"momentum",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Ke(t,e,n)}},{key:"rmsprop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Xe(t,e,n,r,a)}},{key:"adam",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Ue(t,e,n,r)}},{key:"adadelta",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Pe(t,e,n)}},{key:"adamax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new He(t,e,n,r,a)}},{key:"adagrad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Be(t,e)}}]),t}(),$e={sgd:Je.sgd,momentum:Je.momentum,adadelta:Je.adadelta,adagrad:Je.adagrad,rmsprop:Je.rmsprop,adamax:Je.adamax,adam:Je.adam},tn=n(292),en=n(128),nn=n(86);function rn(t,e){var n=t[0].length;t.forEach((function(t,e){F.b(t.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),F.b(e>=0&&e<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=t[0];t.forEach((function(t,a){for(var o=0;o<n;o++)F.b(o===e||t[o]===r[o],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function an(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}var on=n(102),cn=n(119),un=30;function sn(t){return t<=un?t:Object(F.G)(t,Math.floor(Math.sqrt(t)))}function ln(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function dn(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(e.slice(0))).push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);for(var o=e.length,i=0;i<o;++i)a=a.concat([t[i+1]/e[i],e[i]]);a=a.concat(t.slice(o+1))}return a}function fn(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(e);for(var a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{for(var o=[],i=[],c=1;c<t;++c)c>=2*e+1||c%2===1?i.push(c):o.push(c);r.push.apply(r,o),r.push(0),r.push.apply(r,i)}return r}function pn(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(var o=1;o<t.length;++o)o<=e.length?r?a.push(e[o-1]*t[o]):a.push(t[o]/e[o-1]):a.push(t[o]);return a}function hn(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function bn(t,e,n){for(var r=t.slice(0,1),a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}var mn=1.7580993408473768,vn=1.0507009873554805,gn=.3275911,yn=.254829592,xn=-.284496736,On=1.421413741,wn=-1.453152027,kn=1.061405429;function jn(){var t;Object(b.c)().getBool("IS_TEST")||(t=console).warn.apply(t,arguments)}function Tn(){var t;Object(b.c)().getBool("IS_TEST")||(t=console).log.apply(t,arguments)}function Sn(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Nn(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Cn(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function In(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function En(t,e){return{real:t[2*e],imag:t[2*e+1]}}function An(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Rn(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),a=0;a<Math.ceil(t/2);a++){var o=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(o),r[a]=Math.sin(o)}return{real:n,imag:r}}function _n(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}var Fn="->",Dn=/->/g;function Mn(t,e){var n=((t=t.replace(/\s/g,"")).length-t.replace(Dn,"").length)/Fn.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(Fn,'").'));var r=t.split(Fn),a=Object(yt.a)(r,2),o=a[0],i=a[1];Object(F.b)(-1===o.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var c=o.split(","),u=c.length;if(e!==u)throw new Error("Expected ".concat(u," input tensors, received ").concat(e));if(u>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var s=[],l=function(t){var e=i[t];if(!c.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===s.indexOf(e)&&s.push(e)},d=0;d<i.length;++d)l(d);for(var f=0;f<o.length;++f){var p=o[f];-1===s.indexOf(p)&&","!==p&&s.push(p)}for(var h=new Array(c.length),b=0;b<u;++b){if(new Set(c[b].split("")).size!==c[b].length)throw new Error("Found duplicate axes in input component ".concat(c[b],". ")+"Support for duplicate axes in input is not implemented yet.");h[b]=[];for(var m=0;m<c[b].length;++m)h[b].push(s.indexOf(c[b][m]))}for(var v=s.length,g=[],y=i.length;y<v;++y)g.push(y);return{allDims:s,summedDims:g,idDims:h}}function Pn(t,e){var n=new Array(t);n.fill(-1);for(var r=0;r<e.length;++r)n[e[r]]=r;for(var a=[],o=0;o<t;++o)-1===n[o]&&a.push(o);return{permutationIndices:n=n.filter((function(t){return-1!==t})),expandDims:a}}function Ln(t,e,n){for(var r=new Array(t),a=function(t){for(var a=n[t].shape,o=function(n){void 0===r[e[t][n]]?r[e[t][n]]=a[n]:Object(F.b)(r[e[t][n]]===a[n],(function(){return"Expected dimension ".concat(r[e[t][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},i=0;i<e[t].length;++i)o(i)},o=0;o<n.length;++o)a(o)}function Bn(t,e){var n,r=t,a=[];0===t.length&&r.push(-1),n=t.length+1;for(var o=0;o<n;++o)a.push([]);for(var i=[],c=0;c<r.length;++c){var u,s=zn(e,r[c]),l=Object(m.a)(s);try{for(l.s();!(u=l.n()).done;){var d=u.value;-1===i.indexOf(d)&&(a[c].push(d),i.push(d))}}catch(Jn){l.e(Jn)}finally{l.f()}}return{path:r,steps:a}}function Vn(t){return t.every((function(t,e){return t===e}))}function zn(t,e){for(var n=[],r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Un(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)Object(F.b)(t.shape[n]%e===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(t.shape[n]/e);else{var a=e.reduce((function(t,e){return-1===e&&(t+=1),t}),0);Object(F.b)(a<=1,(function(){return"There should be only one negative value in split array."}));var o=e.indexOf(-1);if(-1!==o){var i=e.reduce((function(t,e){return e>0?t+e:t}));e[o]=t.shape[n]-i}Object(F.b)(t.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e}return r}function Wn(t,e){var n,r=!1;for(t<=un?(n=t,r=!0):n=Object(F.G)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Object(F.G)(t,n+1);return n}function Gn(t,e,n){for(var r=[],a=t.length,o=0;o<a;o++)o!==e?r.push(t[o]):r.push(n);return r}function Hn(t,e,n,r){var a=e.shape.length,o=t.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>o)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(o,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var i=0;i<r;++i)if(t.shape[i]!==e.shape[i])throw new Error("x.shape[".concat(i,"]: ").concat(t.shape[i]," should be equal to indices.shape[").concat(i,"]: ").concat(e.shape[i],"."));for(var c=t.shape[n],u=[],s=1,l=1,d=1,f=0;f<r;++f)u.push(t.shape[f]),s*=t.shape[f];for(var p=r;p<n;p++)u.push(t.shape[p]),l*=t.shape[p];for(var h=r;h<a;h++)u.push(e.shape[h]);for(var b=n+1;b<o;b++)u.push(t.shape[b]),d*=t.shape[b];return{batchSize:s,sliceSize:d,outerSize:l,dimSize:c,outputShape:u}}function qn(t){try{return t.map((function(t){return Object(ke.decodeString)(t)}))}catch(Jn){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Jn))}}function Kn(t){return t.map((function(t){return Object(ke.encodeString)(t)}))}var Xn=n(184),Yn=n(122),Qn=n(221),Zn=n(156)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(68),a=n(123),o="__op";function i(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],i=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=o;var c=function(){r.a.startScope(n);try{var t=i.apply(void 0,arguments);return Object(a.x)(t)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(t),t}catch(e){throw r.a.endScope(null),e}};return Object.defineProperty(c,"name",{value:n,configurable:!0}),c}},function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return f}));var r=n(68),a=n(84),o=n(92),i=n(123),c=n(71);function u(t,e){var n=t;if(Object(i.A)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||Object(i.A)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&Object(a.c)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&s(t,r,[]),r}function s(t,e,n){if(n=n||[],Array.isArray(t)||Object(i.A)(t)){Object(i.b)(e.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),Object(i.b)(t.length===e[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var r=e.slice(1),a=0;a<t.length;++a)s(t[a],r,n.concat(a))}else Object(i.b)(0===e.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")}))}function l(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function d(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof o.a)return l(a,t.dtype,e,n),t;var s=Object(i.r)(t);if("string"!==s&&["bool","int32","float32"].indexOf(a)>=0&&(s=a),l(a,s,e,n),null==t||!Object(i.A)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){var d=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(d,"'"))}var f=u(t,s);Object(i.A)(t)||Array.isArray(t)||(t=[t]);var p=!0,h="string"!==s?Object(c.toTypedArray)(t,s):Object(i.m)(t,[],p);return r.a.makeTensor(h,f,s)}function f(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=t;return a.map((function(t,a){return d(t,"".concat(e,"[").concat(a,"]"),n,r)}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return N})),n.d(e,"a",(function(){return C}));var r=n(94),a=n(77),o=n(75),i=n.n(o),c=n(76),u=n(70),s=n(73),l=n(156),d=n(84),f=n(183),p=n(69),h=n(155),b=n(71),m=n(123),v=function(){function t(e,n){Object(u.a)(this,t),this.backendTimer=e,this.logger=n,null==n&&(this.logger=new g)}return Object(s.a)(t,[{key:"profileKernel",value:function(t,e,n){var a,o,i=function(){a=n()},c=b.now();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();var u,s=Object(r.a)(a);try{for(s.s();!(u=s.n()).done;){u.value.dataSync()}}catch(p){s.e(p)}finally{s.f()}o=Promise.resolve({kernelMs:b.now()-c})}if(Object(d.c)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(e){var n=a[e];n.data().then((function(e){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var a=t[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(e,n.dtype,t)}))},f=0;f<a.length;f++)l(f);return{kernelName:t,outputs:a,inputs:e,timeMs:o.then((function(t){return t.kernelMs})),extraInfo:o.then((function(t){return null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(t){var e=this,n=t.kernelName,r=t.outputs,a=t.timeMs,o=t.inputs,i=t.extraInfo;r.forEach((function(t){Promise.all([t.data(),a,i]).then((function(r){e.logger.logKernelProfile(n,t,r[0],r[1],o,r[2])}))}))}}]),t}();var g=function(){function t(){Object(u.a)(this,t)}return Object(s.a)(t,[{key:"logKernelProfile",value:function(t,e,n,r,a,o){var i="number"===typeof r?m.L("".concat(r,"ms"),9):r.error,c=m.L(t,25),u=e.rank,s=e.size,l=m.L(e.shape.toString(),14),d="";for(var f in a){var p=a[f];if(null!=p){var h=p.shape||e.shape,b=h.length;d+="".concat(f,": ").concat(b,"D ").concat(b>0?h:""," ")}}console.log("%c".concat(c,"\t%c").concat(i,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(s,"\t%c").concat(d,"\t%c").concat(o),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),t}();function y(t,e,n){for(var r={},a={},o=0;o<e.length;o++)r[e[o].id]=!0;for(var i=0;i<t.length;i++){var c=t[i],u=c.inputs;for(var s in u){for(var l=u[s],d=!1,f=0;f<e.length;f++)if(r[l.id]){c.outputs.forEach((function(t){return r[t.id]=!0})),d=!0,a[c.id]=!0;break}if(d)break}}var p={};p[n.id]=!0;for(var h={},b=t.length-1;b>=0;b--)for(var m=t[b],v=m.inputs,g=0;g<m.outputs.length;g++)if(p[m.outputs[g].id]){for(var y in v)p[v[y].id]=!0,h[m.id]=!0;break}for(var x=[],O=0;O<t.length;O++){var w=t[O];if(a[w.id]&&h[w.id]){var k={};for(var j in w.inputs){var T=w.inputs[j];r[T.id]&&(k[j]=T)}var S=Object.assign({},w);S.inputs=k,S.outputs=w.outputs,x.push(S)}}return x}function x(t,e,n,r){for(var a=function(a){var o=e[a],i=[];if(o.outputs.forEach((function(e){var n=t[e.id];null!=n?i.push(n):i.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));var c=o.gradient(i),u=function(e){if(!(e in c))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(c),"."));var a=n((function(){return c[e]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var i=o.inputs[e];if(!m.a(a.shape,i.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==t[i.id])t[i.id]=a;else{var u=t[i.id];t[i.id]=r(u,a),u.dispose()}};for(var s in o.inputs)u(s)},o=e.length-1;o>=0;o--)a(o)}var O=n(92),w=n(78);function k(t){return null!=t.kernelName}var j=function(){function t(){Object(u.a)(this,t),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(t){return t.name}))))}}}return Object(s.a)(t,[{key:"dispose",value:function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()}}]),t}(),T=function(){function t(e){Object(u.a)(this,t),this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new j}return Object(s.a)(t,[{key:"ready",value:function(){var t=Object(c.a)(i.a.mark((function t(){var e,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.pendingBackendInit){t.next=2;break}return t.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){t.next=4;break}return t.abrupt("return");case 4:e=this.getSortedBackends(),n=0;case 6:if(!(n<e.length)){t.next=18;break}return r=e[n],t.next=10,this.initializeBackend(r).success;case 10:if(!t.sent){t.next=15;break}return t.next=14,this.setBackend(r);case 14:return t.abrupt("return");case 15:n++,t.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]}},{key:"findBackendFactory",value:function(t){return t in this.registryFactory?this.registryFactory[t].factory:null}},{key:"registerBackend",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(console.warn("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}},{key:"setBackend",value:function(){var t=Object(c.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=this.registryFactory[e]){t.next=2;break}throw new Error("Backend name '".concat(e,"' not found in registry"));case 2:if(this.backendName=e,null!=this.registry[e]){t.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,!n.asyncInit){t.next=12;break}return t.next=9,r;case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0=r;case 13:if(t.t0){t.next=16;break}return t.abrupt("return",!1);case 16:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new v(this.backendInstance),t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var t=this;Object(h.d)(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(t){var e=this;Object(h.d)(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))}},{key:"initializeBackend",value:function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(!r||r instanceof l.b||"function"!==typeof r.then)return this.registry[t]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,o=r.then((function(n){return!(a<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return a<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend ".concat(t," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}catch(i){return console.warn("Initialization of backend ".concat(t," failed")),console.warn(i.stack||i.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),a=r.success,o=r.asyncInit;if(o||a)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e),o=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,a,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(t,e){var n,r=this,a=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(t,e,n){t();try{var r=n();return e(),r}catch(a){throw e(),a}}},{key:"nextTensorId",value:function(){return t.nextTensorId++}},{key:"nextVariableId",value:function(){return t.nextVariableId++}},{key:"clone",value:function(t){var e=C.runKernel(p.rb,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){var e={x:t},n={dtype:"float32"};return C.runKernel(p.w,e,n)}}}),[],{}),e}},{key:"runKernel",value:function(t,e,n){if(null==this.backendName&&this.backend,!(null!=Object(h.c)(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(t,e,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(t){a+="complex64"===t.dtype?3:1}));var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-e-a-o;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(t,"'"))}},{key:"runKernelFunc",value:function(t){var e,n,r,a=this,o=[],i=this.isTapeOn(),c=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var s=k(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(k(t)){var l=t.kernelName,d=t.inputs,f=t.attrs;null==this.backendName&&this.backend;var p=Object(h.c)(l,this.backendName);m.b(null!=p,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var t=a.backend.numDataIds();r=p.kernelFunc({inputs:d,attrs:f,backend:a.backend});var e=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,t,e);var n=e.map((function(t){if(null!=t.rank)return t;var e=t.dataId,n=t.shape,r=t.dtype;return a.makeTensorFromDataId(e,n,r)}));if(i){var c=a.getTensorsForGradient(l,d,n);o=a.saveTensorsForBackwardMode(c)}return n}}else{var b=t.forwardFunc,v=function(t){i&&(o=t.map((function(t){return a.keep(a.clone(t))})))};n=function(){var t=a.backend.numDataIds();r=a.tidy((function(){return b(a.backend,v)}));var e=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(s,t,e),e}}var g,y=t.inputs,x=t.attrs,O=k(t)?null:t.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(g=a.profiler.profileKernel(s,y,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(g),e=g.outputs):e=n()})),i&&this.addTapeNode(s,y,e,O,o,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(y).map((function(t){return null!=y[t]?y[t].shape:null})),outputShapes:e.map((function(t){return t.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?e:e[0]}},{key:"saveTensorsForBackwardMode",value:function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))}},{key:"getTensorsForGradient",value:function(t,e,n){var r=Object(h.b)(t);if(null!=r){var a,o=r.inputsToSave||[],i=r.outputsToSave||[];r.saveAllInputs?(m.b(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(e).map((function(t){return e[t]}))):a=o.map((function(t){return e[t]}));var c=n.filter((function(t,e){return i[e]}));return a.concat(c)}return[]}},{key:"makeTensor",value:function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=t;"string"===n&&m.z(t[0])&&(a=t.map((function(t){return b.encodeString(t)})));var o=r.write(a,e,n),i=new O.a(e,n,o,this.nextTensorId());if(this.trackTensor(i,r),"string"===n){var c=this.state.tensorInfo.get(o),u=Object(m.f)(a);this.state.numBytes+=u-c.bytes,c.bytes=u}return i}},{key:"makeTensorFromDataId",value:function(t,e,n,r){n=n||"float32";var a=new O.a(e,n,t,this.nextTensorId());return this.trackTensor(a,r),a}},{key:"makeVariable",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));var a=new O.c(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*m.g(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof O.c||this.track(t)}},{key:"incRef",value:function(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}},{key:"removeDataId",value:function(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(t){if(this.state.tensorInfo.has(t.dataId)){var e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){var n=t.size*m.g(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}}},{key:"disposeVariables",value:function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}}},{key:"disposeVariable",value:function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}},{key:"memory",value:function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}},{key:"profile",value:function(){var t=Object(c.a)(i.a.mark((function t(e){var n,o,c,u,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,o=this.state.numTensors,this.state.activeProfile.kernels=[],t.next=6,e();case 6:this.state.activeProfile.result=t.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,Object(a.a)(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-o,c=Object(r.a)(this.state.activeProfile.kernels),t.prev=12,c.s();case 14:if((u=c.n()).done){t.next=24;break}return s=u.value,t.next=18,s.kernelTimeMs;case 18:return s.kernelTimeMs=t.sent,t.next=21,s.extraInfo;case 21:s.extraInfo=t.sent;case 22:t.next=14;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(12),c.e(t.t0);case 29:return t.prev=29,c.f(),t.finish(29);case 32:return t.abrupt("return",this.state.activeProfile);case 33:case"end":return t.stop()}}),t,this,[[12,26,29,32]])})));return function(e){return t.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(t,e,n,r,a,o){var i=this,c={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},u=Object(h.b)(t);null!=u&&(r=u.gradFunc),null!=r&&(c.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],a=m.F(r.size,r.dtype);return i.makeTensor(a,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],a,o)}),this.state.activeTape.push(c)}},{key:"keep",value:function(t){return t.kept=!0,t}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}},{key:"endScope",value:function(t){for(var e=this,n=Object(w.getTensorsInContainer)(t),r=new Set(n.map((function(t){return t.id}))),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||r.has(o.id)||o.dispose()}var i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==i.id||e.track(t)}))}},{key:"gradients",value:function(t,e,n){var a=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(m.b(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",t)}));m.b(i instanceof O.a,(function(){return"The result y returned by f() must be a tensor."}));var c=y(this.state.activeTape,e,i);if(!o&&0===c.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t={};t[i.id]=null==n?S(i.shape):n,x(t,c,(function(t){return a.tidy(t)}),I);var o=e.map((function(e){return t[e.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(t){var e,n=Object(r.a)(t.saved);try{for(n.s();!(e=n.n()).done;){e.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:i,grads:o}}))}},{key:"customGrad",value:function(t){var e=this;return m.b(m.u(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o;m.b(r.every((function(t){return t instanceof O.a})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};r.forEach((function(t,e){i[e]=t}));var c=function(e,n){return o=t.apply(void 0,[].concat(r,[n])),m.b(o.value instanceof O.a,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),m.b(m.u(o.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),o.value},u=function(t,e){var n=o.gradFunc(t,e),a=Array.isArray(n)?n:[n];m.b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),m.b(a.every((function(t){return t instanceof O.a})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var i={};return a.forEach((function(t,e){i[e]=function(){return t}})),i};return e.runKernelFunc({forwardFunc:c,backwardsFunc:u,inputs:i})}}},{key:"readSync",value:function(t){return this.state.tensorInfo.get(t).backend.readSync(t)}},{key:"read",value:function(t){return this.state.tensorInfo.get(t).backend.read(t)}},{key:"time",value:function(){var t=Object(c.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(b.now)(),t.next=3,this.backend.time(e);case 3:return(r=t.sent).wallMs=Object(b.now)()-n,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"track",value:function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new j,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),t}();function S(t){var e=Object(m.D)(Object(m.O)(t),"float32");return C.makeTensor(e,t,"float32")}function N(){var t=Object(f.b)();if(null==t._tfengine){var e=new d.b(t);t._tfengine=new T(e)}return Object(d.d)(t._tfengine.ENV),Object(O.f)((function(){return t._tfengine})),t._tfengine}T.nextTensorId=0,T.nextVariableId=0;var C=N();function I(t,e){var n={a:t,b:e};return C.runKernel(p.d,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return h})),n.d(e,"n",(function(){return b})),n.d(e,"m",(function(){return m})),n.d(e,"o",(function(){return v})),n.d(e,"r",(function(){return g})),n.d(e,"p",(function(){return y})),n.d(e,"q",(function(){return x})),n.d(e,"s",(function(){return O})),n.d(e,"t",(function(){return w})),n.d(e,"u",(function(){return k})),n.d(e,"v",(function(){return j})),n.d(e,"w",(function(){return T})),n.d(e,"x",(function(){return S})),n.d(e,"y",(function(){return N})),n.d(e,"z",(function(){return C})),n.d(e,"A",(function(){return I})),n.d(e,"B",(function(){return E})),n.d(e,"C",(function(){return A})),n.d(e,"D",(function(){return R})),n.d(e,"E",(function(){return _})),n.d(e,"F",(function(){return F})),n.d(e,"G",(function(){return D})),n.d(e,"H",(function(){return M})),n.d(e,"I",(function(){return P})),n.d(e,"J",(function(){return L})),n.d(e,"L",(function(){return B})),n.d(e,"K",(function(){return V})),n.d(e,"M",(function(){return z})),n.d(e,"N",(function(){return U})),n.d(e,"O",(function(){return W})),n.d(e,"P",(function(){return G})),n.d(e,"Q",(function(){return H})),n.d(e,"R",(function(){return q})),n.d(e,"S",(function(){return K})),n.d(e,"U",(function(){return X})),n.d(e,"T",(function(){return Y})),n.d(e,"lc",(function(){return Q})),n.d(e,"V",(function(){return Z})),n.d(e,"W",(function(){return J})),n.d(e,"X",(function(){return $})),n.d(e,"Z",(function(){return tt})),n.d(e,"Y",(function(){return et})),n.d(e,"ab",(function(){return nt})),n.d(e,"bb",(function(){return rt})),n.d(e,"cb",(function(){return at})),n.d(e,"db",(function(){return ot})),n.d(e,"eb",(function(){return it})),n.d(e,"fb",(function(){return ct})),n.d(e,"gb",(function(){return ut})),n.d(e,"hb",(function(){return st})),n.d(e,"jb",(function(){return lt})),n.d(e,"nb",(function(){return dt})),n.d(e,"mb",(function(){return ft})),n.d(e,"ob",(function(){return pt})),n.d(e,"pb",(function(){return ht})),n.d(e,"rb",(function(){return bt})),n.d(e,"qb",(function(){return mt})),n.d(e,"sb",(function(){return vt})),n.d(e,"tb",(function(){return gt})),n.d(e,"ub",(function(){return yt})),n.d(e,"vb",(function(){return xt})),n.d(e,"yb",(function(){return Ot})),n.d(e,"zb",(function(){return wt})),n.d(e,"Ab",(function(){return kt})),n.d(e,"Bb",(function(){return jt})),n.d(e,"Cb",(function(){return Tt})),n.d(e,"Db",(function(){return St})),n.d(e,"Fb",(function(){return Nt})),n.d(e,"Gb",(function(){return Ct})),n.d(e,"Hb",(function(){return It})),n.d(e,"Eb",(function(){return Et})),n.d(e,"wb",(function(){return At})),n.d(e,"xb",(function(){return Rt})),n.d(e,"Ib",(function(){return _t})),n.d(e,"Ob",(function(){return Ft})),n.d(e,"Jb",(function(){return Dt})),n.d(e,"Mb",(function(){return Mt})),n.d(e,"Kb",(function(){return Pt})),n.d(e,"Lb",(function(){return Lt})),n.d(e,"Nb",(function(){return Bt})),n.d(e,"Pb",(function(){return Vt})),n.d(e,"Qb",(function(){return zt})),n.d(e,"Rb",(function(){return Ut})),n.d(e,"Sb",(function(){return Wt})),n.d(e,"Tb",(function(){return Gt})),n.d(e,"Ub",(function(){return Ht})),n.d(e,"Vb",(function(){return qt})),n.d(e,"Wb",(function(){return Kt})),n.d(e,"ac",(function(){return Xt})),n.d(e,"Xb",(function(){return Yt})),n.d(e,"Yb",(function(){return Qt})),n.d(e,"Zb",(function(){return Zt})),n.d(e,"cc",(function(){return Jt})),n.d(e,"bc",(function(){return $t})),n.d(e,"dc",(function(){return te})),n.d(e,"ec",(function(){return ee})),n.d(e,"fc",(function(){return ne})),n.d(e,"gc",(function(){return re})),n.d(e,"hc",(function(){return ae})),n.d(e,"ic",(function(){return oe})),n.d(e,"jc",(function(){return ie})),n.d(e,"kc",(function(){return ce})),n.d(e,"mc",(function(){return ue})),n.d(e,"nc",(function(){return se})),n.d(e,"pc",(function(){return le})),n.d(e,"sc",(function(){return de})),n.d(e,"tc",(function(){return fe})),n.d(e,"qc",(function(){return pe})),n.d(e,"rc",(function(){return he})),n.d(e,"oc",(function(){return be})),n.d(e,"uc",(function(){return me})),n.d(e,"wc",(function(){return ve})),n.d(e,"xc",(function(){return ge})),n.d(e,"yc",(function(){return ye})),n.d(e,"zc",(function(){return xe})),n.d(e,"Ac",(function(){return Oe})),n.d(e,"Fc",(function(){return we})),n.d(e,"Dc",(function(){return ke})),n.d(e,"Ec",(function(){return je})),n.d(e,"Cc",(function(){return Te})),n.d(e,"Bc",(function(){return Se})),n.d(e,"Hc",(function(){return Ne})),n.d(e,"Pc",(function(){return Ce})),n.d(e,"Yc",(function(){return Ie})),n.d(e,"Ic",(function(){return Ee})),n.d(e,"Oc",(function(){return Ae})),n.d(e,"Gc",(function(){return Re})),n.d(e,"Jc",(function(){return _e})),n.d(e,"Kc",(function(){return Fe})),n.d(e,"Lc",(function(){return De})),n.d(e,"Mc",(function(){return Me})),n.d(e,"Nc",(function(){return Pe})),n.d(e,"Rc",(function(){return Le})),n.d(e,"Qc",(function(){return Be})),n.d(e,"Tc",(function(){return Ve})),n.d(e,"Uc",(function(){return ze})),n.d(e,"Vc",(function(){return Ue})),n.d(e,"Wc",(function(){return We})),n.d(e,"Xc",(function(){return Ge})),n.d(e,"Zc",(function(){return He})),n.d(e,"ad",(function(){return qe})),n.d(e,"bd",(function(){return Ke})),n.d(e,"cd",(function(){return Xe})),n.d(e,"dd",(function(){return Ye})),n.d(e,"ed",(function(){return Qe})),n.d(e,"fd",(function(){return Ze})),n.d(e,"gd",(function(){return Je})),n.d(e,"hd",(function(){return $e})),n.d(e,"id",(function(){return tn})),n.d(e,"Sc",(function(){return en})),n.d(e,"ib",(function(){return nn})),n.d(e,"vc",(function(){return rn})),n.d(e,"jd",(function(){return an})),n.d(e,"kb",(function(){return on})),n.d(e,"lb",(function(){return cn}));var r="Abs",a="Acos",o="Acosh",i="Add",c="AddN",u="All",s="Any",l="ArgMax",d="ArgMin",f="Asin",p="Asinh",h="Atan",b="Atanh",m="Atan2",v="AvgPool",g="AvgPoolGrad",y="AvgPool3D",x="AvgPool3DGrad",O="BatchMatMul",w="BatchToSpaceND",k="Bincount",j="BroadcastTo",T="Cast",S="Ceil",N="ClipByValue",C="Complex",I="ComplexAbs",E="Concat",A="Conv2D",R="Conv2DBackpropFilter",_="Conv2DBackpropInput",F="Conv3D",D="Conv3DBackpropFilterV2",M="Conv3DBackpropInputV2",P="Cos",L="Cosh",B="Cumsum",V="CropAndResize",z="DenseBincount",U="DepthToSpace",W="DepthwiseConv2dNative",G="DepthwiseConv2dNativeBackpropFilter",H="DepthwiseConv2dNativeBackpropInput",q="Diag",K="Dilation2D",X="Dilation2DBackpropInput",Y="Dilation2DBackpropFilter",Q="RealDiv",Z="Einsum",J="Elu",$="EluGrad",tt="Erf",et="Equal",nt="Exp",rt="ExpandDims",at="Expm1",ot="FFT",it="Fill",ct="FlipLeftRight",ut="Floor",st="FloorDiv",lt="FusedBatchNorm",dt="GatherV2",ft="GatherNd",pt="Greater",ht="GreaterEqual",bt="Identity",mt="IFFT",vt="Imag",gt="IsFinite",yt="IsInf",xt="IsNan",Ot="LeakyRelu",wt="Less",kt="LessEqual",jt="LinSpace",Tt="Log",St="Log1p",Nt="LogicalAnd",Ct="LogicalNot",It="LogicalOr",Et="LogSoftmax",At="LRN",Rt="LRNGrad",_t="Max",Ft="Maximum",Dt="MaxPool",Mt="MaxPoolGrad",Pt="MaxPool3D",Lt="MaxPool3DGrad",Bt="MaxPoolWithArgmax",Vt="Mean",zt="Min",Ut="Minimum",Wt="MirrorPad",Gt="Mod",Ht="Multinomial",qt="Multiply",Kt="Neg",Xt="NotEqual",Yt="NonMaxSuppressionV3",Qt="NonMaxSuppressionV4",Zt="NonMaxSuppressionV5",Jt="OnesLike",$t="OneHot",te="Pack",ee="PadV2",ne="Pool",re="Pow",ae="Prelu",oe="Prod",ie="Range",ce="Real",ue="Reciprocal",se="Relu",le="Reshape",de="ResizeNearestNeighbor",fe="ResizeNearestNeighborGrad",pe="ResizeBilinear",he="ResizeBilinearGrad",be="Relu6",me="Reverse",ve="Round",ge="Rsqrt",ye="ScatterNd",xe="Select",Oe="Selu",we="Slice",ke="Sin",je="Sinh",Te="Sign",Se="Sigmoid",Ne="Softplus",Ce="Sqrt",Ie="Sum",Ee="SpaceToBatchND",Ae="SplitV",Re="Softmax",_e="SparseFillEmptyRows",Fe="SparseReshape",De="SparseSegmentMean",Me="SparseSegmentSum",Pe="SparseToDense",Le="SquaredDifference",Be="Square",Ve="StridedSlice",ze="StringNGrams",Ue="StringSplit",We="StringToHashBucketFast",Ge="Sub",He="Tan",qe="Tanh",Ke="Tile",Xe="TopK",Ye="Transform",Qe="Transpose",Ze="Unique",Je="Unpack",$e="UnsortedSegmentSum",tn="ZerosLike",en="Step",nn="FromPixels",rn="RotateWithOffset",an="_FusedMatMul",on="FusedConv2D",cn="FusedDepthwiseConv2D"},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.r(e),n.d(e,"shuffle",(function(){return a.M})),n.d(e,"shuffleCombo",(function(){return a.N})),n.d(e,"clamp",(function(){return a.i})),n.d(e,"nearestLargerEven",(function(){return a.H})),n.d(e,"swap",(function(){return a.S})),n.d(e,"sum",(function(){return a.R})),n.d(e,"randUniform",(function(){return a.J})),n.d(e,"distSquared",(function(){return a.l})),n.d(e,"assert",(function(){return a.b})),n.d(e,"assertShapesMatch",(function(){return a.e})),n.d(e,"assertNonNull",(function(){return a.d})),n.d(e,"flatten",(function(){return a.m})),n.d(e,"sizeFromShape",(function(){return a.O})),n.d(e,"isScalarShape",(function(){return a.y})),n.d(e,"arraysEqual",(function(){return a.a})),n.d(e,"isInt",(function(){return a.v})),n.d(e,"tanh",(function(){return a.T})),n.d(e,"sizeToSquarishShape",(function(){return a.P})),n.d(e,"createShuffledIndices",(function(){return a.k})),n.d(e,"rightPad",(function(){return a.L})),n.d(e,"repeatedTry",(function(){return a.K})),n.d(e,"inferFromImplicitShape",(function(){return a.s})),n.d(e,"parseAxisParam",(function(){return a.I})),n.d(e,"squeezeShape",(function(){return a.Q})),n.d(e,"getTypedArrayFromDType",(function(){return a.o})),n.d(e,"getArrayFromDType",(function(){return a.n})),n.d(e,"checkConversionForErrors",(function(){return a.h})),n.d(e,"isValidDtype",(function(){return a.B})),n.d(e,"hasEncodingLoss",(function(){return a.p})),n.d(e,"isTypedArray",(function(){return a.A})),n.d(e,"bytesPerElement",(function(){return a.g})),n.d(e,"bytesFromStringArray",(function(){return a.f})),n.d(e,"isString",(function(){return a.z})),n.d(e,"isBoolean",(function(){return a.t})),n.d(e,"isNumber",(function(){return a.w})),n.d(e,"inferDtype",(function(){return a.r})),n.d(e,"isFunction",(function(){return a.u})),n.d(e,"nearestDivisor",(function(){return a.G})),n.d(e,"computeStrides",(function(){return a.j})),n.d(e,"toNestedArray",(function(){return a.U})),n.d(e,"makeOnesTypedArray",(function(){return a.D})),n.d(e,"makeZerosTypedArray",(function(){return a.F})),n.d(e,"makeZerosNestedTypedArray",(function(){return a.E})),n.d(e,"assertNonNegativeIntegerDimensions",(function(){return a.c})),n.d(e,"locToIndex",(function(){return a.C})),n.d(e,"indexToLoc",(function(){return a.q})),n.d(e,"isPromise",(function(){return a.x})),n.d(e,"hexToLong",(function(){return c})),n.d(e,"fingerPrint64",(function(){return O})),n.d(e,"createScalarValue",(function(){return w})),n.d(e,"toTypedArray",(function(){return k})),n.d(e,"now",(function(){return j})),n.d(e,"fetch",(function(){return T})),n.d(e,"encodeString",(function(){return S})),n.d(e,"decodeString",(function(){return N}));var r=n(84),a=n(123),o=n(319),i=n.n(o).a||o;function c(t){return i.fromString(t,!0,16)}var u=c("c3a5c85c97cb3127"),s=c("b492b66fbe98f273"),l=c("9ae16a3b2f90404f");function d(t){return t.xor(t.shru(47))}function f(t,e,n){var r=t.slice(e,e+n);return i.fromBytes(Array.from(r),!0,!0)}function p(t,e){return f(t,e,8)}function h(t,e){return f(t,e,4)}function b(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));var a=e.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function v(t,e,n,r){return function(t,e,n,r,a,o){a=a.add(t),o=b(o.add(a).add(r),21);var i=a;return a=(a=a.add(e)).add(n),o=o.add(b(a,44)),[a.add(r),o.add(i)]}(p(t,e),p(t,e+8),p(t,e+16),p(t,e+24),n,r)}function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){var n=l.add(2*e),r=p(t,0).add(l),a=p(t,e-8),o=b(a,37).mul(n).add(r),i=b(r,25).add(a).mul(n);return m(o,i,n)}if(e>=4){var c=l.add(2*e),s=h(t,0);return m(s.shl(3).add(e),h(t,e-4),c)}if(e>0){var f=t[0],v=t[e>>1],g=t[e-1],y=f+(v<<8),x=e+(g<<2);return d(l.mul(y).xor(u.mul(x))).mul(l)}return l}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=l.add(2*e),r=p(t,0).mul(s),a=p(t,8),o=p(t,e-8).mul(n),i=p(t,e-16).mul(l);return m(b(r.add(a),43).add(b(o,30)).add(i),r.add(b(a.add(l),18)).add(o),n)}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=l.add(2*e),r=p(t,0).mul(l),a=p(t,8),o=p(t,e-8).mul(n),i=p(t,e-16).mul(l),c=b(r.add(a),43).add(b(o,30)).add(i),u=m(c,r.add(b(a.add(l),18)).add(o),n),s=p(t,16).mul(n),d=p(t,24),f=c.add(p(t,e-32)).mul(n),h=u.add(p(t,e-24)).mul(n);return m(b(s.add(d),43).add(b(f,30)).add(h),s.add(b(d.add(r),18)).add(f),n)}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=i.fromNumber(81,!0);if(e<=32)return e<=16?g(t,e):y(t,e);if(e<=64)return x(t,e);var r=n,a=n.mul(s).add(113),o=d(a.mul(l).add(113)).mul(l),c=[i.UZERO,i.UZERO],f=[i.UZERO,i.UZERO];r=r.mul(l).add(p(t,0));var h=0,O=64*(e-1>>6),w=O+(e-1&63)-63;do{r=b(r.add(a).add(c[0]).add(p(t,h+8)),37).mul(s),a=b(a.add(c[1]).add(p(t,h+48)),42).mul(s),r=r.xor(f[1]),a=a.add(c[0]).add(p(t,h+40)),o=b(o.add(f[0]),33).mul(s),c=v(t,h,c[1].mul(s),r.add(f[0])),f=v(t,h+32,o.add(f[1]),a.add(p(t,h+16)));var k=[r,o];o=k[0],r=k[1],h+=64}while(h!==O);var j=s.add(o.and(255).shl(1));h=w,f[0]=f[0].add(e-1&63),c[0]=c[0].add(f[0]),f[0]=f[0].add(c[0]),r=b(r.add(a).add(c[0]).add(p(t,h+8)),37).mul(j),a=b(a.add(c[1]).add(p(t,h+48)),42).mul(j),r=r.xor(f[1].mul(9)),a=a.add(c[0].mul(9).add(p(t,h+40))),o=b(o.add(f[0]),33).mul(j),c=v(t,h,c[1].mul(j),r.add(f[0])),f=v(t,h+32,o.add(f[1]),a.add(p(t,h+16)));var T=[r,o];return o=T[0],r=T[1],m(m(c[0],f[0],j).add(d(a).mul(u)).add(o),m(c[1],f[1],j).add(r),j)}function w(t,e){return"string"===e?S(t):k([t],e)}function k(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=a.m(t)),Object(r.c)().getBool("DEBUG")&&a.h(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),o=0;o<n.length;++o)0!==Math.round(t[o])&&(n[o]=1);return n}throw new Error("Unknown data type ".concat(e))}function j(){return Object(r.c)().platform.now()}function T(t,e){return Object(r.c)().platform.fetch(t,e)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Object(r.c)().platform.encode(t,e)}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Object(r.c)().platform.decode(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(152);var a=n(111),o=n(153);function i(t,e){return Object(r.a)(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(u){a=!0,o=u}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}}(t,e)||Object(a.a)(t,e)||Object(o.a)()}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({reshape_:function(t,e){var n={x:Object(o.a)(t,"x","reshape","string_or_numeric")},i={shape:e};return r.a.runKernel(a.pc,n,i)}})},function(t,e,n){t.exports=n(182)},function(t,e,n){"use strict";function r(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(s){return void n(s)}c.done?e(u):Promise.resolve(u).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var i=t.apply(e,n);function c(t){r(i,a,o,c,u,"next",t)}function u(t){r(i,a,o,c,u,"throw",t)}c(void 0)}))}}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(134);var a=n(151),o=n(111);function i(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||Object(a.a)(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";n.r(e),n.d(e,"makeTypesMatch",(function(){return i})),n.d(e,"assertTypesMatch",(function(){return c})),n.d(e,"isTensorInList",(function(){return u})),n.d(e,"getTensorsInContainer",(function(){return s}));var r=n(92),a=n(113),o=n(123);function i(t,e){if(t.dtype===e.dtype)return[t,e];var n=Object(a.c)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function c(t,e){Object(o.b)(t.dtype===e.dtype,(function(){return"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")}))}function u(t,e){return e.some((function(e){return e.id===t.id}))}function s(t){var e=[];return l(t,e,new Set),e}function l(t,e,n){if(null!=t)if(t instanceof r.a)e.push(t);else if(a=t,Array.isArray(a)||"object"===typeof a){var a,o=t;for(var i in o){var c=o[i];n.has(c)||(n.add(c),l(c,e,n))}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({mul_:function(t,e){var n=Object(c.a)(t,"a","mul"),u=Object(c.a)(e,"b","mul"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.Vb,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(89);function a(t){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(90);function i(t,e){return!e||"object"!==a(e)&&"function"!==typeof e?Object(o.a)(t):e}function c(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=Object(r.a)(t);if(e){var o=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}}},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return f}));var r=n(72),a=n(65);function o(t,e,n,r,o){var c=e.inputParams[t];if(c&&void 0!==c.inputIndexStart){var u=c.inputIndexStart,s=0===c.inputIndexEnd?void 0:void 0===c.inputIndexEnd?u+1:c.inputIndexEnd;if("tensor"===c.type)return i(e.inputNames[c.inputIndexStart],n,r,o);if("tensors"===c.type)return e.inputNames.slice(u,s).map((function(t){return i(t,n,r,o)}));var l=i(e.inputNames.slice(u)[0],n,r,o),d=l.dataSync();return"number"===c.type?d[0]:a.util.toNestedArray(l.shape,d)}var f=e.attrParams[t];return f&&f.value}function i(t,e,n,a){var o=l(t),i=Object(r.a)(o,2),c=i[0],u=i[1];if(null!=a){var d=a.getHashTableHandleByName(c);if(null!=d)return d}var f=n.currentContextIds.find((function(t){return!!e[s(c,t)]}));return void 0!==f?e[s(c,f)][u]:void 0}function c(t,e,n){return e[s(t,n.currentContextId)]}function u(t,e){var n=l(t),a=Object(r.a)(n,3),o=a[0],i=a[1],c=a[2];return[s(o,e&&e.currentContextId),i,c]}function s(t,e){return e?"".concat(t,"-").concat(e):t}function l(t){var e=t.split(":");if(1===e.length)return[t,0,void 0];var n=e[0],r=3===e.length?e[1]:void 0;return[n,Number(e[e.length-1]),r]}function d(t,e,n){var r=o("pad",t,e,n);if("explicit"===r){r=o("explicitPaddings",t,e,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function f(t){return t.kept?t:Object(a.clone)(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({add_:function(t,e){var n=Object(c.a)(t,"a","add"),u=Object(c.a)(e,"b","add"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.d,d)}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return h})),n.d(e,"a",(function(){return b})),n.d(e,"d",(function(){return m}));var r=n(72),a=n(75),o=n.n(a),i=n(76),c=n(70),u=n(73),s=n(123),l="tfjsflags",d=function(){function t(e){Object(c.a)(this,t),this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=f,this.populateURLFlags()}return Object(u.a)(t,[{key:"setPlatform",value:function(t,e){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,".")),this.platformName=t,this.platform=e}},{key:"registerFlag",value:function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}}},{key:"getAsync",value:function(){var t=Object(i.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e in this.flags)){t.next=2;break}return t.abrupt("return",this.flags[e]);case 2:return t.next=4,this.evaluateFlag(e);case 4:return this.flags[e]=t.sent,t.abrupt("return",this.flags[e]);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(t){if(t in this.flags)return this.flags[t];var e=this.evaluateFlag(t);if(Object(s.x)(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}},{key:"getNumber",value:function(t){return this.get(t)}},{key:"getBool",value:function(t){return this.get(t)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}},{key:"evaluateFlag",value:function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}},{key:"setFlags",value:function(t){this.flags=Object.assign({},t)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var t=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var e=this.getQueryParams(this.global.location.search);if(l in e)e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),a=Object(r.a)(n,2),o=a[0],i=a[1];t.urlFlags[o]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if("".concat(+e)===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(o,i)}))}}}]),t}();function f(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return p(e,r[0],r[1]),r.join("=")})),e}function p(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function h(){return b}var b=null;function m(t){b=t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({sub_:function(t,e){var n=Object(c.a)(t,"a","sub"),u=Object(c.a)(e,"b","sub"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.Xc,d)}})},function(t,e,n){"use strict";function r(t,e){for(var n=t.length,r=[],a=0;a<n;a++){var o=n-1-a,i=t[o]||1;(e[e.length-1-a]||1)>1&&1===i&&r.unshift(o)}return r}function a(t,e){for(var n=[],r=0;r<e.length;r++){var a=t[t.length-r-1],o=e.length-r-1,i=e[o];(null==a||1===a&&i>1)&&n.unshift(o)}return n}function o(t,e){for(var n=[],r=Math.max(t.length,e.length),a=0;a<r;a++){var o=t[t.length-a-1];null==o&&(o=1);var i=e[e.length-a-1];if(null==i&&(i=1),1===o)n.unshift(i);else if(1===i)n.unshift(o);else{if(o!==i){var c="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(c)}n.unshift(o)}}return n}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(123),a=n(112);function o(t,e){if((Object(r.A)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(r.A)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(a.a)(t,[],[],e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({cast_:function(t,e){var n=Object(o.a)(t,"x","cast");if(!i.B(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var c={x:n},u={dtype:e};return r.a.runKernel(a.w,c,u)}})},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(186),s=n(66);var l=Object(s.b)({div_:function(t,e){var n=Object(c.a)(t,"a","div"),s=Object(c.a)(e,"b","div"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);if(n=d[0],s=d[1],"int32"===n.dtype&&"int32"===s.dtype)return Object(u.a)(n,s);var f={a:n,b:s};return a.a.runKernel(o.lc,f,{})}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return y})),n.d(e,"f",(function(){return w})),n.d(e,"e",(function(){return k})),n.d(e,"d",(function(){return j})),n.d(e,"a",(function(){return T})),n.d(e,"c",(function(){return S}));var r=n(81),a=n(80),o=n(75),i=n.n(o),c=n(76),u=n(70),s=n(73),l=n(183),d=n(77),f=n(123);function p(t,e,n,r){var a=Object(f.j)(e),o=function(t,e,n,r){var a=Object(f.O)(e),o=r[r.length-1],i=new Array(o).fill(0),c=e.length,u="complex64"===n?v(t):t;if(c>1)for(var s=0;s<a/o;s++)for(var l=s*o,d=0;d<o;d++)i[d]=Math.max(i[d],h(u[l+d],0,n).length);return i}(t,e,n,a),i=e.length,c=m(t,e,n,a,o),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(i)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(c.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function h(t,e,n){var r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(7))," + ")+"".concat(parseFloat(t[1].toFixed(7)),"j"):Object(f.z)(t)?"'".concat(t,"'"):"bool"===n?b(t):parseFloat(t.toFixed(7)).toString(),Object(f.L)(r,e)}function b(t){return 0===t?"false":"true"}function m(t,e,n,r,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i="complex64"===n?2:1,c=e[0],u=e.length;if(0===u){if("complex64"===n){var s=v(t);return[h(s[0],0,n)]}return"bool"===n?[b(t[0])]:[t[0].toString()]}if(1===u){if(c>20){var l=3*i,f=Array.from(t.slice(0,l)),p=Array.from(t.slice((c-3)*i,c*i));return"complex64"===n&&(f=v(f),p=v(p)),["["+f.map((function(t,e){return h(t,a[e],n)})).join(", ")+", ..., "+p.map((function(t,e){return h(t,a[c-3+e],n)})).join(", ")+"]"]}var g="complex64"===n?v(t):Array.from(t);return["["+g.map((function(t,e){return h(t,a[e],n)})).join(", ")+"]"]}var y=e.slice(1),x=r.slice(1),O=r[0]*i,w=[];if(c>20){for(var k=0;k<3;k++){var j=k*O,T=j+O;w.push.apply(w,Object(d.a)(m(t.slice(j,T),y,n,x,a,!1)))}w.push("...");for(var S=c-3;S<c;S++){var N=S*O,C=N+O;w.push.apply(w,Object(d.a)(m(t.slice(N,C),y,n,x,a,S===c-1)))}}else for(var I=0;I<c;I++){var E=I*O,A=E+O;w.push.apply(w,Object(d.a)(m(t.slice(E,A),y,n,x,a,I===c-1)))}var R=2===u?",":"";w[0]="["+w[0]+R;for(var _=1;_<w.length-1;_++)w[_]=" "+w[_]+R;for(var F=",\n",D=2;D<u;D++)F+="\n";return w[w.length-1]=" "+w[w.length-1]+"]"+(o?"":F),w}function v(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var g=n(71),y=function(){function t(e,n,r){var a=this;if(Object(u.a)(this,t),this.dtype=n,this.shape=e.slice(),this.size=f.O(e),null!=r){var o=r.length;f.b(o===this.size,(function(){return"Length of values '".concat(o,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||f.n(n,this.size),this.strides=Object(f.j)(e)}return Object(s.a)(t,[{key:"set",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),f.b(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(e.rank,")")}));var o=this.locToIndex(r);this.values[o]=t}},{key:"get",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);for(var r=0,a=0,o=e;a<o.length;a++){var i=o[a];if(i<0||i>=this.shape[r]){var c="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(c)}r++}for(var u=e[e.length-1],s=0;s<e.length-1;++s)u+=this.strides[s]*e[s];return this.values[u]}},{key:"locToIndex",value:function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}},{key:"indexToLoc",value:function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return x().makeTensor(this.values,this.shape,this.dtype)}}]),t}(),x=null,O=null;function w(t){x=t}function k(t){O=t}function j(t){t}var T=function(){function t(e,n,r,a){Object(u.a)(this,t),this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=f.O(e),this.strides=Object(f.j)(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object(s.a)(t,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var t=Object(c.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",O.buffer(this.shape,this.dtype,e));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return O.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var t=Object(c.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",Object(f.U)(this.shape,e,"complex64"===this.dtype));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"arraySync",value:function(){return Object(f.U)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var t=Object(c.a)(i.a.mark((function t(){var e,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfDisposed(),e=x().read(this.dataId),"string"!==this.dtype){t.next=13;break}return t.next=5,e;case 5:return n=t.sent,t.prev=6,t.abrupt("return",n.map((function(t){return g.decodeString(t)})));case 10:throw t.prev=10,t.t0=t.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[6,10]])})));return function(){return t.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var t=x().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return g.decodeString(t)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}},{key:"bytes",value:function(){var t=Object(c.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.throwIfDisposed(),t.next=3,x().read(this.dataId);case 3:if(e=t.sent,"string"!==this.dtype){t.next=8;break}return t.abrupt("return",e);case 8:return t.abrupt("return",new Uint8Array(e.buffer));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(x().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return O.print(this,t)}},{key:"clone",value:function(){return this.throwIfDisposed(),O.clone(this)}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.dataSync();return p(e,this.shape,this.dtype,t)}},{key:"cast",value:function(t){return this.throwIfDisposed(),O.cast(this,t)}},{key:"variable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),x().makeVariable(this,t,e,n)}}]),t}();Object.defineProperty(T,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}}),Object(l.a)("Tensor",(function(){return T}));var S=function(t){Object(r.a)(n,t);var e=Object(a.a)(n);function n(t,r,a,o){var i;return Object(u.a)(this,n),(i=e.call(this,t.shape,t.dtype,t.dataId,o)).trainable=r,i.name=a,i}return Object(s.a)(n,[{key:"assign",value:function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!f.a(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));x().disposeTensor(this),this.dataId=t.dataId,x().incRef(this,null)}},{key:"dispose",value:function(){x().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(T);Object.defineProperty(S,Symbol.hasInstance,{value:function(t){return t instanceof T&&null!=t.assign&&t.assign instanceof Function}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"f",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return s}));var r=n(77),a=n(68),o=n(92),i=n(67),c=n(123);function u(t){return c.b(c.u(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=Object(i.a)(e,"x","tf.grad","string_or_numeric"),o=null!=n?Object(i.a)(n,"dy","tf.grad"):null;return a.a.tidy((function(){var e=a.a.gradients((function(){return t(r)}),[r],o),n=e.value,i=e.grads;return null!=o&&c.e(n.shape,o.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),h(i),i[0]}))}}function s(t){return c.b(c.u(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){c.b(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var o=Object(i.b)(e,"args","tf.grads","string_or_numeric"),u=null!=n?Object(i.a)(n,"dy","tf.grads"):null;return a.a.tidy((function(){var e=a.a.gradients((function(){return t.apply(void 0,Object(r.a)(o))}),o,u),n=e.value,i=e.grads;return null!=u&&c.e(n.shape,u.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(i),i}))}}function l(t){return c.b(c.u(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){c.b(e instanceof o.a,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),c.b(null==n||n instanceof o.a,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.a.gradients((function(){return t(e)}),[e],n),i=r.grads,u=r.value;return h(i),{grad:i[0],value:u}}}function d(t){return c.b(c.u(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){c.b(Array.isArray(e)&&e.every((function(t){return t instanceof o.a})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),c.b(null==n||n instanceof o.a,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var i=a.a.gradients((function(){return t.apply(void 0,Object(r.a)(e))}),e,n);return null!=n&&c.e(i.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),h(i.grads),i}}function f(t,e){c.b(c.u(t),(function(){return"The f passed in variableGrads(f) must be a function"})),c.b(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof o.c})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],a.a.registeredVariables)e.push(a.a.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,u=e.length;e=e.filter((function(t){return t.trainable})),c.b(e.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(u," variables is ")+"trainable."}));var s=a.a.gradients(t,e,null,!0),l=s.value,d=s.grads;c.b(d.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),c.b(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var f={};return e.forEach((function(t,e){null!=d[e]&&(f[t.name]=d[e])})),null!=i&&i.forEach((function(t){return f[t.name]=null})),{value:l,grads:f}}function p(t){return a.a.customGrad(t)}function h(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(111);function a(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(r.a)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){u=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw i}}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({slice_:function(t,e,n){var i=Object(o.a)(t,"x","slice","string_or_numeric");if(0===i.rank)throw new Error("Slicing scalar is not possible");var c={x:i},u={begin:e,size:n};return r.a.runKernel(a.Fc,c,u)}})},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";(function(t){n.d(e,"f",(function(){return f})),n.d(e,"e",(function(){return h})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return y})),n.d(e,"d",(function(){return x})),n.d(e,"c",(function(){return O})),n.d(e,"i",(function(){return w})),n.d(e,"g",(function(){return k})),n.d(e,"h",(function(){return T}));var r=n(72),a=n(75),o=n.n(a),i=n(94),c=n(76),u=n(114),s=n(136),l=n(123),d=n(235);function f(t,e){return p.apply(this,arguments)}function p(){return(p=Object(c.a)(o.a.mark((function t(e,n){var r,a,i,u,s,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=[],a=[],i=Array.isArray(e)?e.map((function(t){return t.name})):Object.keys(e),u=function(t){var u=i[t],s=Array.isArray(e)?e[t].tensor:e[u];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(s.dtype));var l={name:u,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var d=new Promise(function(){var t=Object(c.a)(o.a.mark((function t(e){var n,r,a,i,c,u,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.bytes();case 2:for(n=t.sent,r=n.reduce((function(t,e){return t+e.length}),0)+4*n.length,a=new Uint8Array(r),i=0,c=0;c<n.length;c++)u=n[c],l=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(l,i),i+=4,a.set(u,i),i+=u.length;e(a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());a.push(d)}else a.push(s.data());null!=n&&(l.group=n),r.push(l)},s=0;s<i.length;++s)u(s);return t.next=7,Promise.all(a);case 7:return l=t.sent,t.abrupt("return",{data:b(l),specs:r});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(t,e){var n,r,a={},o=0,c=Object(i.a)(e);try{for(c.s();!(r=c.n()).done;){var f=r.value,p=f.name,h=f.dtype,b=f.shape,m=Object(l.O)(b),v=void 0;if("quantization"in f){var g=f.quantization;if("uint8"===g.dtype||"uint16"===g.dtype){if(!("min"in g)||!("scale"in g))throw new Error("Weight ".concat(f.name," with quantization ").concat(g.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==g.dtype)throw new Error("Weight ".concat(f.name," has unknown ")+"quantization dtype ".concat(g.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==h)throw new Error("Weight ".concat(f.name," is quantized with ").concat(g.dtype," ")+"which only supports weights of type float32 not ".concat(h,"."))}var y=d.a[g.dtype],x=t.slice(o,o+m*y),O="uint8"===g.dtype?new Uint8Array(x):new Uint16Array(x);if("float32"===h)if("uint8"===g.dtype||"uint16"===g.dtype){v=new Float32Array(O.length);for(var w=0;w<O.length;w++){var k=O[w];v[w]=k*g.scale+g.min}}else{if("float16"!==g.dtype)throw new Error("Unsupported quantization type ".concat(g.dtype," ")+"for weight type float32.");void 0===n&&(n=S()),v=n(O)}else{if("int32"!==h)throw new Error("Unsupported dtype in weight '".concat(p,"': ").concat(h));if("uint8"!==g.dtype&&"uint16"!==g.dtype)throw new Error("Unsupported quantization type ".concat(g.dtype," ")+"for weight type int32.");v=new Int32Array(O.length);for(var j=0;j<O.length;j++){var T=O[j];v[j]=Math.round(T*g.scale+g.min)}}o+=m*y}else if("string"===h){var N=Object(l.O)(f.shape);v=[];for(var C=0;C<N;C++){var I=new Uint32Array(t.slice(o,o+4))[0];o+=4;var E=new Uint8Array(t.slice(o,o+I));v.push(E),o+=I}}else{var A=d.a[h],R=t.slice(o,o+m*A);if("float32"===h)v=new Float32Array(R);else if("int32"===h)v=new Int32Array(R);else if("bool"===h)v=new Uint8Array(R);else{if("complex64"!==h)throw new Error("Unsupported dtype in weight '".concat(p,"': ").concat(h));v=new Float32Array(R);for(var _=new Float32Array(v.length/2),F=new Float32Array(v.length/2),D=0;D<_.length;D++)_[D]=v[2*D],F[D]=v[2*D+1];var M=Object(s.a)(_,b,"float32"),P=Object(s.a)(F,b,"float32");a[p]=Object(u.a)(M,P),M.dispose(),P.dispose()}o+=m*A}"complex64"!==h&&(a[p]=Object(s.a)(v,b,h))}}catch(L){c.e(L)}finally{c.f()}return a}function b(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));var r=new Uint8Array(e),a=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),a),a+=t.byteLength})),r.buffer}var m="undefined"!==typeof t&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function v(e){return m?t.byteLength(e):new Blob([e]).size}function g(e){if(m)return t.from(e).toString("base64");for(var n=new Uint8Array(e),r="",a=0,o=n.length;a<o;a++)r+=String.fromCharCode(n[a]);return btoa(r)}function y(e){if(m){var n=t.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}for(var r=atob(e),a=new Uint8Array(r.length),o=0;o<r.length;++o)a.set([r.charCodeAt(o)],o);return a.buffer}function x(t){if(1===t.length)return t[0];var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function O(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function w(t,e){var n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function k(t,e){return j.apply(this,arguments)}function j(){return(j=Object(c.a)(o.a.mark((function t(e,n){var a,i,c,u,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy},null!=e.trainingConfig&&(a.trainingConfig=e.trainingConfig),null==e.weightsManifest){t.next=11;break}return t.next=5,n(e.weightsManifest);case 5:i=t.sent,c=Object(r.a)(i,2),u=c[0],s=c[1],a.weightSpecs=u,a.weightData=s;case 11:return null!=e.signature&&(a.signature=e.signature),null!=e.userDefinedMetadata&&(a.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(a.modelInitializer=e.modelInitializer),t.abrupt("return",a);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:v(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:v(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function S(){var t=function(){var t=function(t){for(var e=t<<13,n=0;0===(8388608&e);)n-=8388608,e<<=1;return(e&=-8388609)|n+947912704},e=new Uint32Array(2048);e[0]=0;for(var n=1;n<1024;n++)e[n]=t(n);for(var r=1024;r<2048;r++)e[r]=939524096+(r-1024<<13);return e}(),e=function(){var t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(var e=1;e<31;e++)t[e]=e<<23;for(var n=33;n<63;n++)t[n]=2147483648+(n-32<<23);return t}(),n=function(){for(var t=new Uint32Array(64),e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return function(r){for(var a=new ArrayBuffer(4*r.length),o=new Uint32Array(a),i=0;i<r.length;i++){var c=r[i],u=t[n[c>>10]+(1023&c)]+e[c>>10];o[i]=u}return new Float32Array(a)}}}).call(this,n(234).Buffer)},function(t,e,n){"use strict";n.d(e,"g",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"m",(function(){return p})),n.d(e,"n",(function(){return h})),n.d(e,"t",(function(){return b})),n.d(e,"d",(function(){return m})),n.d(e,"l",(function(){return v})),n.d(e,"u",(function(){return g})),n.d(e,"r",(function(){return y})),n.d(e,"o",(function(){return x})),n.d(e,"k",(function(){return O})),n.d(e,"q",(function(){return w})),n.d(e,"i",(function(){return k})),n.d(e,"j",(function(){return j})),n.d(e,"p",(function(){return T})),n.d(e,"a",(function(){return S})),n.d(e,"s",(function(){return N}));var r=n(68),a=n(84),o=n(92),i=n(78);function c(){Object(a.c)().set("PROD",!0)}function u(){Object(a.c)().set("DEBUG",!0)}function s(){Object(a.c)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){Object(a.c)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d(){r.a.disposeVariables()}function f(){return r.a}function p(){return r.a.memory()}function h(t){return r.a.profile(t)}function b(t,e){return r.a.tidy(t,e)}function m(t){Object(i.getTensorsInContainer)(t).forEach((function(t){return t.dispose()}))}function v(t){return r.a.keep(t)}function g(t){return r.a.time(t)}function y(t){return r.a.setBackend(t)}function x(){return r.a.ready()}function O(){return r.a.backendName}function w(t){r.a.removeBackend(t)}function k(t){return r.a.findBackend(t)}function j(t){return r.a.findBackendFactory(t)}function T(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.a.registerBackend(t,e,n)}function S(){return r.a.backend}function N(t,e){Object(a.c)().setPlatform(t,e)}Object(o.d)(l)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(124),u=n(66);var s=Object(u.b)({concat_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(i.b)(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Object(o.b)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return Object(c.a)(n[0]);var u=n,s={axis:e};return r.a.runKernel(a.B,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(88),c=n(66);var u=Object(c.b)({sum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=Object(o.a)(t,"x","sum");"bool"===c.dtype&&(c=Object(i.a)(c,"int32"));var u={x:c},s={axis:e,keepDims:n};return r.a.runKernel(a.Yc,u,s)}})},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return l})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return g})),n.d(e,"g",(function(){return y}));var r=n(72),a=n(77);function o(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,c=t[3],s=[].concat(Object(a.a)(e),[c]),l=y(o);return u(t,s,n,i,r,null,null,l)}function i(t,e,n,a,o,i){var c,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=d(e),f=Object(r.a)(l,2),p=f[0],h=f[1];if("channelsLast"===s)c=[p,h,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));c=[p,h,t[1],t[1]]}return u(t,c,n,a,o,i,!1,s)}function c(t,e,n,a,o,i){var c,u,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",d=f(e),p=Object(r.a)(d,3),h=p[0],b=p[1],m=p[2];if("NDHWC"===l)u="channelsLast",c=[h,b,m,t[4],t[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));u="channelsFirst",c=[h,b,m,t[1],t[1]]}return s(t,c,n,a,o,!1,u,i)}function u(t,e,n,a,o,i){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",s=-1,l=-1,f=-1,b=-1;if("channelsLast"===u){var m=Object(r.a)(t,4);s=m[0],l=m[1],f=m[2],b=m[3]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var v=Object(r.a)(t,4);s=v[0],b=v[1],l=v[2],f=v[3]}var g,y=Object(r.a)(e,4),x=y[0],O=y[1],w=y[3],k=d(n),j=Object(r.a)(k,2),T=j[0],S=j[1],N=d(a),C=Object(r.a)(N,2),I=C[0],E=C[1],A=p(x,I),R=p(O,E),_=h(o,l,f,T,S,A,R,i,u),F=_.padInfo,D=_.outHeight,M=_.outWidth,P=c?w*b:w;return"channelsFirst"===u?g=[s,P,D,M]:"channelsLast"===u&&(g=[s,D,M,P]),{batchSize:s,dataFormat:u,inHeight:l,inWidth:f,inChannels:b,outHeight:D,outWidth:M,outChannels:P,padInfo:F,strideHeight:T,strideWidth:S,filterHeight:x,filterWidth:O,effectiveFilterHeight:A,effectiveFilterWidth:R,dilationHeight:I,dilationWidth:E,inShape:t,outShape:g,filterShape:e}}function s(t,e,n,a,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=arguments.length>7?arguments[7]:void 0,s=-1,l=-1,d=-1,h=-1,m=-1;if("channelsLast"===c){var v=Object(r.a)(t,5);s=v[0],l=v[1],d=v[2],h=v[3],m=v[4]}else{if("channelsFirst"!==c)throw new Error("Unknown dataFormat ".concat(c));var g=Object(r.a)(t,5);s=g[0],m=g[1],l=g[2],d=g[3],h=g[4]}var y,x=Object(r.a)(e,5),O=x[0],w=x[1],k=x[2],j=x[4],T=f(n),S=Object(r.a)(T,3),N=S[0],C=S[1],I=S[2],E=f(a),A=Object(r.a)(E,3),R=A[0],_=A[1],F=A[2],D=p(O,R),M=p(w,_),P=p(k,F),L=b(o,l,d,h,N,C,I,D,M,P,u),B=L.padInfo,V=L.outDepth,z=L.outHeight,U=L.outWidth,W=i?j*m:j;return"channelsFirst"===c?y=[s,W,V,z,U]:"channelsLast"===c&&(y=[s,V,z,U,W]),{batchSize:s,dataFormat:c,inDepth:l,inHeight:d,inWidth:h,inChannels:m,outDepth:V,outHeight:z,outWidth:U,outChannels:W,padInfo:B,strideDepth:N,strideHeight:C,strideWidth:I,filterDepth:O,filterHeight:w,filterWidth:k,effectiveFilterDepth:D,effectiveFilterHeight:M,effectiveFilterWidth:P,dilationDepth:R,dilationHeight:_,dilationWidth:F,inShape:t,outShape:y,filterShape:e}}function l(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=p(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function d(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function f(t){return"number"===typeof t?[t,t,t]:t}function p(t,e){return e<=1?t:t+(t-1)*(e-1)}function h(t,e,n,r,a,o,i,c,u){var s,d,f;if("number"===typeof t){s={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var p=function(t,e,n,r,a){null==r&&(r=l(t,e,n));var o=t[0],i=t[1];return[m((o-e+2*r)/n+1,a),m((i-e+2*r)/n+1,a)]}([e,n],o,r,t,c);d=p[0],f=p[1]}else if("same"===t){d=Math.ceil(e/r),f=Math.ceil(n/a);var h=Math.max(0,(d-1)*r+o-e),b=Math.max(0,(f-1)*a+i-n),v=Math.floor(h/2),g=h-v,y=Math.floor(b/2);s={top:v,bottom:g,left:y,right:b-y,type:"SAME"}}else if("valid"===t)s={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-o+1)/r),f=Math.ceil((n-i+1)/a);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));var x="channelsLast"===u?t[1][0]:t[2][0],O="channelsLast"===u?t[1][1]:t[2][1],w="channelsLast"===u?t[2][0]:t[3][0],k="channelsLast"===u?t[2][1]:t[3][1];s={top:x,bottom:O,left:w,right:k,type:0===x&&0===O&&0===w&&0===k?"VALID":"EXPLICIT"},d=m((e-o+x+O)/r+1,c),f=m((n-i+w+k)/a+1,c)}return{padInfo:s,outHeight:d,outWidth:f}}function b(t,e,n,r,a,o,i,c,u,s,d){var f,p,h,b;if("number"===typeof t){f={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var v=function(t,e,n,r,a,o){null==a&&(a=l(t,e,r));var i=t[0],c=t[1],u=t[2];return[m((i-e+2*a)/r+1,o),m((c-e+2*a)/r+1,o),m((u-e+2*a)/r+1,o),n]}([e,n,r,1],c,1,a,t,d);p=v[0],h=v[1],b=v[2]}else if("same"===t){var g=((p=Math.ceil(e/a))-1)*a+c-e,y=((h=Math.ceil(n/o))-1)*o+u-n,x=((b=Math.ceil(r/i))-1)*i+s-r,O=Math.floor(g/2),w=g-O,k=Math.floor(y/2),j=y-k,T=Math.floor(x/2);f={top:k,bottom:j,left:T,right:x-T,front:O,back:w,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-c+1)/a),h=Math.ceil((n-u+1)/o),b=Math.ceil((r-s+1)/i)}return{padInfo:f,outDepth:p,outHeight:h,outWidth:b}}function m(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function v(t){var e=d(t),n=Object(r.a)(e,3),a=n[0],o=n[1],i=n[2];return 1===a&&1===o&&1===i}function g(t,e){return v(t)||v(e)}function y(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(92),a=n(123);function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",a.c(t),new r.b(t,e,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({zerosLike_:function(t){var e={x:Object(o.a)(t,"x","zerosLike")};return r.a.runKernel(a.id,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(68),a=n(67),o=n(66);var i=Object(o.b)({square_:function(t){var e=Object(a.a)(t,"x","square");return r.a.runKernel("Square",{x:e},{})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({matMul_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object(c.a)(t,"a","matMul"),l=Object(c.a)(e,"b","matMul"),d=Object(i.makeTypesMatch)(s,l),f=Object(r.a)(d,2),p={a:s=f[0],b:l=f[1]},h={transposeA:n,transposeB:u};return a.a.runKernel(o.s,p,h)}})},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(134);function a(t,e){if(t){if("string"===typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(68),a=n(123),o=n(71);function i(t,e,n,i){if(null==i&&(i=Object(a.r)(t)),"complex64"===i)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a.A)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(a.c)(e);var c=Object(a.O)(e),u=Object(a.O)(n);Object(a.b)(c===u,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(c," values but has ").concat(u)}));for(var s=0;s<n.length;++s){var l=n[s],d=s!==n.length-1||l!==Object(a.O)(e.slice(s));Object(a.b)(n[s]===e[s]||!d,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return Object(a.A)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==i?Object(o.toTypedArray)(t,i):Object(a.m)(t,[],!0),r.a.makeTensor(t,e,i)}},function(t,e,n){"use strict";var r,a,o,i,c;n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return l})),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(o||(o={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(c||(c={}));var u={float32:i,int32:a,bool:o,complex64:c};function s(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return u[t][e]}function l(t){return s(t,"int32")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({complex_:function(t,e){var n=Object(o.a)(t,"real","complex"),c=Object(o.a)(e,"imag","complex");i.e(n.shape,c.shape,"real and imag shapes, ".concat(n.shape," and ").concat(c.shape,", ")+"must match in call to tf.complex().");var u={real:n,imag:c};return r.a.runKernel(a.z,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({abs_:function(t){var e=Object(o.a)(t,"x","abs");if("complex64"===e.dtype){var n={x:e};return r.a.runKernel(a.A,n)}var i={x:e};return r.a.runKernel(a.a,i)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({neg_:function(t){var e={x:Object(o.a)(t,"x","neg")};return r.a.runKernel(a.Wb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({reverse_:function(t,e){var n={x:Object(o.a)(t,"x","reverse")},i={dims:e};return r.a.runKernel(a.uc,n,i)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(67),a=n(123),o=n(112);function i(t,e){Object(a.d)(t);var n=Object(r.c)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(o.a)(t,null,n,e)}},function(t,e,n){"use strict";n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return v}));var r=n(86),a=n(194),o=n(200),i=n(79),c=n(211),u=n(144),s=n(214),l=n(74),d=n(139),f=n(218),p=n(100);function h(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Object(i.a)(t,Object(f.a)(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function b(t,e){var n=e,a=r.c(t.shape,e.shape);return a.length>0&&(n=Object(p.a)(n,a)),Object(l.a)(n,t.shape)}function m(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Object(u.a)(t);if("elu"===e)return Object(a.a)(t);if("relu6"===e)return Object(s.a)(t);if("prelu"===e)return Object(c.a)(t,n);if("leakyrelu"===e)return Object(o.a)(t,r);if("sigmoid"===e)return Object(d.a)(t);throw new Error("Unknown fused activation ".concat(e,"."))}var v=function(t,e){return!(t>0)||"linear"===e}},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var r=n(77);function a(t,e,n){var r=function(t,e,n){return function(t,e,n){var r=0,a=t.length,o=0,i=!1;for(;r<a;){var c=n(e,t[o=r+(a-r>>>1)]);c>0?r=o+1:(a=o,i=!c)}return i?r:-r-1}(t,e,n||o)}(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function o(t,e){return t>e?1:t<e?-1:0}function i(t,e,n,r,a){return s(t,e,n,r,a,0)}function c(t,e,n,r,a,o){return s(t,e,n,r,a,0,!1,o,!0)}function u(t,e,n,r,a,o){return s(t,e,n,r,a,o,!0)}function s(t,e,n,o,i,c){for(var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8],h=[],b=0;b<e.length;b++)e[b]>i&&h.push({score:e[b],boxIndex:b,suppressBeginIndex:0});h.sort(f);for(var m=c>0?-.5/c:0,v=[],g=[];v.length<n&&h.length>0;){var y=h.pop(),x=y.score,O=y.boxIndex,w=y.suppressBeginIndex;if(x<i)break;for(var k=!1,j=v.length-1;j>=w;--j){var T=l(t,O,v[j]);if(T>=o){k=!0;break}if(y.score=y.score*d(o,m,T),y.score<=i)break}y.suppressBeginIndex=v.length,k||(y.score===x?(v.push(O),g.push(y.score)):y.score>i&&a(h,y,f))}var S=v.length,N=n-S;s&&N>0&&(v.push.apply(v,Object(r.a)(new Array(N).fill(0))),g.push.apply(g,Object(r.a)(new Array(N).fill(0))));var C={selectedIndices:v};return u&&(C.selectedScores=g),p&&(C.validOutputs=S),C}function l(t,e,n){var r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),c=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),s=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),p=(c-o)*(u-i),h=(d-s)*(f-l);if(p<=0||h<=0)return 0;var b=Math.max(o,s),m=Math.max(i,l),v=Math.min(c,d),g=Math.min(u,f),y=Math.max(v-b,0)*Math.max(g-m,0);return y/(p+h-y)}function d(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function f(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}},function(t,e,n){"use strict";function r(t){for(var e=t.length,n=0;e>0;)n=Math.random()*e|0,c(t,--e,n)}function a(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(t.length)+"Second array length was ".concat(e.length));for(var n=t.length,r=0;n>0;)r=Math.random()*n|0,c(t,--n,r),c(e,n,r)}function o(t,e,n){return Math.max(t,Math.min(e,n))}function i(t){return t%2===0?t:t+1}function c(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function u(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function s(t,e){var n=Math.random();return e*n+(1-n)*t}function l(t,e){for(var n=0,r=0;r<t.length;r++){var a=Number(t[r])-Number(e[r]);n+=a*a}return n}function d(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";d(v(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}function p(t){d(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||R(t)&&!n)for(var r=0;r<t.length;++r)h(t[r],e,n);else e.push(t);return e}function b(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function m(t){return 0===t.length}function v(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function g(t){return t%1===0}function y(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function x(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function O(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return r(e),e}function w(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function k(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var o=0;!function i(){if(t())r();else{o++;var c=e(o);null!=n&&o>=n?a():setTimeout(i,c)}}()}))}function j(t,e){for(var n=1,r=-1,a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found ".concat(t[a]," at dim ").concat(a));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));var o=t.slice();return o[r]=e/n,o}function T(t,e){var n=e.length;return d((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),d(t.every((function(t){return g(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function S(t,e){for(var n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||a?null:T(e,t).sort(),i=0,c=0;c<t.length;++c){if(null!=o){if(o[i]===c&&1!==t[c])throw new Error("Can't squeeze axis ".concat(c," since its dim '").concat(t[c],"' is not 1"));(null==o[i]||o[i]>c)&&1===t[c]&&(n.push(t[c]),r.push(c)),o[i]<=c&&i++}1!==t[c]&&(n.push(t[c]),r.push(c))}return{newShape:n,keptDims:r}}function N(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type ".concat(t));n=new Uint8Array(e)}return n}function C(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function I(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function E(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function A(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function R(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function _(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function F(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function D(t){return"string"===typeof t||t instanceof String}function M(t){return"boolean"===typeof t}function P(t){return"number"===typeof t}function L(t){return Array.isArray(t)?L(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":P(t)?"float32":D(t)?"string":M(t)?"bool":"float32"}function B(t){return!!(t&&t.constructor&&t.call&&t.apply)}function V(t,e){for(var n=e;n<t;++n)if(t%n===0)return n;return t}function z(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function U(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===e.length)for(var o=e[0]*(r?2:1),i=0;i<o;i++)a[i]=n[t+i];else for(var c=e[0],u=e.slice(1),s=u.reduce((function(t,e){return t*e}))*(r?2:1),l=0;l<c;l++)a[l]=U(t+l*s,u,n,r);return a}function W(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];var r=t.reduce((function(t,e){return t*e}))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return U(0,t,e,n)}function G(t,e){for(var n=H(t,e),r=0;r<n.length;r++)n[r]=1;return n}function H(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function q(t,e){var n=t.reduce((function(t,e){return t*e}),1);if(null==e||"float32"===e)return W(t,new Float32Array(n));if("int32"===e)return W(t,new Int32Array(n));if("bool"===e)return W(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function K(t){t.forEach((function(e){d(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function X(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function Y(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function Q(t){return t&&t.then&&"function"===typeof t.then}n.d(e,"M",(function(){return r})),n.d(e,"N",(function(){return a})),n.d(e,"i",(function(){return o})),n.d(e,"H",(function(){return i})),n.d(e,"S",(function(){return c})),n.d(e,"R",(function(){return u})),n.d(e,"J",(function(){return s})),n.d(e,"l",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return f})),n.d(e,"d",(function(){return p})),n.d(e,"m",(function(){return h})),n.d(e,"O",(function(){return b})),n.d(e,"y",(function(){return m})),n.d(e,"a",(function(){return v})),n.d(e,"v",(function(){return g})),n.d(e,"T",(function(){return y})),n.d(e,"P",(function(){return x})),n.d(e,"k",(function(){return O})),n.d(e,"L",(function(){return w})),n.d(e,"K",(function(){return k})),n.d(e,"s",(function(){return j})),n.d(e,"I",(function(){return T})),n.d(e,"Q",(function(){return S})),n.d(e,"o",(function(){return N})),n.d(e,"n",(function(){return C})),n.d(e,"h",(function(){return I})),n.d(e,"B",(function(){return E})),n.d(e,"p",(function(){return A})),n.d(e,"A",(function(){return R})),n.d(e,"g",(function(){return _})),n.d(e,"f",(function(){return F})),n.d(e,"z",(function(){return D})),n.d(e,"t",(function(){return M})),n.d(e,"w",(function(){return P})),n.d(e,"r",(function(){return L})),n.d(e,"u",(function(){return B})),n.d(e,"G",(function(){return V})),n.d(e,"j",(function(){return z})),n.d(e,"U",(function(){return W})),n.d(e,"D",(function(){return G})),n.d(e,"F",(function(){return H})),n.d(e,"E",(function(){return q})),n.d(e,"c",(function(){return K})),n.d(e,"C",(function(){return X})),n.d(e,"q",(function(){return Y})),n.d(e,"x",(function(){return Q}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({clone_:function(t){var e={x:Object(o.a)(t,"x","clone","string_or_numeric")};return r.a.runKernel(a.rb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({sqrt_:function(t){var e={x:Object(o.a)(t,"x","sqrt")};return r.a.runKernel(a.Pc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(192),c=n(86),u=n(66);var s=Object(u.b)({where_:function(t,e,n){var u=Object(o.a)(e,"a","where"),s=Object(o.a)(n,"b","where"),l=Object(o.a)(t,"condition","where","bool"),d=Object(c.a)(Object(c.a)(l.shape,u.shape),s.shape),f={condition:Object(i.a)(l,d),t:Object(i.a)(u,d),e:Object(i.a)(s,d)};return r.a.runKernel(a.zc,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({exp_:function(t){var e={x:Object(o.a)(t,"x","exp")};return r.a.runKernel(a.ab,e)}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return d}));var r=n(123);function a(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function o(t,e,n){for(var r=t.length+e.length,a=[],o=0,i=0,c=0;c<r;c++)-1===n.indexOf(c)?a.push(t[o++]):a.push(e[i++]);return a}function i(t,e){for(var n=[],r=t.length,a=0;a<r;a++)-1===e.indexOf(a)&&n.push(t[a]);return[n,e.map((function(e){return t[e]}))]}function c(t,e){return o(t,e.map((function(t){return 1})),e)}function u(t,e,n){r.b(a(e,n),(function(){return"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")}))}function s(t,e){if(a(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function l(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function d(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({pad_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(o.a)(t,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var c={paddings:e,constantValue:n},u={x:i};return r.a.runKernel(a.ec,u,c)}})},function(t,e){(function(e){t.exports=e}).call(this,{})},,,function(t,e,n){"use strict";n.d(e,"b",(function(){return a.a})),n.d(e,"c",(function(){return o.a})),n.d(e,"d",(function(){return i.a})),n.d(e,"e",(function(){return c.a})),n.d(e,"f",(function(){return u.a})),n.d(e,"g",(function(){return s.a})),n.d(e,"h",(function(){return l.a})),n.d(e,"i",(function(){return d.a})),n.d(e,"j",(function(){return f.a})),n.d(e,"k",(function(){return p.a})),n.d(e,"l",(function(){return h.a})),n.d(e,"m",(function(){return b.a})),n.d(e,"n",(function(){return m.a})),n.d(e,"o",(function(){return v.a})),n.d(e,"p",(function(){return g.a})),n.d(e,"q",(function(){return y.a})),n.d(e,"r",(function(){return C})),n.d(e,"w",(function(){return I.a})),n.d(e,"s",(function(){return E.a})),n.d(e,"t",(function(){return R})),n.d(e,"u",(function(){return _})),n.d(e,"v",(function(){return F})),n.d(e,"x",(function(){return D.a})),n.d(e,"z",(function(){return M.a})),n.d(e,"A",(function(){return P.a})),n.d(e,"B",(function(){return L.a})),n.d(e,"C",(function(){return B.a})),n.d(e,"D",(function(){return V.a})),n.d(e,"E",(function(){return z.a})),n.d(e,"F",(function(){return U.a})),n.d(e,"G",(function(){return O.a})),n.d(e,"H",(function(){return W})),n.d(e,"I",(function(){return G})),n.d(e,"J",(function(){return H})),n.d(e,"K",(function(){return q})),n.d(e,"L",(function(){return K.a})),n.d(e,"M",(function(){return X.a})),n.d(e,"N",(function(){return Y.a})),n.d(e,"O",(function(){return Q.a})),n.d(e,"P",(function(){return et})),n.d(e,"Q",(function(){return nt.a})),n.d(e,"R",(function(){return rt.a})),n.d(e,"T",(function(){return at.a})),n.d(e,"U",(function(){return ot.a})),n.d(e,"V",(function(){return it.a})),n.d(e,"W",(function(){return ct.a})),n.d(e,"X",(function(){return ut})),n.d(e,"Y",(function(){return st.a})),n.d(e,"Z",(function(){return lt.a})),n.d(e,"ab",(function(){return dt.a})),n.d(e,"bb",(function(){return ft})),n.d(e,"db",(function(){return pt.a})),n.d(e,"eb",(function(){return ht.a})),n.d(e,"gb",(function(){return bt.a})),n.d(e,"hb",(function(){return mt.a})),n.d(e,"ib",(function(){return vt.a})),n.d(e,"jb",(function(){return gt.a})),n.d(e,"kb",(function(){return yt.a})),n.d(e,"lb",(function(){return Ot})),n.d(e,"nb",(function(){return wt.a})),n.d(e,"ob",(function(){return kt.a})),n.d(e,"pb",(function(){return jt.a})),n.d(e,"rb",(function(){return Tt.a})),n.d(e,"tb",(function(){return St.a})),n.d(e,"ub",(function(){return Nt.a})),n.d(e,"wb",(function(){return Ct.a})),n.d(e,"Ab",(function(){return It})),n.d(e,"Bb",(function(){return Et})),n.d(e,"Cb",(function(){return At.a})),n.d(e,"Db",(function(){return Rt.a})),n.d(e,"Eb",(function(){return _t.a})),n.d(e,"Fb",(function(){return Ft.a})),n.d(e,"Hb",(function(){return Dt.a})),n.d(e,"Ib",(function(){return Mt.a})),n.d(e,"Jb",(function(){return Pt.a})),n.d(e,"Kb",(function(){return Lt.a})),n.d(e,"Lb",(function(){return Ut})),n.d(e,"Mb",(function(){return Wt.a})),n.d(e,"Nb",(function(){return Xt})),n.d(e,"Ob",(function(){return Yt.a})),n.d(e,"Pb",(function(){return Qt.a})),n.d(e,"Qb",(function(){return Zt.a})),n.d(e,"Rb",(function(){return $t})),n.d(e,"Tb",(function(){return w.a})),n.d(e,"Ub",(function(){return Ht.a})),n.d(e,"Vb",(function(){return te.a})),n.d(e,"Wb",(function(){return ee.a})),n.d(e,"Xb",(function(){return ne.a})),n.d(e,"Yb",(function(){return re.a})),n.d(e,"Zb",(function(){return ae.a})),n.d(e,"ac",(function(){return ce})),n.d(e,"bc",(function(){return ue.a})),n.d(e,"cc",(function(){return se.a})),n.d(e,"dc",(function(){return le.a})),n.d(e,"ec",(function(){return de.a})),n.d(e,"fc",(function(){return pe})),n.d(e,"hc",(function(){return k.a})),n.d(e,"ic",(function(){return he})),n.d(e,"jc",(function(){return be.a})),n.d(e,"kc",(function(){return Vt.a})),n.d(e,"mc",(function(){return me.a})),n.d(e,"nc",(function(){return ve.a})),n.d(e,"oc",(function(){return oe.a})),n.d(e,"pc",(function(){return ge.a})),n.d(e,"rc",(function(){return ye})),n.d(e,"sc",(function(){return xe.a})),n.d(e,"tc",(function(){return Oe})),n.d(e,"uc",(function(){return we})),n.d(e,"vc",(function(){return ke})),n.d(e,"wc",(function(){return je})),n.d(e,"xc",(function(){return Ce})),n.d(e,"yc",(function(){return Ie.a})),n.d(e,"zc",(function(){return Ee.a})),n.d(e,"Ac",(function(){return Ae.a})),n.d(e,"Bc",(function(){return Re.a})),n.d(e,"Cc",(function(){return _e})),n.d(e,"Dc",(function(){return De})),n.d(e,"Ec",(function(){return Me})),n.d(e,"Fc",(function(){return Pe.a})),n.d(e,"Gc",(function(){return Le.a})),n.d(e,"Hc",(function(){return Be.a})),n.d(e,"Ic",(function(){return Ve.a})),n.d(e,"Jc",(function(){return ze.a})),n.d(e,"Kc",(function(){return Ue.a})),n.d(e,"Lc",(function(){return $.a})),n.d(e,"Mc",(function(){return We.a})),n.d(e,"Nc",(function(){return Ge})),n.d(e,"Oc",(function(){return He})),n.d(e,"Pc",(function(){return qe})),n.d(e,"Qc",(function(){return Ke})),n.d(e,"Sc",(function(){return Xe.a})),n.d(e,"Tc",(function(){return Ye.a})),n.d(e,"Uc",(function(){return Qe.a})),n.d(e,"Wc",(function(){return Ze.a})),n.d(e,"Xc",(function(){return Je})),n.d(e,"Yc",(function(){return $e.a})),n.d(e,"Zc",(function(){return T.a})),n.d(e,"ad",(function(){return tn.a})),n.d(e,"cd",(function(){return en.a})),n.d(e,"dd",(function(){return nn.a})),n.d(e,"ed",(function(){return S.a})),n.d(e,"fd",(function(){return rn})),n.d(e,"gd",(function(){return an})),n.d(e,"hd",(function(){return on})),n.d(e,"id",(function(){return cn})),n.d(e,"jd",(function(){return un.a})),n.d(e,"kd",(function(){return zt.a})),n.d(e,"ld",(function(){return Ne.a})),n.d(e,"mb",(function(){return sn.a})),n.d(e,"vb",(function(){return ln.a})),n.d(e,"zb",(function(){return dn.a})),n.d(e,"Rc",(function(){return fn.a})),n.d(e,"pd",(function(){return pn.a})),n.d(e,"qd",(function(){return hn.a})),n.d(e,"rd",(function(){return fe.a})),n.d(e,"sd",(function(){return bn.a})),n.d(e,"td",(function(){return mn.a})),n.d(e,"ud",(function(){return vn.a})),n.d(e,"vd",(function(){return gn.a})),n.d(e,"wd",(function(){return yn.a})),n.d(e,"yd",(function(){return qt.a})),n.d(e,"zd",(function(){return Kt.a})),n.d(e,"Ad",(function(){return xn.a})),n.d(e,"Bd",(function(){return N.a})),n.d(e,"Cd",(function(){return On.a})),n.d(e,"Dd",(function(){return wn.a})),n.d(e,"Ed",(function(){return jn})),n.d(e,"Fd",(function(){return Tn.a})),n.d(e,"Gd",(function(){return Sn})),n.d(e,"Hd",(function(){return Nn})),n.d(e,"Id",(function(){return Cn})),n.d(e,"Jd",(function(){return xt.a})),n.d(e,"Kd",(function(){return In.a})),n.d(e,"Md",(function(){return En.a})),n.d(e,"Nd",(function(){return An.a})),n.d(e,"Od",(function(){return Rn})),n.d(e,"Pd",(function(){return _n.a})),n.d(e,"Qd",(function(){return Fn})),n.d(e,"Rd",(function(){return Dn.a})),n.d(e,"Sd",(function(){return Mn.a})),n.d(e,"Td",(function(){return Pn.a})),n.d(e,"Ud",(function(){return Ln.a})),n.d(e,"y",(function(){return Wn})),n.d(e,"Ld",(function(){return Gn.a})),n.d(e,"lc",(function(){return qn})),n.d(e,"gc",(function(){return Xn})),n.d(e,"Vc",(function(){return Yn.a})),n.d(e,"nd",(function(){return Qn.a})),n.d(e,"sb",(function(){return Zn.a})),n.d(e,"cb",(function(){return Jn})),n.d(e,"fb",(function(){return $n})),n.d(e,"S",(function(){return tr})),n.d(e,"yb",(function(){return nr})),n.d(e,"qc",(function(){return j.b})),n.d(e,"a",(function(){return j.a})),n.d(e,"xb",(function(){return da})),n.d(e,"Gb",(function(){return fa})),n.d(e,"Sb",(function(){return pa})),n.d(e,"od",(function(){return sa})),n.d(e,"qb",(function(){return r})),n.d(e,"bd",(function(){return la})),n.d(e,"md",(function(){return ha})),n.d(e,"xd",(function(){return ba}));var r={};n.r(r),n.d(r,"conv2d",(function(){return ir})),n.d(r,"depthwiseConv2d",(function(){return sr})),n.d(r,"matMul",(function(){return lr}));var a=n(115),o=n(236),i=n(237),c=n(83),u=n(238),s=n(239),l=n(240),d=n(241),f=n(242),p=n(243),h=n(244),b=n(245),m=n(246),v=n(247),g=n(188),y=n(248),x=n(67),O=n(99),w=n(108),k=n(79),j=n(66),T=n(139),S=n(95),N=n(189);var C=Object(j.b)({basicLSTMCell_:function(t,e,n,r,a,o){var i=Object(x.a)(t,"forgetBias","basicLSTMCell"),u=Object(x.a)(e,"lstmKernel","basicLSTMCell"),s=Object(x.a)(n,"lstmBias","basicLSTMCell"),l=Object(x.a)(r,"data","basicLSTMCell"),d=Object(x.a)(a,"c","basicLSTMCell"),f=Object(x.a)(o,"h","basicLSTMCell"),p=Object(O.a)([l,f],1),h=Object(w.a)(p,u),b=Object(c.a)(h,s),m=b.shape[0],v=b.shape[1]/4,g=[m,v],y=Object(S.a)(b,[0,0],g),j=Object(S.a)(b,[0,v],g),C=Object(S.a)(b,[0,2*v],g),I=Object(S.a)(b,[0,3*v],g),E=Object(c.a)(Object(k.a)(Object(T.a)(y),Object(N.a)(j)),Object(k.a)(d,Object(T.a)(Object(c.a)(i,C))));return[E,Object(k.a)(Object(N.a)(E),Object(T.a)(I))]}}),I=n(190),E=n(150),A=n(123);var R=Object(j.b)({batchNorm2d_:function(t,e,n,r,a,o){var i,c,u=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(i=Object(x.a)(a,"scale","batchNorm")),null!=r&&(c=Object(x.a)(r,"offset","batchNorm")),A.b(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),A.b(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,".")})),A.b(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=i&&A.b(2===i.rank||1===i.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(i.rank,".")})),null!=c&&A.b(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")})),Object(E.a)(u,s,l,c,i,o)}});var _=Object(j.b)({batchNorm3d_:function(t,e,n,r,a,o){var i,c,u=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(i=Object(x.a)(a,"scale","batchNorm")),null!=r&&(c=Object(x.a)(r,"offset","batchNorm")),A.b(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),A.b(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,".")})),A.b(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=i&&A.b(3===i.rank||1===i.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(i.rank,".")})),null!=c&&A.b(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")})),Object(E.a)(u,s,l,c,i,o)}});var F=Object(j.b)({batchNorm4d_:function(t,e,n,r,a,o){var i,c,u=Object(x.a)(t,"x","batchNorm"),s=Object(x.a)(e,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(i=Object(x.a)(a,"scale","batchNorm")),null!=r&&(c=Object(x.a)(r,"offset","batchNorm")),A.b(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),A.b(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,".")})),A.b(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=i&&A.b(4===i.rank||1===i.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(i.rank,".")})),null!=c&&A.b(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")})),Object(E.a)(u,s,l,c,i,o)}}),D=n(191),M=n(192),P=n(105),L=n(88),B=n(249),V=n(250),z=n(124),U=n(114);var W=Object(j.b)({concat1d_:function(t){return Object(O.a)(t,0)}});var G=Object(j.b)({concat2d_:function(t,e){return Object(O.a)(t,e)}});var H=Object(j.b)({concat3d_:function(t,e){return Object(O.a)(t,e)}});var q=Object(j.b)({concat4d_:function(t,e){return Object(O.a)(t,e)}}),K=n(251),X=n(140),Y=n(252),Q=n(254),Z=n(68),J=n(69),$=n(74);var tt=Object(j.b)({conv3DBackpropInput_:function(t,e,n,r,a){A.b(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var o=t,i=e,c=!1;4===e.rank&&(c=!0,i=Object($.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],s=i.shape[4];A.b(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,".")})),A.b(5===i.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)})),A.b(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),A.b(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),A.b(s===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(s,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:i,filter:n},d={pad:a,strides:r,inputShape:o},f=Z.a.runKernel(J.H,l,d);return c?Object($.a)(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var et=Object(j.b)({conv3dTranspose_:function(t,e,n,r,a){var o=Object(x.a)(t,"x","conv3dTranspose"),i=Object(x.a)(e,"filter","conv3dTranspose");return tt(n,o,i,r,a)}}),nt=n(255),rt=n(256),at=n(257),ot=n(258),it=n(259),ct=n(157);var ut=Object(j.b)({diag_:function(t){var e={x:Object(x.a)(t,"x","diag")};return Z.a.runKernel(J.R,e)}}),st=n(260),lt=n(91),dt=n(261);var ft=Object(j.b)({dot_:function(t,e){var n=Object(x.a)(t,"t1","dot"),r=Object(x.a)(e,"t2","dot");A.b((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];if(A.b(a===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(o,".")})),1===n.rank&&1===r.rank){var i=Object($.a)(n,[1,-1]),c=Object($.a)(r,[-1,1]),u=Object(w.a)(i,c);return Object($.a)(u,[])}if(1===n.rank&&2===r.rank){var s=Object($.a)(n,[1,-1]),l=Object($.a)(r,[r.shape[0],r.shape[1]]),d=Object(w.a)(s,l);return Object($.a)(d,[d.size])}if(2===n.rank&&1===r.rank){var f=Object($.a)(r,[-1,1]),p=Object(w.a)(n,f);return Object($.a)(p,[p.size])}var h=Object($.a)(r,[r.shape[0],r.shape[1]]);return Object(w.a)(n,h)}}),pt=n(262),ht=n(194),bt=n(193),mt=n(263),vt=n(127),gt=n(195),yt=n(264),xt=n(196);var Ot=Object(j.b)({eye_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==e&&(e=t);for(var a=Object(P.a)([t,e],r),o=t<=e?t:e,i=0;i<o;++i)a.set(1,i,i);var c=Object($.a)(a.toTensor(),[t,e]);if(null==n)return c;if(1===n.length)return Object(xt.a)(Object(gt.a)(c,0),[n[0],1,1]);if(2===n.length)return Object(xt.a)(Object(gt.a)(Object(gt.a)(c,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(xt.a)(Object(gt.a)(Object(gt.a)(Object(gt.a)(c,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),wt=n(137),kt=n(197),jt=n(186),Tt=n(198),St=n(158),Nt=n(199),Ct=n(159);var It=Object(j.b)({isFinite_:function(t){var e={x:Object(x.a)(t,"x","isFinite")};return Z.a.runKernel(J.tb,e)}});var Et=Object(j.b)({isInf_:function(t){var e={x:Object(x.a)(t,"x","isInf")};return Z.a.runKernel(J.ub,e)}}),At=n(265),Rt=n(200),_t=n(266),Ft=n(160),Dt=n(267),Mt=n(268),Pt=n(141),Lt=n(201),Bt=n(93),Vt=n(116),zt=n(202);var Ut=Object(j.b)({logSigmoid_:function(t){var e=Object(x.a)(t,"x","logSigmoid");return Object(Bt.a)((function(t){return{value:Object(Vt.a)(Object(zt.a)(Object(Vt.a)(t))),gradFunc:function(e){return Object(k.a)(e,Object(T.a)(Object(Vt.a)(t)))}}}))(e)}}),Wt=n(269),Gt=n(128),Ht=n(142),qt=n(85),Kt=n(100);var Xt=Object(j.b)({logSumExp_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object(x.a)(t,"x","logSumExp"),a=Object(A.I)(e,r.shape),o=Object(Ht.a)(r,a,!0),i=Object(qt.a)(r,o),u=Object(vt.a)(i),s=Object(Kt.a)(u,a),l=Object(Pt.a)(s),d=Object(c.a)(Object($.a)(o,l.shape),l);if(n){var f=Object(Gt.e)(d.shape,a);return Object($.a)(d,f)}return d}}),Yt=n(161),Qt=n(203),Zt=n(204),Jt=n(86);var $t=Object(j.b)({logicalXor_:function(t,e){var n=Object(x.a)(t,"a","logicalXor","bool"),r=Object(x.a)(e,"b","logicalXor","bool");return Object(Jt.a)(n.shape,r.shape),Object(Yt.a)(Object(Zt.a)(t,e),Object(Qt.a)(Object(Yt.a)(t,e)))}}),te=n(205),ee=n(270),ne=n(271),re=n(187),ae=n(162),oe=n(163),ie=n(92);function ce(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===t)return[];var o=Object(x.a)(t,"x","meshgrid",t instanceof ie.a?t.dtype:"float32");if(void 0===e)return[o];var i=Object(x.a)(e,"y","meshgrid",e instanceof ie.a?e.dtype:"float32"),c=Object(A.O)(o.shape),u=Object(A.O)(i.shape);return"xy"===a?(o=Object($.a)(o,[1,-1]),i=Object($.a)(i,[-1,1]),[Object(w.a)(Object(oe.a)([u,1],o.dtype),o),Object(w.a)(i,Object(oe.a)([1,c],i.dtype))]):(o=Object($.a)(o,[-1,1]),i=Object($.a)(i,[1,-1]),[Object(w.a)(o,Object(oe.a)([1,u],o.dtype)),Object(w.a)(Object(oe.a)([c,1],i.dtype),i)])}var ue=n(206),se=n(207),le=n(272),de=n(273),fe=n(107);var pe=Object(j.b)({moments_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=Object(x.a)(t,"x","moments");var r=Object(A.I)(e,t.shape),a=Object(ae.a)(t,r,n),o=a.shape;n||(o=Object(Gt.e)(a.shape,r));var i=Object(fe.a)(Object(qt.a)(Object(L.a)(t,"float32"),Object($.a)(a,o))),c=Object(ae.a)(i,r,n);return{mean:a,variance:c}}});var he=Object(j.b)({multiRNNCell_:function(t,e,n,r){for(var a=Object(x.a)(e,"data","multiRNNCell"),o=Object(x.b)(n,"c","multiRNNCell"),i=Object(x.b)(r,"h","multiRNNCell"),c=a,u=[],s=0;s<t.length;s++){var l=t[s](c,o[s],i[s]);u.push(l[0]),u.push(l[1]),c=l[1]}for(var d=[],f=[],p=0;p<u.length;p+=2)d.push(u[p]),f.push(u[p+1]);return[d,f]}}),be=n(274),me=n(208),ve=n(209),ge=n(275);var ye=Object(j.b)({outerProduct_:function(t,e){var n=Object(x.a)(t,"v1","outerProduct"),r=Object(x.a)(e,"v2","outerProduct");A.b(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=Object($.a)(n,[-1,1]),o=Object($.a)(r,[1,-1]);return Object(w.a)(a,o)}}),xe=n(129);var Oe=Object(j.b)({pad1d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Object(xe.a)(t,[e],n)}});var we=Object(j.b)({pad2d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(xe.a)(t,e,n)}});var ke=Object(j.b)({pad3d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(xe.a)(t,e,n)}});var je=Object(j.b)({pad4d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(xe.a)(t,e,n)}}),Te=n(72),Se=n(102),Ne=n(210);var Ce=Object(j.b)({pool_:function(t,e,n,r,a,o){null==a&&(a=[1,1]),null==o&&(o=1),0===r&&(r="valid");var i=Object(x.a)(t,"x","maxPool"),c=i,u=!1;3===i.rank&&(u=!0,c=Object($.a)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A.b(Se.h(o,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(a,"'")}));var s,l=Se.e(c.shape,e,o,a,r),d=[l.dilationHeight,l.dilationWidth];s="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),a=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],a[e]]}))}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var f=1===d[0]&&1===d[1],p=function(t,e,n){var r=n.map((function(t){return t[0]})),a=n.map((function(t){return t[1]})),o=t.concat(r,a),i=e.map((function(t,e){return(t-o[e]%t)%t})),c=a.map((function(t,e){return t+i[e]})),u=e.map((function(t,e){return[r[e],c[e]]})),s=e.map((function(t,e){return[0,i[e]]}));return[u,s]}([l.inHeight,l.inWidth],d,s),h=Object(Te.a)(p,2),b=h[0],m=h[1],v=f?r:"valid",y=f?c:Object(Ne.a)(c,d,b),O=("avg"===n?function(){return Object(g.a)(y,e,o,v)}:function(){return Object(te.a)(y,e,o,v)})(),w=f?O:Object(I.a)(O,d,m);return u?Object($.a)(w,[w.shape[1],w.shape[2],w.shape[3]]):w}}),Ie=n(138),Ee=n(211),Ae=n(185),Re=n(276);var _e=Object(j.b)({rand_:function(t,e,n){var r=Object(A.O)(t),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var o=0;o<r;o++)a[o]=e();return Z.a.makeTensor(a,t,n)}}),Fe=n(164);var De=Object(j.b)({randomGamma_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var o=new Fe.b(e,n,r,a),i=Object(P.a)(t,r),c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}});var Me=Object(j.b)({randomNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var o=new Fe.a(e,n,r,!1,a),i=Object(P.a)(t,r),c=0;c<i.values.length;c++)i.values[c]=o.nextValue();return i.toTensor()}}),Pe=n(213),Le=n(165),Be=n(166),Ve=n(277),ze=n(144),Ue=n(214),We=n(117);var Ge=Object(j.b)({reverse1d_:function(t){var e=Object(x.a)(t,"x","reverse");return A.b(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")})),Object(We.a)(e,0)}});var He=Object(j.b)({reverse2d_:function(t,e){var n=Object(x.a)(t,"x","reverse");return A.b(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),Object(We.a)(n,e)}});var qe=Object(j.b)({reverse3d_:function(t,e){var n=Object(x.a)(t,"x","reverse");return A.b(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),Object(We.a)(n,e)}});var Ke=Object(j.b)({reverse4d_:function(t,e){var n=Object(x.a)(t,"x","reverse");return A.b(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),Object(We.a)(n,e)}}),Xe=n(215),Ye=n(278),Qe=n(87),Ze=n(279);var Je=Object(j.b)({separableConv2d_:function(t,e,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",c=Object(x.a)(t,"x","separableConv2d"),u=Object(x.a)(e,"depthwiseFilter","separableConv2d"),s=Object(x.a)(n,"pointwiseFilter","separableConv2d"),l=c,d=!1;if(3===c.rank&&(d=!0,l=Object($.a)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A.b(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),A.b(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),A.b(4===s.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),A.b(1===s.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(s.shape[0],".")})),A.b(1===s.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(s.shape[1],".")}));var f=u.shape[2],p=u.shape[3];A.b(s.shape[2]===f*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(f*p,", ")+"but got ".concat(s.shape[2],".")}));var h=Object(ct.a)(l,u,r,a,i,o),b=1,m=Object(X.a)(h,s,b,"valid",i);return d?Object($.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),$e=n(280),tn=n(281),en=n(282),nn=n(283);var rn=Object(j.b)({slice1d_:function(t,e,n){var r=Object(x.a)(t,"x","slice1d");return A.b(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,[e],[n])}});var an=Object(j.b)({slice2d_:function(t,e,n){var r=Object(x.a)(t,"x","slice2d");return A.b(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,e,n)}});var on=Object(j.b)({slice3d_:function(t,e,n){var r=Object(x.a)(t,"x","slice3d");return A.b(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,e,n)}});var cn=Object(j.b)({slice4d_:function(t,e,n){var r=Object(x.a)(t,"x","slice4d");return A.b(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,e,n)}}),un=n(284),sn=n(167),ln=n(168),dn=n(216),fn=n(169),pn=n(145),hn=n(125),bn=n(217),mn=n(170),vn=n(146),gn=n(218),yn=n(285),xn=n(286),On=n(136),wn=n(118),kn=n(112);function jn(t,e,n){if(Object(A.d)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Object(x.c)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(kn.a)(t,e,r,n)}var Tn=n(219);function Sn(t,e,n){if(Object(A.d)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Object(x.c)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(kn.a)(t,e,r,n)}function Nn(t,e,n){if(Object(A.d)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Object(x.c)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(kn.a)(t,e,r,n)}function Cn(t,e,n){if(Object(A.d)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Object(x.c)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Object(kn.a)(t,e,r,n)}var In=n(287),En=n(288),An=n(289);var Rn=Object(j.b)({unsortedSegmentSum_:function(t,e,n){var r=Object(x.a)(t,"x","unsortedSegmentSum"),a=Object(x.a)(e,"segmentIds","unsortedSegmentSum","int32");Object(A.b)(Object(A.v)(n),(function(){return"numSegments must be of dtype int"}));var o={x:r,segmentIds:a},i={numSegments:n};return Z.a.runKernel(J.hd,o,i)}}),_n=n(171);function Fn(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Z.a.makeVariable(t,e,n,r)}var Dn=n(126),Mn=n(220),Pn=n(143),Ln=n(106),Bn=n(75),Vn=n.n(Bn),zn=n(76);function Un(){return(Un=Object(zn.a)(Vn.a.mark((function t(e,n,r){var a,o,i,c,u,s,l,d,f,p,h,b,m;return Vn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=Object(x.a)(e,"tensor","boolMask"),o=Object(x.a)(n,"mask","boolMask","bool"),i=null==r?0:r,c=o.rank,u=a.shape,A.b(c>0,(function(){return"mask cannot be scalar"})),A.e(u.slice(i,i+c),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),s=1,l=i;l<i+c;l++)s*=u[l];return d=u.slice(0,i).concat([s],u.slice(i+c)),f=Object($.a)(a,d),p=Object($.a)(o,[-1]),t.next=14,Object(Mn.a)(p);case 14:return h=t.sent,b=Object(mn.a)(h,[1]),m=Object(Tt.a)(f,b,i),e!==a&&a.dispose(),n!==o&&o.dispose(),b.dispose(),f.dispose(),p.dispose(),h.dispose(),t.abrupt("return",m);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Wn=function(t,e,n){return Un.apply(this,arguments)},Gn=n(172);function Hn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return Object(a.a)(t);if(1!==t.rank&&null===n)return Hn(Object($.a)(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return Object(Kt.a)(Object(a.a)(t),n);if(e===1/0)return Object(Ht.a)(Object(a.a)(t),n);if(e===-1/0)return Object(ue.a)(Object(a.a)(t),n);if("euclidean"===e||2===e)return Object(hn.a)(Object(Kt.a)(Object(Ie.a)(Object(a.a)(t),Object(Qe.a)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return Object(Ht.a)(Object(Kt.a)(Object(a.a)(t),n[0]),n[1]-1);if(e===1/0)return Object(Ht.a)(Object(Kt.a)(Object(a.a)(t),n[1]),n[0]);if(e===-1/0)return Object(ue.a)(Object(Kt.a)(Object(a.a)(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Object(hn.a)(Object(Kt.a)(Object(fe.a)(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}var qn=Object(j.b)({norm_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Hn(t=Object(x.a)(t,"x","norm"),e,n),o=a.shape;if(r){var i=Object(A.I)(n,t.shape);o=Gt.e(a.shape,i)}return Object($.a)(a,o)}}),Kn=n(78);var Xn=Object(j.b)({movingAverage_:function(t,e,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=Object(x.a)(t,"v","movingAverage"),i=Object(x.a)(e,"x","movingAverage"),u=Object(x.a)(n,"decay","movingAverage");Object(Kn.assertTypesMatch)(o,i),A.b(A.a(o.shape,i.shape),(function(){return"Shape mismatch in v and x"}));var s=Object(Qe.a)(1),l=Object(qt.a)(s,u),d=Object(k.a)(Object(qt.a)(i,o),l);if(a){A.b(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=Object(x.a)(r,"step","movingAverage");d=Object(lt.a)(d,Object(qt.a)(s,Object(Ie.a)(u,f)))}return Object(c.a)(o,d)}}),Yn=n(290),Qn=n(318),Zn=n(291);var Jn=Object(j.b)({dropout_:function(t,e,n,r){var a=Object(x.a)(t,"x","dropout");if(A.b("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),A.b(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(e,".")})),0===e)return t instanceof ie.a?a.clone():a;var o=function(t,e){if(null==e)return t.shape.slice();if(A.a(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(a,n),i=1-e,u=Object(lt.a)(Object(kt.a)(Object(c.a)(Object(Pe.a)(o,0,1,"float32",r),i)),i);return Object(k.a)(a,u)}});function $n(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function tr(t,e,n){for(var r=1-t%2,a=new Float32Array(t),o=0;o<t;++o){var i=2*Math.PI*o/(t+r-1);a[o]=e-n*Math.cos(i)}return Object(wn.a)(a,"float32")}function er(){return(er=Object(zn.a)(Vn.a.mark((function t(e,n){var r,a,o,i,c,u,s,l,d,f,p,h,b,m,v,g=arguments;return Vn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=g.length>2&&void 0!==g[2]?g[2]:1,a=Object(x.a)(e,"predictions","inTopK"),o=Object(x.a)(n,"targets","inTopK"),Object(A.b)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),Object(A.b)(a.rank-1===o.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(o.rank)})),Object(A.e)(a.shape.slice(0,a.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=a.shape[a.shape.length-1],Object(A.b)(r>0&&r<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(i,"), but got ").concat(r)})),t.next=10,a.data();case 10:return c=t.sent,t.next=13,o.data();case 13:u=t.sent,s=c.length/i,l=i,d=Object(A.o)("bool",s),f=0;case 17:if(!(f<s)){t.next=35;break}for(p=f*l,h=c.subarray(p,p+l),b=[],m=0;m<h.length;m++)b.push({value:h[m],index:m});b.sort((function(t,e){return e.value-t.value})),d[f]=0,v=0;case 25:if(!(v<r)){t.next=32;break}if(b[v].index!==u[f]){t.next=29;break}return d[f]=1,t.abrupt("break",32);case 29:v++,t.next=25;break;case 32:f++,t.next=17;break;case 35:return e!==a&&a.dispose(),n!==o&&o.dispose(),t.abrupt("return",Object(On.a)(d,o.shape,"bool"));case 38:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var nr=function(t,e){return er.apply(this,arguments)};var rr=Object(j.b)({conv2DBackpropFilter_:function(t,e,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,c=t;3===t.rank&&(c=Object($.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=Object($.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),A.b(4===c.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(c.shape,".")})),A.b(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),A.b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var s="NHWC"===o?c.shape[3]:c.shape[1],l="NHWC"===o?u.shape[3]:u.shape[1];A.b(s===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(s,") must ")+"match input depth in filter (".concat(n[2],".")})),A.b(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=i&&A.b(A.v(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var d={x:c,dy:u},f={strides:r,pad:a,dataFormat:o,dimRoundingMode:i,filterShape:n};return Z.a.runKernel(J.D,d,f)}}),ar=n(253),or=n(119);var ir=Object(j.b)({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,o=t.dataFormat,i=void 0===o?"NHWC":o,u=t.dilations,s=void 0===u?[1,1]:u,l=t.dimRoundingMode,d=t.bias,f=t.activation,p=void 0===f?"linear":f,h=t.preluActivationWeights,b=t.leakyreluAlpha;if(p=p||"linear",!1===Object(or.d)(Z.a.state.gradientDepth,p)){var m=Object(X.a)(e,n,r,a,i,s,l);return null!=d&&(m=Object(c.a)(m,d)),Object(or.a)(m,p,h,b)}var v=Object(x.a)(e,"x","conv2d"),g=Object(x.a)(n,"filter","conv2d"),y=v,O=!1;3===v.rank&&(O=!0,y=Object($.a)(v,[1,v.shape[0],v.shape[1],v.shape[2]])),A.b(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),A.b(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),null!=l&&A.b(A.v(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(a,".")})),A.b(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(g.shape[2],".")})),A.b(Se.h(r,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(s,"'")})),A.b("NHWC"===i,(function(){return"Error in conv2d: got dataFormat of ".concat(i," but only NHWC is currently supported.")}));var w,k,j=Se.a(y.shape,g.shape,r,s,a,l);if(null!=d){w=Object(x.a)(d,"bias","fused conv2d");var T=Object(Kn.makeTypesMatch)(w,v);w=Object(Te.a)(T,1)[0],Jt.a(j.outShape,w.shape)}null!=h&&(k=Object(x.a)(h,"prelu weights","fused conv2d"));var S=function(t,e){var n=Object(Te.a)(e,4),o=n[0],i=n[1],c=n[2],u=n[3],l=Object(or.c)(t,c,p);A.b(Se.i(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'")}));var d=[Object(ar.a)(i.shape,l,o,r,a),rr(i,l,o.shape,r,a)];if(null!=u){var f=Object(or.b)(u,l);d.push(f)}return d},N={x:y,filter:g,bias:w,preluActivationWeights:k},C={strides:r,pad:a,dataFormat:i,dilations:s,dimRoundingMode:l,activation:p,leakyreluAlpha:b};return null==d?Object(Bt.a)((function(t,e,n){var r=Z.a.runKernel(J.kb,N,C);return n([e,t,r]),O&&(r=Object($.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}))(y,g):Object(Bt.a)((function(t,e,n,r){var a=Z.a.runKernel(J.kb,N,C);return r([e,t,a,n]),O&&(a=Object($.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}))(y,g,w)}});var cr=Object(j.b)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,c=t;3===t.rank&&(c=Object($.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=Object($.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var s={x:c,dy:u},l={strides:r,pad:a,dimRoundingMode:i,dilations:o,filterShape:n};return Z.a.runKernel(J.P,s,l)}});var ur=Object(j.b)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,c=e,u=!1;3===e.rank&&(u=!0,c=Object($.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var s={dy:c,filter:n},l={strides:r,pad:a,dimRoundingMode:i,dilations:o,inputShape:t},d=Z.a.runKernel(J.Q,s,l);return u?Object($.a)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var sr=Object(j.b)({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,o=t.dataFormat,i=void 0===o?"NHWC":o,u=t.dilations,s=void 0===u?[1,1]:u,l=t.dimRoundingMode,d=t.bias,f=t.activation,p=void 0===f?"linear":f,h=t.preluActivationWeights,b=t.leakyreluAlpha;if(!1===Object(or.d)(Z.a.state.gradientDepth,p)){var m=Object(ct.a)(e,n,r,a,i,s,l);return null!=d&&(m=Object(c.a)(m,d)),Object(or.a)(m,p,h,b)}var v=Object(x.a)(e,"x","depthwiseConv2d"),g=Object(x.a)(n,"filter","depthwiseConv2d"),y=v,O=!1;3===v.rank&&(O=!0,y=Object($.a)(v,[1,v.shape[0],v.shape[1],v.shape[2]])),A.b(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),A.b(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),A.b(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==s&&(s=[1,1]),A.b(Se.h(r,s),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(s,"'")})),null!=l&&A.b(A.v(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(a,".")}));var w,k,j=Se.a(y.shape,g.shape,r,s,a,l,!0);if(null!=d){w=Object(x.a)(d,"bias","fused conv2d");var T=Object(Kn.makeTypesMatch)(w,v),S=Object(Te.a)(T,1);w=S[0],Jt.a(j.outShape,w.shape)}null!=h&&(k=Object(x.a)(h,"prelu weights","fused depthwiseConv2d"));var N=function(t,e){A.b(Se.i(s),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var n=Object(Te.a)(e,4),o=n[0],i=n[1],c=n[2],u=n[3],d=Object(or.c)(t,c,p),f=ur(i.shape,d,o,r,a,s,l),h=cr(i,d,o.shape,r,a,s,l);return null!=u?[f,h,Object(or.b)(w,d)]:[f,h]},C={x:y,filter:g,bias:w,preluActivationWeights:k},I={strides:r,pad:a,dataFormat:i,dilations:s,dimRoundingMode:l,activation:p,leakyreluAlpha:b};return null==d?Object(Bt.a)((function(t,e,n){var r=Z.a.runKernel(J.lb,C,I);return n([e,t,r]),O&&(r=Object($.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:N}}))(y,g):Object(Bt.a)((function(t,e,n,r){var a=Z.a.runKernel(J.lb,C,I);return r([e,t,a,n]),O&&(a=Object($.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:N}}))(y,g,w)}});var lr=Object(j.b)({fusedMatMul_:function(t){var e=t.a,n=t.b,r=t.transposeA,a=void 0!==r&&r,o=t.transposeB,i=void 0!==o&&o,u=t.bias,s=t.activation,l=void 0===s?"linear":s,d=t.preluActivationWeights,f=t.leakyreluAlpha;if(!1===Object(or.d)(Z.a.state.gradientDepth,l)){var p=Object(w.a)(e,n,a,i);return null!=u&&(p=Object(c.a)(p,u)),Object(or.a)(p,l,d,f)}var h=Object(x.a)(e,"a","fused matMul"),b=Object(x.a)(n,"b","fused matMul"),m=Object(Kn.makeTypesMatch)(h,b),v=Object(Te.a)(m,2);h=v[0],b=v[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],y=i?b.shape[b.rank-1]:b.shape[b.rank-2],O=a?h.shape[h.rank-1]:h.shape[h.rank-2],k=i?b.shape[b.rank-2]:b.shape[b.rank-1],j=h.shape.slice(0,-2),T=b.shape.slice(0,-2),S=A.O(j),N=A.O(T);A.b(h.rank>=2&&b.rank>=2&&h.rank===b.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(h.rank," and ").concat(b.rank,".")})),A.b(A.a(j,T),(function(){return"Error in fused matMul: outer dimensions (".concat(j,") and (")+"".concat(T,") of Tensors with shapes ").concat(h.shape," and ")+"".concat(b.shape," must match.")})),A.b(g===y,(function(){return"Error in fused matMul: inner shapes (".concat(g,") and (")+"".concat(y,") of Tensors with shapes ").concat(h.shape," and ")+"".concat(b.shape," and transposeA=").concat(a)+" and transposeB=".concat(i," must match.")}));var C,I,E=h.shape.slice(0,-2).concat([O,k]),R=a?Object($.a)(h,[S,g,O]):Object($.a)(h,[S,O,g]),_=i?Object($.a)(b,[N,k,y]):Object($.a)(b,[N,y,k]);if(null!=u){C=Object(x.a)(u,"bias","fused matMul");var F=Object(Kn.makeTypesMatch)(C,h);C=Object(Te.a)(F,1)[0],Jt.a(E,C.shape)}null!=d&&(I=Object(x.a)(d,"prelu weights","fused matMul"));var D=function(t,e){var n,r,o=Object(Te.a)(e,4),c=o[0],s=o[1],d=o[2],f=o[3],p=Object(or.c)(Object($.a)(t,d.shape),d,l);return a||i?!a&&i?(n=Object(w.a)(p,s,!1,!1),r=Object(w.a)(p,c,!0,!1)):a&&!i?(n=Object(w.a)(s,p,!1,!0),r=Object(w.a)(c,p,!1,!1)):(n=Object(w.a)(s,p,!0,!0),r=Object(w.a)(p,c,!0,!0)):(n=Object(w.a)(p,s,!1,!0),r=Object(w.a)(c,p,!0,!1)),null!=u?[n,r,Object(or.b)(f,p)]:[n,r]},M={a:R,b:_,bias:C,preluActivationWeights:I},P={transposeA:a,transposeB:i,activation:l,leakyreluAlpha:f};return null==u?Object(Bt.a)((function(t,e,n){var r=Z.a.runKernel(J.jd,M,P);return n([t,e,r]),{value:Object($.a)(r,E),gradFunc:D}}))(R,_):Object(Bt.a)((function(t,e,n,r){var a=Z.a.runKernel(J.jd,M,P);return r([t,e,a,n]),{value:Object($.a)(a,E),gradFunc:D}}))(R,_,C)}});var dr=Object(j.b)({hammingWindow_:function(t){return tr(t,.54,.46)}});var fr=Object(j.b)({hannWindow_:function(t){return tr(t,.5,.5)}});var pr=Object(j.b)({frame_:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0,i=[];o+e<=t.size;)i.push(Object(S.a)(t,o,e)),o+=n;if(r)for(;o<t.size;){var c=o+e-t.size,u=Object(O.a)([Object(S.a)(t,o,e-c),Object(wt.a)([c],a)]);i.push(u),o+=n}return 0===i.length?jn([],[0,e]):Object($.a)(Object(O.a)(i),[i.length,e])}});var hr=Object(j.b)({stft_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fr;null==r&&(r=$n(e));var o=pr(t,e,n),i=Object(k.a)(o,a(e));return Object(fn.a)(i,r)}});var br=Object(j.b)({cropAndResize_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=Object(x.a)(t,"image","cropAndResize"),c=Object(x.a)(e,"boxes","cropAndResize","float32"),u=Object(x.a)(n,"boxInd","cropAndResize","int32"),s=c.shape[0];A.b(4===i.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")})),A.b(2===c.rank&&4===c.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(s,",4] ")+"but had shape ".concat(c.shape,".")})),A.b(1===u.rank&&u.shape[0]===s,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(s,"] ")+"but had shape ".concat(c.shape,".")})),A.b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),A.b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),A.b("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:i,boxes:c,boxInd:u},d={method:a,extrapolationValue:o,cropSize:r},f=Z.a.runKernel(J.K,l,d);return f}});var mr=Object(j.b)({flipLeftRight_:function(t){var e=Object(x.a)(t,"image","flipLeftRight","float32");A.b(4===e.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")}));var n={image:e};return Z.a.runKernel(J.fb,n,{})}});var vr=Object(j.b)({rotateWithOffset_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Object(x.a)(t,"image","rotateWithOffset","float32");A.b(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var o={image:a},i={radians:e,fillValue:n,center:r},c=Z.a.runKernel(J.vc,o,i);return c}});function gr(t,e,n,r,a,o){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==o&&(o=0);var i=t.shape[0];return n=Math.min(n,i),A.b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),A.b(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")})),A.b(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])})),A.b(1===e.rank,(function(){return"scores must be a 1D tensor"})),A.b(e.shape[0]===i,(function(){return"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(e.shape[0])})),A.b(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(o,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:o}}var yr=Object(j.b)({nonMaxSuppression_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=Object(x.a)(t,"boxes","nonMaxSuppression"),i=Object(x.a)(e,"scores","nonMaxSuppression"),c=gr(o,i,n,r,a),u={maxOutputSize:n=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold};return Z.a.runKernel(J.Xb,{boxes:o,scores:i},u)}}),xr=n(122);function Or(){return(Or=Object(zn.a)(Vn.a.mark((function t(e,n,r){var a,o,i,c,u,s,l,d,f,p,h=arguments;return Vn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=h.length>3&&void 0!==h[3]?h[3]:.5,o=h.length>4&&void 0!==h[4]?h[4]:Number.NEGATIVE_INFINITY,i=Object(x.a)(e,"boxes","nonMaxSuppressionAsync"),c=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),u=gr(i,c,r,a,o),r=u.maxOutputSize,a=u.iouThreshold,o=u.scoreThreshold,t.next=10,Promise.all([i.data(),c.data()]);case 10:return s=t.sent,l=s[0],d=s[1],f=Object(xr.a)(l,d,r,a,o),p=f.selectedIndices,i!==e&&i.dispose(),c!==n&&c.dispose(),t.abrupt("return",Object(wn.a)(p,"int32"));case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var wr=function(t,e,n){return Or.apply(this,arguments)};var kr=Object(j.b)({nonMaxSuppressionWithScore_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=Object(x.a)(t,"boxes","nonMaxSuppression"),c=Object(x.a)(e,"scores","nonMaxSuppression"),u=gr(i,c,n,r,a,o),s={boxes:i,scores:c},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},d=Z.a.runKernel(J.Zb,s,l);return{selectedIndices:d[0],selectedScores:d[1]}}});function jr(){return(jr=Object(zn.a)(Vn.a.mark((function t(e,n,r){var a,o,i,c,u,s,l,d,f,p,h,b,m=arguments;return Vn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:.5,o=m.length>4&&void 0!==m[4]?m[4]:Number.NEGATIVE_INFINITY,i=m.length>5&&void 0!==m[5]?m[5]:0,c=Object(x.a)(e,"boxes","nonMaxSuppressionAsync"),u=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),s=gr(c,u,r,a,o,i),r=s.maxOutputSize,a=s.iouThreshold,o=s.scoreThreshold,i=s.softNmsSigma,t.next=12,Promise.all([c.data(),u.data()]);case 12:return l=t.sent,d=l[0],f=l[1],p=Object(xr.c)(d,f,r,a,o,i),h=p.selectedIndices,b=p.selectedScores,c!==e&&c.dispose(),u!==n&&u.dispose(),t.abrupt("return",{selectedIndices:Object(wn.a)(h,"int32"),selectedScores:Object(wn.a)(b)});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Tr=function(t,e,n){return jr.apply(this,arguments)};var Sr=Object(j.b)({nonMaxSuppressionPadded_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=Object(x.a)(t,"boxes","nonMaxSuppression"),c=Object(x.a)(e,"scores","nonMaxSuppression"),u=gr(i,c,n,r,a,null),s=u.maxOutputSize,l=u.iouThreshold,d=u.scoreThreshold,f={boxes:i,scores:c},p={maxOutputSize:s,iouThreshold:l,scoreThreshold:d,padToMaxOutputSize:o},h=Z.a.runKernel(J.Yb,f,p);return{selectedIndices:h[0],validOutputs:h[1]}}});function Nr(){return(Nr=Object(zn.a)(Vn.a.mark((function t(e,n,r){var a,o,i,c,u,s,l,d,f,p,h,b,m,v,g,y,O=arguments;return Vn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=O.length>3&&void 0!==O[3]?O[3]:.5,o=O.length>4&&void 0!==O[4]?O[4]:Number.NEGATIVE_INFINITY,i=O.length>5&&void 0!==O[5]&&O[5],c=Object(x.a)(e,"boxes","nonMaxSuppressionAsync"),u=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),s=gr(c,u,r,a,o,null),l=s.maxOutputSize,d=s.iouThreshold,f=s.scoreThreshold,t.next=11,Promise.all([c.data(),u.data()]);case 11:return p=t.sent,h=Object(Te.a)(p,2),b=h[0],m=h[1],v=Object(xr.b)(b,m,l,d,f,i),g=v.selectedIndices,y=v.validOutputs,c!==e&&c.dispose(),u!==n&&u.dispose(),t.abrupt("return",{selectedIndices:Object(wn.a)(g,"int32"),validOutputs:Object(Qe.a)(y,"int32")});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Cr=function(t,e,n){return Nr.apply(this,arguments)},Ir=n(152),Er=n(151),Ar=n(111),Rr=n(153);function _r(t){return Object(Ir.a)(t)||Object(Er.a)(t)||Object(Ar.a)(t)||Object(Rr.a)()}var Fr=Object(j.b)({resizeBilinear_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(x.a)(t,"images","resizeBilinear");A.b(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),A.b(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")})),A.b(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var o=a,i=!1;3===a.rank&&(i=!0,o=Object($.a)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),_r(e);var c={images:o},u={alignCorners:n,halfPixelCenters:r,size:e},s=Z.a.runKernel(J.qc,c,u);return i?Object($.a)(s,[s.shape[1],s.shape[2],s.shape[3]]):s}});var Dr=Object(j.b)({resizeNearestNeighbor_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(x.a)(t,"images","resizeNearestNeighbor");A.b(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),A.b(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")})),A.b("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),A.b(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var o=a,i=!1;3===a.rank&&(i=!0,o=Object($.a)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),_r(e);var c={images:o},u={alignCorners:n,halfPixelCenters:r,size:e},s=Z.a.runKernel(J.sc,c,u);return i?Object($.a)(s,[s.shape[1],s.shape[2],s.shape[3]]):s}});function Mr(t,e){for(var n,r,a,o,i,u,s=Object(wn.a)([-1]),l=Object(wn.a)([0]),d=Object(wn.a)([0]),f=0;f<t.size-1;f++){n=Object(S.a)(t,0,f+1),r=Object(S.a)(t,f+1),i=Object(lt.a)(Object(Kt.a)(n),e),u=Object(lt.a)(Object(Kt.a)(r),e);var p=Object(Kt.a)(Object(k.a)(n,Object(Le.a)(0,n.size)));a=Object(lt.a)(p,Object(Kt.a)(n));var h=Object(wt.a)(r.shape,n.size),b=Object(c.a)(Object(Le.a)(0,r.size),h),m=Object(k.a)(r,b);o=Object(lt.a)(Object(Kt.a)(m),Object(Kt.a)(r));var v=Object(qt.a)(a,o),g=Object(qt.a)(a,o),y=Object(k.a)(i,u);d=Object(k.a)(Object(k.a)(y,v),g);var x=Object(St.a)(d,l);l=Object(Dn.a)(x,d,l),s=Object(Dn.a)(x,Object(wn.a)([f]),s)}return s}var Pr=Object(j.b)({threshold_:function(t){var e,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=Object(x.a)(t,"image","threshold"),l=.2989,d=.587,f=.114,p=s.shape[0]*s.shape[1],h=Object(k.a)(Object(wn.a)([u]),255);if(A.b(3===s.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(s.rank,".")})),A.b(3===s.shape[2]||1===s.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(s.shape[2],".")})),A.b("int32"===s.dtype||"float32"===s.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(s.dtype,".")})),A.b("otsu"===o||"binary"===o,(function(){return"Method must be binary or otsu, but was ".concat(o)})),3===s.shape[2]){var b=Object(pn.a)(s,[1,1,1],-1),m=Object(Te.a)(b,3);e=m[0],n=m[1],r=m[2];var v=Object(k.a)(e,l),g=Object(k.a)(n,d),y=Object(k.a)(r,f);a=Object(c.a)(Object(c.a)(v,g),y)}else a=t;if("otsu"===o){var O=Object(D.a)(Object(L.a)(Object(Xe.a)(a),"int32"),Object(On.a)([]),256);h=Mr(O,p)}var w=i?Object(Ft.a)(a,h):Object(St.a)(a,h),j=Object(L.a)(Object(k.a)(w,255),"int32");return j}});var Lr=Object(j.b)({transform_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,i=Object(x.a)(t,"image","transform","float32"),c=Object(x.a)(e,"transforms","transform","float32");A.b(4===i.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,".")})),A.b(2===c.rank&&(c.shape[0]===i.shape[0]||1===c.shape[0])&&8===c.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),A.b(null==o||2===o.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(o,".")}));var u={image:i,transforms:c},s={interpolation:n,fillMode:r,fillValue:a,outputShape:o};return Z.a.runKernel(J.dd,u,s)}});var Br=Object(j.b)({bandPart_:function(t,e,n){Object(A.b)(e%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(e,".")})),Object(A.b)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Object(x.a)(t,"a","bandPart");Object(A.b)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,o=r.shape.slice(-2),i=Object(Te.a)(o,2),c=i[0],u=i[1];if(!(e<=c))throw new Error("bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(c,")."));if(!(n<=u))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(u,")."));e<0&&(e=c),n<0&&(n=u);var s=Object($.a)(Object(Le.a)(0,c,1,"int32"),[-1,1]),l=Object(Le.a)(0,u,1,"int32"),d=Object(qt.a)(s,l),f=Object(Yt.a)(Object(Ft.a)(d,Object(Qe.a)(+e,"int32")),Object(Nt.a)(d,Object(Qe.a)(-n,"int32"))),p=Object(Pn.a)([c,u],r.dtype);return Object($.a)(Object(vn.a)(Object(_n.a)(Object($.a)(r,[-1,c,u])).map((function(t){return Object(Dn.a)(f,t,p)}))),a)}});var Vr=Object(j.b)({gramSchmidt_:function(t){var e;Array.isArray(t)?function(){e=!1,Object(A.b)(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){Object(A.b)(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")}))},a=1;a<t.length;++a)r(a)}():(e=!0,t=Object(pn.a)(t,t.shape[0],0).map((function(t){return Object(mn.a)(t,[0])}))),Object(A.b)(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")}));for(var n=[],r=t,a=function(t){n.push(Z.a.tidy((function(){var e=r[t];if(t>0)for(var a=0;a<t;++a){var o=Object(k.a)(Object(Kt.a)(Object(k.a)(n[a],e)),n[a]);e=Object(qt.a)(e,o)}return Object(lt.a)(e,qn(e,"euclidean"))})))},o=0;o<t.length;++o)a(o);return e?Object(vn.a)(n,0):n}}),zr=n(98);function Ur(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Z.a.tidy((function(){Object(A.b)(2===t.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")}));for(var n=t.shape[0],r=t.shape[1],a=Ot(n),o=Object(z.a)(t),i=jn([[1]],[1,1]),c=Object(z.a)(i),u=n>=r?r:n,s=function(t){var e=o,u=c,s=a,l=Z.a.tidy((function(){var e=Object(S.a)(o,[t,t],[n-t,1]),u=qn(e),s=Object(S.a)(o,[t,t],[1,1]),l=Object(Dn.a)(Object(St.a)(s,0),jn([[-1]]),jn([[1]])),d=Object(qt.a)(s,Object(k.a)(l,u)),f=Object(lt.a)(e,d);c=1===f.shape[0]?Object(z.a)(i):Object(O.a)([i,Object(S.a)(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);var p=Object(Vt.a)(Object(lt.a)(Object(w.a)(l,d),u)),h=Object(S.a)(o,[t,0],[n-t,r]),b=Object(k.a)(p,c),m=Object(Gn.a)(c);if(0===t)o=Object(qt.a)(h,Object(w.a)(b,Object(w.a)(m,h)));else{var v=Object(qt.a)(h,Object(w.a)(b,Object(w.a)(m,h)));o=Object(O.a)([Object(S.a)(o,[0,0],[t,r]),v],0)}var g=Object(Gn.a)(b),y=Object(S.a)(a,[0,t],[n,a.shape[1]-t]);if(0===t)a=Object(qt.a)(y,Object(w.a)(Object(w.a)(y,c),g));else{var x=Object(qt.a)(y,Object(w.a)(Object(w.a)(y,c),g));a=Object(O.a)([Object(S.a)(a,[0,0],[n,t]),x],1)}return[c,o,a]})),d=Object(Te.a)(l,3);c=d[0],o=d[1],a=d[2],Object(zr.d)([e,u,s])},l=0;l<u;++l)s(l);return!e&&n>r&&(a=Object(S.a)(a,[0,0],[n,r]),o=Object(S.a)(o,[0,0],[r,r])),[a,o]}))}var Wr=Object(j.b)({qr_:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(A.b)(t.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank)})),2===t.rank)return Ur(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Object(_n.a)(Object($.a)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],o=[];r.forEach((function(t){var n=Ur(t,e),r=Object(Te.a)(n,2),i=r[0],c=r[1];a.push(i),o.push(c)}));var i=Object($.a)(Object(vn.a)(a,0),t.shape),c=Object($.a)(Object(vn.a)(o,0),t.shape);return[i,c]}}),Gr=n(101);var Hr=Object(j.b)({computeWeightedLoss_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gr.a.SUM_BY_NONZERO_WEIGHTS,r=Object(x.a)(t,"losses","computeWeightedLoss"),a=null;null!=e&&(a=Object(x.a)(e,"weights","computeWeightedLoss"));var o=null==a?r:Object(k.a)(r,a);if(n===Gr.a.NONE)return o;if(n===Gr.a.SUM)return Object(Kt.a)(o);if(n===Gr.a.MEAN){if(null==a)return Object(ae.a)(o);var i=r.size/a.size,c=Object(lt.a)(Object(Kt.a)(o),Object(Kt.a)(a));return i>1?Object(lt.a)(c,Object(Qe.a)(i)):c}if(n===Gr.a.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(lt.a)(Object(Kt.a)(o),Object(Qe.a)(r.size));var u=Object(k.a)(a,Object(oe.a)(r.shape)),s=Object(L.a)(Object(Kt.a)(Object(me.a)(u,Object(Qe.a)(0))),"float32");return Object(lt.a)(Object(Kt.a)(o),s)}throw Error("Unknown reduction: ".concat(n))}});var qr=Object(j.b)({absoluteDifference_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(t,"labels","absoluteDifference"),i=Object(x.a)(e,"predictions","absoluteDifference"),c=null;null!=n&&(c=Object(x.a)(n,"weights","absoluteDifference")),Object(A.e)(o.shape,i.shape,"Error in absoluteDifference: ");var u=Object(a.a)(Object(qt.a)(o,i));return Hr(u,c,r)}});var Kr=Object(j.b)({cosineDistance_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(t,"labels","cosineDistance"),i=Object(x.a)(e,"predictions","cosineDistance"),c=null;null!=r&&(c=Object(x.a)(r,"weights","cosineDistance")),Object(A.e)(o.shape,i.shape,"Error in cosineDistance: ");var u=Object(Qe.a)(1),s=Object(qt.a)(u,Object(Kt.a)(Object(k.a)(o,i),n,!0));return Hr(s,c,a)}});var Xr=Object(j.b)({hingeLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(x.a)(t,"labels","hingeLoss"),o=Object(x.a)(e,"predictions","hingeLoss"),i=null;null!=n&&(i=Object(x.a)(n,"weights","hingeLoss")),Object(A.e)(a.shape,o.shape,"Error in hingeLoss: ");var c=Object(Qe.a)(1);a=Object(qt.a)(Object(k.a)(Object(Qe.a)(2),a),c);var u=Object(ze.a)(Object(qt.a)(c,Object(k.a)(a,o)));return Hr(u,i,r)}});var Yr=Object(j.b)({huberLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(t,"labels","huberLoss"),u=Object(x.a)(e,"predictions","huberLoss"),s=null;null!=n&&(s=Object(x.a)(n,"weights","huberLoss")),Object(A.e)(i.shape,u.shape,"Error in huberLoss: ");var l=Object(Qe.a)(r),d=Object(a.a)(Object(qt.a)(u,i)),f=Object(se.a)(d,l),p=Object(qt.a)(d,f),h=Object(c.a)(Object(k.a)(Object(Qe.a)(.5),Object(fe.a)(f)),Object(k.a)(l,p));return Hr(h,s,o)}});var Qr=Object(j.b)({logLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(t,"labels","logLoss"),i=Object(x.a)(e,"predictions","logLoss"),u=null;null!=n&&(u=Object(x.a)(n,"weights","logLoss")),Object(A.e)(o.shape,i.shape,"Error in logLoss: ");var s=Object(Qe.a)(1),l=Object(Qe.a)(r),d=Object(Vt.a)(Object(k.a)(o,Object(Pt.a)(Object(c.a)(i,l)))),f=Object(k.a)(Object(qt.a)(s,o),Object(Pt.a)(Object(c.a)(Object(qt.a)(s,i),l))),p=Object(qt.a)(d,f);return Hr(p,u,a)}});var Zr=Object(j.b)({meanSquaredError_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(x.a)(t,"labels","meanSquaredError"),o=Object(x.a)(e,"predictions","meanSquaredError"),i=null;null!=n&&(i=Object(x.a)(n,"weights","meanSquaredError")),Object(A.e)(a.shape,o.shape,"Error in meanSquaredError: ");var c=Object(bn.a)(a,o);return Hr(c,i,r)}});function Jr(t,e){var n=Object(x.a)(t,"labels","sigmoidCrossEntropyWithLogits"),r=Object(x.a)(e,"logits","sigmoidCrossEntropyWithLogits");Object(A.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=Object(ze.a)(r),i=Object(k.a)(r,n),u=Object(Lt.a)(Object(vt.a)(Object(Vt.a)(Object(a.a)(r))));return Object(c.a)(Object(qt.a)(o,i),u)}var $r=Object(j.b)({sigmoidCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(t,"multiClassLabels","sigmoidCrossEntropy"),i=Object(x.a)(e,"logits","sigmoidCrossEntropy"),u=null;if(null!=n&&(u=Object(x.a)(n,"weights","sigmoidCrossEntropy")),Object(A.e)(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){var s=Object(Qe.a)(r),l=Object(Qe.a)(1),d=Object(Qe.a)(.5);o=Object(c.a)(Object(k.a)(o,Object(qt.a)(l,s)),Object(k.a)(d,s))}var f=Jr(o,i);return Hr(f,u,a)}});function ta(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));var r=Object(Bt.a)((function(t,e,r){var a=Xt(e,[n],!0),o=Object(qt.a)(Object(L.a)(e,"float32"),a);r([t,o]);var i=Object(Vt.a)(Object(k.a)(o,t));return{value:Object(Kt.a)(i,[n]),gradFunc:function(t,e){var r=Object(Te.a)(e,2),a=r[0],o=r[1],i=Object(Gt.e)(t.shape,[n]);return[Object(k.a)(Object($.a)(t,i),Object(qt.a)(Object(L.a)(a,"float32"),Object(vt.a)(o))),Object(k.a)(Object($.a)(t,i),Object(qt.a)(Object(vt.a)(o),Object(L.a)(a,"float32")))]}}}));return r(t,e)}var ea=Object(j.b)({softmaxCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(t,"onehotLabels","softmaxCrossEntropy"),i=Object(x.a)(e,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=Object(x.a)(n,"weights","softmaxCrossEntropy")),Object(A.e)(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){var s=Object(Qe.a)(r),l=Object(Qe.a)(1),d=Object(Qe.a)(o.shape[1]);o=Object(c.a)(Object(k.a)(o,Object(qt.a)(l,s)),Object(lt.a)(s,d))}var f=ta(o,i);return Hr(f,u,a)}});var na=Object(j.b)({sparseFillEmptyRows_:function(t,e,n,r){var a=Object(x.a)(t,"indices","sparseFillEmptyRows"),o=Object(x.a)(e,"values","sparseFillEmptyRows"),i=Object(x.a)(n,"denseShape","sparseFillEmptyRows"),c=Object(x.a)(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==o.rank)throw new Error("Values should be Tensor1D but received shape ".concat(o.shape));if(1!==i.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(0!==c.rank)throw new Error("Default value should be a scalar but received shape ".concat(c.shape));var u={indices:a,values:o,denseShape:i,defaultValue:c},s=Z.a.runKernel(J.Jc,u);return{outputIndices:s[0],outputValues:s[1],emptyRowIndicator:s[2],reverseIndexMap:s[3]}}});var ra=Object(j.b)({sparseReshape_:function(t,e,n){var r=Object(x.a)(t,"inputIndices","sparseReshape"),a=Object(x.a)(e,"inputShape","sparseReshape"),o=Object(x.a)(n,"newShape","sparseReshape");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(o.shape));var i={inputIndices:r,inputShape:a,newShape:o},c=Z.a.runKernel(J.Kc,i);return{outputIndices:c[0],outputShape:c[1]}}});var aa=Object(j.b)({sparseSegmentMean_:function(t,e,n){var r=Object(x.a)(t,"data","sparseSegmentMean"),a=Object(x.a)(e,"indices","sparseSegmentMean"),o=Object(x.a)(n,"segmentIds","sparseSegmentMean");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(o.shape));var i={data:r,indices:a,segmentIds:o};return Z.a.runKernel(J.Lc,i)}});var oa=Object(j.b)({sparseSegmentSum_:function(t,e,n){var r=Object(x.a)(t,"data","sparseSegmentSum"),a=Object(x.a)(e,"indices","sparseSegmentSum"),o=Object(x.a)(n,"segmentIds","sparseSegmentSum");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(o.shape));var i={data:r,indices:a,segmentIds:o};return Z.a.runKernel(J.Mc,i)}});var ia=Object(j.b)({stringNGrams_:function(t,e,n,r,a,o,i,c){var u=Object(x.a)(t,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var s=Object(x.a)(e,"dataSplits","stringNGrams");if("int32"!==s.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:o,padWidth:i,preserveShortSequences:c},d={data:u,dataSplits:s},f=Z.a.runKernel(J.Uc,d,l);return{nGrams:f[0],nGramsSplits:f[1]}}});var ca=Object(j.b)({stringSplit_:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(x.a)(t,"input","stringSplit","string"),a=Object(x.a)(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var o={skipEmpty:n},i={input:r,delimiter:a},c=Z.a.runKernel(J.Vc,i,o);return{indices:c[0],values:c[1],shape:c[2]}}});var ua=Object(j.b)({stringToHashBucketFast_:function(t,e){var n=Object(x.a)(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return Z.a.runKernel(J.Wc,a,r)}}),sa={fft:sn.a,ifft:ln.a,rfft:fn.a,irfft:dn.a},la={hammingWindow:dr,hannWindow:fr,frame:pr,stft:hr},da={flipLeftRight:mr,resizeNearestNeighbor:Dr,resizeBilinear:Fr,rotateWithOffset:vr,cropAndResize:br,nonMaxSuppression:yr,nonMaxSuppressionAsync:wr,nonMaxSuppressionWithScore:kr,nonMaxSuppressionWithScoreAsync:Tr,nonMaxSuppressionPadded:Sr,nonMaxSuppressionPaddedAsync:Cr,threshold:Pr,transform:Lr},fa={bandPart:Br,gramSchmidt:Vr,qr:Wr},pa={absoluteDifference:qr,computeWeightedLoss:Hr,cosineDistance:Kr,hingeLoss:Xr,huberLoss:Yr,logLoss:Qr,meanSquaredError:Zr,sigmoidCrossEntropy:$r,softmaxCrossEntropy:ea},ha={sparseFillEmptyRows:na,sparseReshape:ra,sparseSegmentMean:aa,sparseSegmentSum:oa},ba={stringNGrams:ia,stringSplit:ca,stringToHashBucketFast:ua}},function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";(function(t){n(68);var e=n(184),r=n(84),a=Object(r.c)();a.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),a.registerFlag("IS_BROWSER",(function(){return e.isBrowser()})),a.registerFlag("IS_NODE",(function(){return"undefined"!==typeof t&&"undefined"!==typeof t.versions&&"undefined"!==typeof t.versions.node})),a.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),a.registerFlag("PROD",(function(){return!1})),a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return a.getBool("DEBUG")})),a.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),a.registerFlag("IS_TEST",(function(){return!1})),a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),a.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1}))}).call(this,n(154))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(67),a=n(112);function o(t,e,n){var o=Object(r.c)(t,n);return Object(a.a)(t,e,o,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(68),a=n(69);function o(t,e,n){var o={shape:t,value:e,dtype:n};return r.a.runKernel(a.eb,{},o)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({pow_:function(t,e){var n=Object(c.a)(t,"base","pow"),u=Object(c.a)(e,"exp","pow"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.gc,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({sigmoid_:function(t){var e={x:Object(o.a)(t,"x","sigmoid")};return r.a.runKernel(a.Bc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(102),u=n(66),s=n(74);var l=Object(u.b)({conv2d_:function(t,e,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6?arguments[6]:void 0,p=Object(o.a)(t,"x","conv2d"),h=Object(o.a)(e,"filter","conv2d"),b=p,m=!1;3===p.rank&&(m=!0,b=Object(s.a)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),i.b(4===b.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(b.rank,".")})),i.b(4===h.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(h.rank,".")})),null!=f&&i.b(i.v(u),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(u,".")}));var v="NHWC"===l?b.shape[3]:b.shape[1];i.b(v===h.shape[2],(function(){return"Error in conv2d: depth of input (".concat(v,") must match ")+"input depth for filter ".concat(h.shape[2],".")})),i.b(c.h(n,d),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(d,"'")}));var g={x:b,filter:h},y={strides:n,pad:u,dataFormat:l,dilations:d,dimRoundingMode:f},x=r.a.runKernel(a.C,g,y);return m?Object(s.a)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({log_:function(t){var e={x:Object(o.a)(t,"x","log")};return r.a.runKernel(a.Cb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({max_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(o.a)(t,"x","max"),c={x:i},u={reductionIndices:e,keepDims:n};return r.a.runKernel(a.Ib,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(68),a=n(123),o=n(114);function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=i(t,"float32"),c=i(t,"float32");return Object(o.a)(n,c)}var u=Object(a.F)(Object(a.O)(t),e);return r.a.makeTensor(u,t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({relu_:function(t){var e={x:Object(o.a)(t,"x","relu")};return r.a.runKernel(a.nc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({split_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(o.a)(t,"x","split"),c={x:i},u={numOrSizeSplits:e,axis:n};return r.a.runKernel(a.Oc,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({stack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.b)(t,"tensors","stack","string_or_numeric");i.b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&i.b(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var c=n,u={axis:e};return r.a.runKernel(a.dc,c,u)}})},function(t,e,n){"use strict";n.r(e),n.d(e,"validateUpdateShape",(function(){return o})),n.d(e,"validateInput",(function(){return i})),n.d(e,"calculateShapes",(function(){return c}));var r=n(77),a=n(123);function o(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(o+" update.rank < ".concat(a,". "));if(t.length<r+(n.rank-a))throw new Error(o+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(o+" update.rank != ".concat(a+t.length-r));for(var i=0;i<a;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(e.shape[i],")."));for(var c=0;c<n.rank-a;++c)if(n.shape[c+a]!==t[c+r])throw new Error(o+" updates.shape[".concat(c+a,"] (").concat(n.shape[c+a],") != shape[").concat(c+a,"] (").concat(t[c+a],")"))}function i(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}o(n,e,t)}function c(t,e,n){for(var o=e.shape.length,i=o>1?e.shape[o-1]:1,c=n.length,u=1,s=i;s<c;++s)u*=n[s];var l=i<1?1:i;return{sliceRank:i,numUpdates:Object(a.O)(e.shape)/l,sliceSize:u,strides:[].concat(Object(r.a)(Object(a.j)(n.slice(0,i))),[1]),outputSize:Object(a.O)(n)}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));var r={};function a(t,e){var n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};r[t]=n}function o(t){return r[t]}function i(t){delete r[t]}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(74);var u=n(66);var s=Object(u.b)({batchNorm_:function(t,e,n,u,s,l){null==l&&(l=.001);var d,f,p=Object(o.a)(t,"x","batchNorm"),h=Object(o.a)(e,"mean","batchNorm"),b=Object(o.a)(n,"variance","batchNorm");null!=s&&(d=Object(o.a)(s,"scale","batchNorm")),null!=u&&(f=Object(o.a)(u,"offset","batchNorm")),i.b(h.rank===b.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),i.b(null==f||h.rank===f.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),i.b(null==d||h.rank===d.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var m={x:function(t){return 0===t.rank||1===t.rank?Object(c.a)(t,[1,1,1,t.size]):2===t.rank?Object(c.a)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Object(c.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t}(p),scale:d,offset:f,mean:h,variance:b},v={varianceEpsilon:l},g=r.a.runKernel(a.jb,m,v);return Object(c.a)(g,p.shape)}})},function(t,e,n){"use strict";function r(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(e,"a",(function(){return r}))},function(t,e){var n,r,a=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"===typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var u,s=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?s=u.concat(s):d=-1,s.length&&p())}function p(){if(!l){var t=c(f);l=!0;for(var e=s.length;e;){for(u=s,s=[];++d<e;)u&&u[d].run();d=-1,e=s.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function b(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new h(t,e)),1!==s.length||l||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=b,a.addListener=b,a.once=b,a.off=b,a.removeListener=b,a.removeAllListeners=b,a.emit=b,a.prependListener=b,a.prependOnceListener=b,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return f})),n.d(e,"h",(function(){return p})),n.d(e,"g",(function(){return h})),n.d(e,"a",(function(){return b}));var r=n(72),a=n(84),o=n(183),i=Object(o.a)("kernelRegistry",(function(){return new Map})),c=Object(o.a)("gradRegistry",(function(){return new Map}));function u(t,e){var n=m(t,e);return i.get(n)}function s(t){return c.get(t)}function l(t){for(var e=i.entries(),n=[];;){var a=e.next(),o=a.done,c=a.value;if(o)break;var u=Object(r.a)(c,2),s=u[0],l=u[1],d=s.split("_");Object(r.a)(d,1)[0]===t&&n.push(l)}return n}function d(t){var e=t.kernelName,n=t.backendName,r=m(e,n);i.has(r)&&console.warn("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),i.set(r,t)}function f(t){var e=t.kernelName;c.has(e)&&Object(a.c)().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(e,"'")),c.set(e,t)}function p(t,e){var n=m(t,e);if(!i.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));i.delete(n)}function h(t){if(!c.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));c.delete(t)}function b(t,e){l(t).forEach((function(t){d(Object.assign({},t,{backendName:e}))}))}function m(t,e){return"".concat(e,"_").concat(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(70),a=n(73),o=function(){function t(e,n){Object(r.a)(this,t),this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return Object(a.a)(t,[{key:"get",value:function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}},{key:"set",value:function(t,e){this.dataIdsCount++,this.data.set(t,e)}},{key:"has",value:function(t){return this.data.has(t)}},{key:"delete",value:function(t){return this.dataIdsCount--,this.data.delete(t)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),t}(),i=function(){function t(){Object(r.a)(this,t)}return Object(a.a)(t,[{key:"refCount",value:function(t){return c("refCount")}},{key:"incRef",value:function(t){return c("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(t){return c("time")}},{key:"read",value:function(t){return c("read")}},{key:"readSync",value:function(t){return c("readSync")}},{key:"numDataIds",value:function(){return c("numDataIds")}},{key:"disposeData",value:function(t,e){return c("disposeData")}},{key:"write",value:function(t,e,n){return c("write")}},{key:"move",value:function(t,e,n,r,a){return c("move")}},{key:"memory",value:function(){return c("memory")}},{key:"floatPrecision",value:function(){return c("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return c("dispose")}}]),t}();function c(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66),u=n(74);var s=Object(c.b)({depthwiseConv2d_:function(t,e,n,c){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,f=Object(o.a)(t,"x","depthwiseConv2d"),p=Object(o.a)(e,"filter","depthwiseConv2d"),h=f,b=!1;3===f.rank&&(b=!0,h=Object(u.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),i.b(4===h.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(h.rank,".")})),i.b(4===p.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),i.b(h.shape[3]===p.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(h.shape[3],") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")})),null!=d&&i.b(i.v(c),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(c,".")}));var m={x:h,filter:p},v={strides:n,pad:c,dataFormat:s,dilations:l,dimRoundingMode:d},g=r.a.runKernel(a.O,m,v);return b?Object(u.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({greater_:function(t,e){var n=Object(c.a)(t,"a","greater","string_or_numeric"),s=Object(c.a)(e,"b","greater","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.ob,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({imag_:function(t){var e={input:Object(o.a)(t,"input","imag")};return r.a.runKernel(a.sb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({lessEqual_:function(t,e){var n=Object(c.a)(t,"a","lessEqual","string_or_numeric"),s=Object(c.a)(e,"b","lessEqual","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.Ab,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(86),c=n(66);var u=Object(c.b)({logicalAnd_:function(t,e){var n=Object(o.a)(t,"a","logicalAnd","bool"),c=Object(o.a)(e,"b","logicalAnd","bool");Object(i.a)(n.shape,c.shape);var u={a:n,b:c};return r.a.runKernel(a.Fb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({mean_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(o.a)(t,"x","mean"),c={x:i},u={axis:e,keepDims:n};return r.a.runKernel(a.Pb,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(123),o=n(114),i=n(143);function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=c(t,"float32"),u=Object(i.a)(t,"float32");return Object(o.a)(n,u)}var s=Object(a.D)(Object(a.O)(t),e);return r.a.makeTensor(s,t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var r=n(70),a=n(73),o=n(326),i=(n(212),function(){function t(e,n,a,i,c){Object(r.a)(this,t),this.mean=e,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=c||Math.random();this.random=o.alea(u.toString())}return Object(a.a)(t,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var a=void 0,o=void 0,i=void 0;do{i=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o}while(i>=1||0===i);var c=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*c,n=this.mean+this.stdDev*o*c,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)}},{key:"convertValue",value:function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}},{key:"isValidTruncated",value:function(t){return t<=this.upper&&t>=this.lower}}]),t}()),c=function(){function t(e,n,a,c){Object(r.a)(this,t),this.alpha=e,this.beta=1/n,this.dtype=a;var u=c||Math.random();this.randu=o.alea(u.toString()),this.randn=new i(0,1,a,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return Object(a.a)(t,[{key:"nextValue",value:function(){for(var t,e,n,r,a,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<e||Math.log(a)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}},{key:"convertValue",value:function(t){return"float32"===this.dtype?t:Math.round(t)}}]),t}(),u=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;if(Object(r.a)(this,t),this.canReturnFloat=function(){return null==e.dtype||"float32"===e.dtype},this.min=n,this.range=a-n,this.dtype=i,null==c&&(c=Math.random()),"number"===typeof c&&(c=c.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(a," <= 1 and dtype is not float"));this.random=o.alea(c)}return Object(a.a)(t,[{key:"convertValue",value:function(t){return this.canReturnFloat()?t:Math.round(t)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(68),a=n(69);function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var i={start:t,stop:e,step:n,dtype:o};return r.a.runKernel(a.jc,{},i)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({real_:function(t){var e={input:Object(o.a)(t,"input","real")};return r.a.runKernel(a.kc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(123),i=n(66);var c=Object(i.b)({fft_:function(t){Object(o.b)("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return r.a.runKernel(a.db,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(123),i=n(66);var c=Object(i.b)({ifft_:function(t){Object(o.b)("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return r.a.runKernel(a.qb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(123),a=n(114),o=n(99),i=n(159),c=n(66),u=n(166),s=n(74),l=n(95),d=n(145),f=n(143),p=n(106),h=n(167);var b=Object(c.b)({rfft_:function(t,e){Object(r.b)("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(t.dtype)}));var n,c=t.shape[t.shape.length-1],b=t.size/c;if(null!=e&&e<c){var m=t.shape.map((function(t){return 0})),v=t.shape.map((function(t){return t}));v[t.shape.length-1]=e,n=Object(l.a)(t,m,v),c=e}else if(null!=e&&e>c){var g=t.shape.map((function(t){return t}));g[t.shape.length-1]=e-c,n=Object(o.a)([t,Object(f.a)(g)],t.shape.length-1),c=e}else n=t;var y=Object(p.a)(n),x=Object(s.a)(Object(a.a)(n,y),[b,c]),O=Object(h.a)(x),w=Math.floor(c/2)+1,k=Object(u.a)(O),j=Object(i.a)(O),T=Object(d.a)(k,[w,c-w],k.shape.length-1),S=Object(d.a)(j,[w,c-w],j.shape.length-1),N=n.shape.slice();return N[n.shape.length-1]=w,Object(s.a)(Object(a.a)(T[0],S[0]),N)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(67),a=n(123),o=n(66),i=n(74);var c=Object(o.b)({squeeze_:function(t,e){var n=Object(r.a)(t,"x","squeeze");return Object(i.a)(n,Object(a.Q)(n.shape,e).newShape)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({unstack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(t,"x","unstack","string_or_numeric");i.b(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var c={value:n},u={axis:e};return r.a.runKernel(a.gd,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({transpose_:function(t,e){var n=Object(o.a)(t,"x","transpose");if(null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),i.b(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){i.b(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(e)}))})),n.rank<=1)return n.clone();var c={x:n},u={perm:e};return r.a.runKernel(a.ed,c,u)}})},,,,,,,,,,function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(A){u=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,o=Object.create(a.prototype),i=new C(r||[]);return o._invoke=function(t,e,n){var r=d;return function(a,o){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===a)throw o;return E()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=T(i,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?h:f,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(t,n,i),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=s;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",b={};function m(){}function v(){}function g(){}var y={};y[o]=function(){return this};var x=Object.getPrototypeOf,O=x&&x(x(I([])));O&&O!==n&&r.call(O,o)&&(y=O);var w=g.prototype=m.prototype=Object.create(y);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function n(a,o,i,c){var u=l(t[a],t,o);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"===typeof d&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(d).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var a;this._invoke=function(t,r){function o(){return new e((function(e,a){n(t,r,e,a)}))}return a=a?a.then(o,o):o()}}function T(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method))return b;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var a=l(r,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,b):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function I(t){if(t){var n=t[o];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}return{next:E}}function E(){return{value:e,done:!0}}return v.prototype=w.constructor=g,g.constructor=v,v.displayName=u(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},k(j.prototype),j.prototype[i]=function(){return this},t.AsyncIterator=j,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new j(s(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(w),u(w,c,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=I,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return c.type="throw",c.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),b}},t}(t.exports);try{regeneratorRuntime=r}catch(a){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){"use strict";(function(t,r){var a;function o(){if(null==a){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof t)e=t;else if("undefined"!==typeof r)e=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}a=e}return a}function i(t,e){var n=function(){var t=o();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);var r=e();return n.set(t,r),n.get(t)}n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}))}).call(this,n(23),n(154))},function(t,e,n){"use strict";function r(t){if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;var e=t.userAgent||t.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function a(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(e),n.d(e,"isMobile",(function(){return r})),n.d(e,"isBrowser",(function(){return a}))},function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({floorDiv_:function(t,e){var n=Object(c.a)(t,"a","floorDiv"),u=Object(c.a)(e,"b","floorDiv"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.hb,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(88),l=n(66);var d=Object(l.b)({maximum_:function(t,e){var n=Object(c.a)(t,"a","maximum"),l=Object(c.a)(e,"b","maximum"),d=Object(i.makeTypesMatch)(n,l),f=Object(r.a)(d,2);n=f[0],l=f[1],"bool"===n.dtype&&(n=Object(s.a)(n,"int32"),l=Object(s.a)(l,"int32")),Object(u.a)(n.shape,l.shape);var p={a:n,b:l};return a.a.runKernel(o.Ob,p)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(88),u=n(102),s=n(66),l=n(74);var d=Object(s.b)({avgPool_:function(t,e,n,s,d){var f=Object(o.a)(t,"x","avgPool","float32");i.b(u.h(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var p=f,h=!1;3===f.rank&&(h=!0,p=Object(l.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),i.b(4===p.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(p.rank,".")})),null!=d&&i.b(i.v(s),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(s,".")}));var b={x:p},m={filterSize:e,strides:n,pad:s,dimRoundingMode:d},v=r.a.runKernel(a.o,b,m);return v=Object(c.a)(v,f.dtype),h?Object(l.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({tanh_:function(t){var e={x:Object(o.a)(t,"x","tanh")};return r.a.runKernel(a.ad,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({batchToSpaceND_:function(t,e,n){var c=Object(o.a)(t,"x","batchToSpaceND"),u=e.reduce((function(t,e){return t*e}));i.b(c.rank>=1+e.length,(function(){return"input rank is ".concat(c.rank," but should be > than blockShape.length ").concat(e.length)})),i.b(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),i.b(c.shape[0]%u===0,(function(){return"input tensor batch is ".concat(c.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(u)}));var s={x:c},l={blockShape:e,crops:n};return r.a.runKernel(a.t,s,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({bincount_:function(t,e,n){var c=Object(o.a)(t,"x","bincount"),u=Object(o.a)(e,"weights","bincount");i.b("int32"===c.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(c.dtype)})),i.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),i.b(u.size===c.size||0===u.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(c.shape,", weights shape: ")+"".concat(u.shape,".")}));var s={x:c,weights:u},l={size:n};return r.a.runKernel(a.u,s,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(124),c=n(66),u=n(74);var s=Object(c.b)({broadcastTo_:function(t,e){var n=Object(o.a)(t,"broadcastTo","x"),c=n.shape;if(e.some((function(t){return!(t>0)||t%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var s=n.shape.slice();s.length<e.length;)s.unshift(1);n=Object(u.a)(n,s)}for(var l=n.shape,d=Array.from(e),f=e.length-1;f>=0;f--)if(l[f]===e[f])d[f]=1;else if(1!==n.shape[f])throw new Error("broadcastTo(): [".concat(c,"] cannot be broadcast to [").concat(e,"]."));if(0===d.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0})).length)return Object(i.a)(n);var p={x:n},h={reps:d};return r.a.runKernel(a.bd,p,h)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({equal_:function(t,e){var n=Object(c.a)(t,"a","equal","string_or_numeric"),s=Object(c.a)(e,"b","equal","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.Y,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({elu_:function(t){var e={x:Object(o.a)(t,"x","elu")};return r.a.runKernel(a.W,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({expandDims_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(t,"x","expandDims","string_or_numeric");i.b(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var c={input:n},u={dim:e};return r.a.runKernel(a.bb,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({tile_:function(t,e){var n=Object(o.a)(t,"x","tile","string_or_numeric");i.b(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")}));var c={x:n},u={reps:e};return r.a.runKernel(a.bd,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({floor_:function(t){var e={x:Object(o.a)(t,"x","floor")};return r.a.runKernel(a.gb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({gather_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=Object(o.a)(t,"x","gather"),u=Object(o.a)(e,"indices","gather","int32"),s={x:c,indices:u},l={axis:n,batchDims:i};return r.a.runKernel(a.nb,s,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({greaterEqual_:function(t,e){var n=Object(c.a)(t,"a","greaterEqual","string_or_numeric"),s=Object(c.a)(e,"b","greaterEqual","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.pb,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({leakyRelu_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Object(o.a)(t,"x","leakyRelu"),i={x:n},c={alpha:e};return r.a.runKernel(a.yb,i,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({log1p_:function(t){var e={x:Object(o.a)(t,"x","log1p")};return r.a.runKernel(a.Db,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({softplus_:function(t){var e={x:Object(o.a)(t,"x","softplus")};return r.a.runKernel(a.Hc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({logicalNot_:function(t){var e={x:Object(o.a)(t,"x","logicalNot","bool")};return r.a.runKernel(a.Gb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(86),c=n(66);var u=Object(c.b)({logicalOr_:function(t,e){var n=Object(o.a)(t,"a","logicalOr","bool"),c=Object(o.a)(e,"b","logicalOr","bool");Object(i.a)(n.shape,c.shape);var u={a:n,b:c};return r.a.runKernel(a.Hb,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(102),u=n(66),s=n(74);var l=Object(u.b)({maxPool_:function(t,e,n,u,l){var d=Object(o.a)(t,"x","maxPool"),f=d,p=!1;3===d.rank&&(p=!0,f=Object(s.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),i.b(4===f.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(f.rank,".")})),i.b(c.h(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=l&&i.b(i.v(u),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var h={x:f},b={filterSize:e,strides:n,pad:u,dimRoundingMode:l},m=r.a.runKernel(a.Jb,h,b);return p?Object(s.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({min_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(o.a)(t,"x","min"),c={x:i},u={axis:e,keepDims:n};return r.a.runKernel(a.Qb,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(88),l=n(66);var d=Object(l.b)({minimum_:function(t,e){var n=Object(c.a)(t,"a","minimum"),l=Object(c.a)(e,"b","minimum"),d=Object(i.makeTypesMatch)(n,l),f=Object(r.a)(d,2);n=f[0],l=f[1],"bool"===n.dtype&&(n=Object(s.a)(n,"int32"),l=Object(s.a)(l,"int32")),Object(u.a)(n.shape,l.shape);var p={a:n,b:l};return a.a.runKernel(o.Rb,p)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({notEqual_:function(t,e){var n=Object(c.a)(t,"a","notEqual","string_or_numeric"),s=Object(c.a)(e,"b","notEqual","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.ac,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({oneHot_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));var c=Object(o.a)(t,"indices","oneHot","int32"),u={indices:c},s={depth:e,onValue:n,offValue:i};return r.a.runKernel(a.bc,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({spaceToBatchND_:function(t,e,n){var c=Object(o.a)(t,"x","spaceToBatchND");i.b(c.rank>=1+e.length,(function(){return"input rank ".concat(c.rank," should be > than [blockShape] ").concat(e.length)})),i.b(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),i.b(c.shape.reduce((function(t,r,a){return a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]===0:t}),!0),(function(){return"input spatial dimensions ".concat(c.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())}));var u={x:c},s={blockShape:e,paddings:n};return r.a.runKernel(a.Ic,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({prelu_:function(t,e){var n={x:Object(o.a)(t,"x","prelu"),alpha:Object(o.a)(e,"alpha","prelu")};return r.a.runKernel(a.hc,n)}})},function(t,e,n){"use strict";n.r(e),n.d(e,"TEST_EPSILON_FLOAT16",(function(){return c})),n.d(e,"expectArraysClose",(function(){return u})),n.d(e,"testEpsilon",(function(){return s})),n.d(e,"expectPromiseToFail",(function(){return d})),n.d(e,"expectArraysEqual",(function(){return f})),n.d(e,"expectNumbersClose",(function(){return p})),n.d(e,"expectValuesInRange",(function(){return b})),n.d(e,"expectArrayBuffersEqual",(function(){return m})),n.d(e,"encodeStrings",(function(){return v}));var r=n(68),a=n(67),o=n(123),i=n(71),c=.1;function u(t,e,n){return null==n&&(n=s()),l(t,e,(function(t,e){return h(t,e,n)}))}function s(){return 32===r.a.backend.floatPrecision()?.001:c}function l(t,e,n){var r=!0;if((Object(o.A)(t)||Object(o.A)(e))&&(r=!1),Object(o.A)(t)&&Object(o.A)(e)&&(r=!0),r){var i=t.constructor.name,c=e.constructor.name;if(i!==c)throw new Error("Arrays are of different type. Actual: ".concat(i,". ")+"Expected: ".concat(c))}if(Array.isArray(t)&&Array.isArray(e)){var u=Object(a.c)(t),s=Object(a.c)(e);if(!Object(o.a)(u,s))throw new Error("Arrays have different shapes. "+"Actual: [".concat(u,"]. Expected: [").concat(s,"]"))}var l=Object(o.A)(t)?t:Object(o.m)(t),d=Object(o.A)(e)?e:Object(o.m)(e);if(l.length!==d.length)throw new Error("Arrays have different lengths actual: ".concat(l.length," vs ")+"expected: ".concat(d.length,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(d,"."));for(var f=0;f<d.length;++f){var p=l[f],h=d[f];if(!n(p,h))throw new Error("Arrays differ: actual[".concat(f,"] = ").concat(p,", expected[").concat(f,"] = ").concat(h,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(d,"."))}}function d(t,e){t().then((function(){return e.fail()}),(function(){return e()}))}function f(t,e){var n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return Object(o.z)(t)||Object(o.z)(t[0])||Object(o.z)(e)||Object(o.z)(e[0])?l(t,n,(function(t,e){return t==e})):l(t,e,(function(t,e){return h(t,e,0)}))}function p(t,e,n){if(null==n&&(n=s()),!h(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e))}function h(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function b(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:".concat(t[r]," low: ").concat(e,", high: ").concat(n))}function m(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}function v(t){for(var e=0;e<t.length;e++){var n=t[e];Array.isArray(n)?v(n):t[e]=Object(i.encodeString)(n)}return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(105),a=n(66),o=n(164);var i=Object(a.b)({randomUniform_:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0,c=Object(r.a)(t,a),u=new o.c(e,n,null,i),s=0;s<c.values.length;s++)c.values[s]=u.nextValue();return c.toTensor()}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({relu6_:function(t){var e={x:Object(o.a)(t,"x","relu6")};return r.a.runKernel(a.oc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({round_:function(t){var e={x:Object(o.a)(t,"x","round")};return r.a.runKernel(a.wc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(114),a=n(99),o=n(159),i=n(79),c=n(66),u=n(166),s=n(74),l=n(117),d=n(87),f=n(95),p=n(168);var h=Object(c.b)({irfft_:function(t){var e,n=t.shape[t.shape.length-1],c=t.size/n;if(n<=2){var h=Object(s.a)(t,[c,n]);e=Object(p.a)(h)}else{var b=[c,2*(n-1)],m=Object(s.a)(Object(u.a)(t),[c,n]),v=Object(s.a)(Object(o.a)(t),[c,n]),g=Object(l.a)(Object(f.a)(m,[0,1],[c,n-2]),1),y=Object(i.a)(Object(l.a)(Object(f.a)(v,[0,1],[c,n-2]),1),Object(d.a)(-1)),x=Object(a.a)([m,g],1),O=Object(a.a)([v,y],1),w=Object(s.a)(Object(r.a)(x,O),[b[0],b[1]]);e=Object(p.a)(w)}if(e=Object(u.a)(e),3===t.rank&&0!==t.shape[0]){var k=e,j=t.shape[0];e=Object(s.a)(e,[j,e.shape[0]/j,e.shape[1]]),k.dispose()}return e}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({squaredDifference_:function(t,e){var n=Object(c.a)(t,"a","squaredDifference"),s=Object(c.a)(e,"b","squaredDifference"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.Rc,f,{})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({step_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(t,"x","step"),i={x:n},c={alpha:e};return r.a.runKernel(a.Sc,i,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(67),a=n(123),o=n(112);function i(t,e,n){if(Object(a.d)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var i=Object(r.c)(t,n);if(3!==i.length&&1!==i.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(o.a)(t,e,i,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(75),a=n.n(r),o=n(76),i=n(221),c=n(67);function u(){return(u=Object(o.a)(a.a.mark((function t(e){var n,r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(c.a)(e,"condition","whereAsync","bool"),t.next=3,n.data();case 3:return r=t.sent,o=Object(i.a)(n.shape,r),e!==n&&n.dispose(),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var s=function(t){return u.apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(105);function a(t,e){for(var n=[],a=0;a<e.length;a++)e[a]&&n.push(a);for(var o=Object(r.a)(t,"int32"),i=Object(r.a)([n.length,t.length],"int32"),c=0;c<n.length;c++){var u=o.indexToLoc(n[c]),s=c*t.length;i.values.set(u,s)}return i.toTensor()}},,,,,,,,,,,,,function(t,e,n){"use strict";(function(t){var r=n(320),a=n(321),o=n(322);function i(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(i()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return s(this,t,e,n)}function s(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"===typeof e?function(t,e,n){"string"===typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(e,n),a=(t=c(t,r)).write(e,n);a!==r&&(t=t.slice(0,a));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=c(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||(r=e.length)!==r?c(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(l(e),t=c(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function h(t,e){if(u.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function b(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return E(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,a){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(a)return-1;n=t.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,a);if("number"===typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,a);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,a){var o,i=1,c=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;i=2,c/=2,u/=2,n/=2}function s(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(a){var l=-1;for(o=n;o<c;o++)if(s(t,o)===s(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*i}else-1!==l&&(o-=o-l),l=-1}else for(n+u>c&&(n=c-u),o=n;o>=0;o--){for(var d=!0,f=0;f<u;f++)if(s(t,o+f)!==s(e,f)){d=!1;break}if(d)return o}return-1}function y(t,e,n,r){n=Number(n)||0;var a=t.length-n;r?(r=Number(r))>a&&(r=a):r=a;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var i=0;i<r;++i){var c=parseInt(e.substr(2*i,2),16);if(isNaN(c))return i;t[n+i]=c}return i}function x(t,e,n,r){return W(z(e,t.length-n),t,n,r)}function O(t,e,n,r){return W(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return O(t,e,n,r)}function k(t,e,n,r){return W(U(e),t,n,r)}function j(t,e,n,r){return W(function(t,e){for(var n,r,a,o=[],i=0;i<t.length&&!((e-=2)<0);++i)r=(n=t.charCodeAt(i))>>8,a=n%256,o.push(a),o.push(r);return o}(e,t.length-n),t,n,r)}function T(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],a=e;a<n;){var o,i,c,u,s=t[a],l=null,d=s>239?4:s>223?3:s>191?2:1;if(a+d<=n)switch(d){case 1:s<128&&(l=s);break;case 2:128===(192&(o=t[a+1]))&&(u=(31&s)<<6|63&o)>127&&(l=u);break;case 3:o=t[a+1],i=t[a+2],128===(192&o)&&128===(192&i)&&(u=(15&s)<<12|(63&o)<<6|63&i)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[a+1],i=t[a+2],c=t[a+3],128===(192&o)&&128===(192&i)&&128===(192&c)&&(u=(15&s)<<18|(63&o)<<12|(63&i)<<6|63&c)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=d}return function(t){var e=t.length;if(e<=N)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=N));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),e.kMaxLength=i(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return s(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?c(t,e):void 0!==n?"string"===typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,a=0,o=Math.min(n,r);a<o;++a)if(t[a]!==e[a]){n=t[a],r=e[a];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){var i=t[n];if(!u.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a),a+=i.length}return r},u.byteLength=h,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):b.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,a){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),e<0||n>t.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&e>=n)return 0;if(r>=a)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(a>>>=0)-(r>>>=0),i=(n>>>=0)-(e>>>=0),c=Math.min(o,i),s=this.slice(r,a),l=t.slice(e,n),d=0;d<c;++d)if(s[d]!==l[d]){o=s[d],i=l[d];break}return o<i?-1:i<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-e;if((void 0===n||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return O(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function C(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(127&t[a]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(t[a]);return r}function E(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var a="",o=e;o<n;++o)a+=V(t[o]);return a}function A(t,e,n){for(var r=t.slice(e,n),a="",o=0;o<r.length;o+=2)a+=String.fromCharCode(r[o]+256*r[o+1]);return a}function R(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function _(t,e,n,r,a,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function F(t,e,n,r){e<0&&(e=65535+e+1);for(var a=0,o=Math.min(t.length-n,2);a<o;++a)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function D(t,e,n,r){e<0&&(e=4294967295+e+1);for(var a=0,o=Math.min(t.length-n,4);a<o;++a)t[n+a]=e>>>8*(r?a:3-a)&255}function M(t,e,n,r,a,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,n,r,o){return o||M(t,0,n,4),a.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||M(t,0,n,8),a.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var a=e-t;n=new u(a,void 0);for(var o=0;o<a;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],a=1,o=0;++o<e&&(a*=256);)r+=this[t+o]*a;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],a=1;e>0&&(a*=256);)r+=this[t+--e]*a;return r},u.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],a=1,o=0;++o<e&&(a*=256);)r+=this[t+o]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,a=1,o=this[t+--r];r>0&&(a*=256);)o+=this[t+--r]*a;return o>=(a*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),a.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),a.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),a.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),a.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var a=1,o=0;for(this[e]=255&t;++o<n&&(a*=256);)this[e+o]=t/a&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var a=n-1,o=1;for(this[e+a]=255&t;--a>=0&&(o*=256);)this[e+a]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);_(this,t,e,n,a-1,-a)}var o=0,i=1,c=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===c&&0!==this[e+o-1]&&(c=1),this[e+o]=(t/i>>0)-c&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);_(this,t,e,n,a-1,-a)}var o=n-1,i=1,c=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===c&&0!==this[e+o+1]&&(c=1),this[e+o]=(t/i>>0)-c&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var a,o=r-n;if(this===t&&n<e&&e<r)for(a=o-1;a>=0;--a)t[a+e]=this[a+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(o=e;o<n;++o)this[o]=t;else{var i=u.isBuffer(t)?t:z(new u(t,r).toString()),c=i.length;for(o=0;o<n-e;++o)this[o+e]=i[o%c]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function V(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,a=null,o=[],i=0;i<r;++i){if((n=t.charCodeAt(i))>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&o.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(e-=3)>-1&&o.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function W(t,e,n,r){for(var a=0;a<r&&!(a+n>=e.length||a>=t.length);++a)e[a+n]=t[a];return a}}).call(this,n(23))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({acos_:function(t){var e={x:Object(o.a)(t,"x","acos")};return r.a.runKernel(a.b,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({acosh_:function(t){var e={x:Object(o.a)(t,"x","acosh")};return r.a.runKernel(a.c,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({addN_:function(t){i.b(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),i.b(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)}));var e=t.map((function(t,e){return Object(o.a)(t,"tensors".concat(e),"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!i.a(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var c=e;return r.a.runKernel(a.e,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({all_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(o.a)(t,"x","all","bool"),c={x:i},u={axis:e,keepDims:n};return r.a.runKernel(a.f,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({any_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(o.a)(t,"x","any","bool"),c={x:i},u={axis:e,keepDims:n};return r.a.runKernel(a.g,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({argMax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(t,"x","argMax"),i={x:n},c={axis:e};return r.a.runKernel(a.h,i,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({argMin_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(t,"x","argMin"),i={x:n},c={axis:e};return r.a.runKernel(a.i,i,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({asin_:function(t){var e={x:Object(o.a)(t,"x","asin")};return r.a.runKernel(a.j,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({asinh_:function(t){var e={x:Object(o.a)(t,"x","asinh")};return r.a.runKernel(a.k,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({atan_:function(t){var e={x:Object(o.a)(t,"x","atan")};return r.a.runKernel(a.l,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({atan2_:function(t,e){var n=Object(c.a)(t,"a","atan2"),u=Object(c.a)(e,"b","atan2"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.m,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({atanh_:function(t){var e={x:Object(o.a)(t,"x","atanh")};return r.a.runKernel(a.n,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(88),u=n(66),s=n(74);var l=Object(u.b)({avgPool3d_:function(t,e,n,u,l){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",f=Object(o.a)(t,"x","avgPool3d","float32"),p=f,h=!1;4===f.rank&&(h=!0,p=Object(s.a)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]])),i.b(5===p.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(p.rank,".")})),i.b("NDHWC"===d,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(d)})),null!=l&&i.b(i.v(u),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var b={x:p},m={filterSize:e,strides:n,pad:u,dimRoundingMode:l,dataFormat:d},v=r.a.runKernel(a.p,b,m);return v=Object(c.a)(v,p.dtype),h?Object(s.a)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({ceil_:function(t){var e={x:Object(o.a)(t,"x","ceil")};return r.a.runKernel(a.x,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({clipByValue_:function(t,e,n){var c=Object(o.a)(t,"x","clipByValue");i.b(e<=n,(function(){return"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")}));var u={x:c},s={clipValueMin:e,clipValueMax:n};return r.a.runKernel(a.y,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(67),a=n(123),o=n(140),i=n(102),c=n(66),u=n(74);var s=Object(c.b)({conv1d_:function(t,e,n,c){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,d=arguments.length>6?arguments[6]:void 0,f=Object(r.a)(t,"x","conv1d"),p=Object(r.a)(e,"filter","conv1d"),h=f,b=!1;2===f.rank&&(b=!0,h=Object(u.a)(f,[1,f.shape[0],f.shape[1]])),a.b(3===h.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(h.rank,".")})),a.b(3===p.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(p.rank,".")})),null!=d&&a.b(a.v(c),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(c,".")})),a.b(h.shape[2]===p.shape[1],(function(){return"Error in conv1d: depth of input (".concat(h.shape[2],") must match ")+"input depth for filter ".concat(p.shape[1],".")})),a.b(i.h(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.b("NWC"===s,(function(){return"Error in conv1d: got dataFormat of ".concat(s," but only NWC is currently supported.")}));var m=Object(u.a)(p,[1,p.shape[0],p.shape[1],p.shape[2]]),v=Object(u.a)(h,[h.shape[0],1,h.shape[1],h.shape[2]]),g=[1,n],y=[1,l],x="NHWC",O=Object(o.a)(v,m,g,c,x,y,d);return b?Object(u.a)(O,[O.shape[2],O.shape[3]]):Object(u.a)(O,[O.shape[0],O.shape[2],O.shape[3]])}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(67),a=n(253),o=n(66);var i=Object(o.b)({conv2dTranspose_:function(t,e,n,o,i,c){var u=Object(r.a)(t,"x","conv2dTranspose"),s=Object(r.a)(e,"filter","conv2dTranspose");return Object(a.a)(n,u,s,o,i,"NHWC",c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(123),i=n(66),c=n(74);var u=Object(i.b)({conv2DBackpropInput_:function(t,e,n,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0;o.b(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var d=t,f=e,p=!1;3===e.rank&&(p=!0,f=Object(c.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),d=[1,t[0],t[1],t[2]]),o.b(4===d.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,".")})),o.b(4===f.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(f.rank)})),o.b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var h="NHWC"===s?d[3]:d[1],b="NHWC"===s?f.shape[3]:f.shape[1];o.b(h===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(h,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),o.b(b===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(b,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=l&&o.b(o.v(u),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var m={dy:f,filter:n},v={strides:i,pad:u,dataFormat:s,dimRoundingMode:l,inputShape:d},g=r.a.runKernel(a.E,m,v);return p?Object(c.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(102),u=n(66),s=n(74);var l=Object(u.b)({conv3d_:function(t,e,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],f=Object(o.a)(t,"x","conv3d"),p=Object(o.a)(e,"filter","conv3d"),h=f,b=!1;4===f.rank&&(b=!0,h=Object(s.a)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]])),i.b(5===h.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(h.rank,".")})),i.b(5===p.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(p.rank,".")})),i.b(h.shape[4]===p.shape[3],(function(){return"Error in conv3d: depth of input (".concat(h.shape[4],") must match ")+"input depth for filter ".concat(p.shape[3],".")})),i.b(Object(c.h)(n,d),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(d,"'")})),i.b("NDHWC"===l,(function(){return"Error in conv3d: got dataFormat of ".concat(l," but only NDHWC is currently supported.")}));var m={x:h,filter:p},v={strides:n,pad:u,dataFormat:l,dilations:d},g=r.a.runKernel(a.F,m,v);return b?Object(s.a)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({cos_:function(t){var e={x:Object(o.a)(t,"x","cos")};return r.a.runKernel(a.I,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({cosh_:function(t){var e={x:Object(o.a)(t,"x","cosh")};return r.a.runKernel(a.J,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({cumsum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(o.a)(t,"x","cumsum"),u={x:c},s={axis:e,exclusive:n,reverse:i};return r.a.runKernel(a.L,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({denseBincount_:function(t,e,n){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(o.a)(t,"x","denseBincount"),s=Object(o.a)(e,"weights","denseBincount");i.b("int32"===u.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(u.dtype)})),i.b(u.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(u.rank,".")})),i.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),i.b(s.size===u.size||0===s.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(u.shape,", weights shape: ")+"".concat(s.shape,".")}));var l={x:u,weights:s},d={size:n,binaryOutput:c};return r.a.runKernel(a.M,l,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({depthToSpace_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",c=Object(o.a)(t,"x","depthToSpace"),u="NHWC"===n?c.shape[1]:c.shape[2],s="NHWC"===n?c.shape[2]:c.shape[3],l="NHWC"===n?c.shape[3]:c.shape[1];i.b(u*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(c.shape)})),i.b(s*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(e," for depthToSpace with input shape\n        ").concat(c.shape)})),i.b(l%(e*e)===0,(function(){return"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(l," for depthToSpace with input shape ").concat(c.shape)}));var d={x:c},f={blockSize:e,dataFormat:n};return r.a.runKernel(a.N,d,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66),u=n(74);var s=Object(c.b)({dilation2d_:function(t,e,n,c){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",d=Object(o.a)(t,"x","dilation2d"),f=Object(o.a)(e,"filter","dilation2d");i.b(3===d.rank||4===d.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(d.rank,".")})),i.b(3===f.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(f.rank,".")})),i.b("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var p=d,h=!1;3===d.rank&&(p=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),h=!0);var b={x:p,filter:f},m={strides:n,pad:c,dilations:s},v=r.a.runKernel(a.S,b,m);return h?Object(u.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(72),a=n(78),o=n(67),i=n(91),c=n(193),u=n(66),s=n(126),l=n(106);var d=Object(u.b)({divNoNan_:function(t,e){var n=Object(o.a)(t,"a","div"),u=Object(o.a)(e,"b","div"),d=Object(a.makeTypesMatch)(n,u),f=Object(r.a)(d,2);n=f[0],u=f[1];var p=Object(i.a)(n,u),h=Object(l.a)(p),b=Object(c.a)(u,h);return Object(s.a)(b,h,p)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var c=n.map((function(t,e){return Object(o.a)(t,"tensors".concat(e),"einsum")})),u={equation:t};return r.a.runKernel(a.V,c,u)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(88),u=n(66);var s=Object(u.b)({erf_:function(t){var e=Object(o.a)(t,"x","erf");i.b("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=Object(c.a)(e,"float32"));var n={x:e};return r.a.runKernel(a.Z,n)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({expm1_:function(t){var e={x:Object(o.a)(t,"x","expm1")};return r.a.runKernel(a.cb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({isNaN_:function(t){var e={x:Object(o.a)(t,"x","isNaN")};return r.a.runKernel(a.vb,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(86),s=n(66);var l=Object(s.b)({less_:function(t,e){var n=Object(c.a)(t,"a","less","string_or_numeric"),s=Object(c.a)(e,"b","less","string_or_numeric"),l=Object(i.makeTypesMatch)(n,s),d=Object(r.a)(l,2);n=d[0],s=d[1],Object(u.a)(n.shape,s.shape);var f={a:n,b:s};return a.a.runKernel(o.zb,f)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(68),a=n(69);function o(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");var o={start:t,stop:e,num:n};return r.a.runKernel(a.Bb,{},o)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66),u=n(74);var s=Object(c.b)({localResponseNormalization_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=Object(o.a)(t,"x","localResponseNormalization");i.b(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),i.b(i.v(e),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")}));var d=l,f=!1;3===l.rank&&(f=!0,d=Object(u.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var p={x:d},h={depthRadius:e,bias:n,alpha:c,beta:s},b=r.a.runKernel(a.wb,p,h);return f?Object(u.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(72),a=n(93),o=n(67),i=n(88),c=n(127),u=n(141),s=n(142),l=n(79),d=n(66),f=n(85),p=n(100);var h=Object(d.b)({logSoftmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(o.a)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));var d=Object(a.a)((function(t,n){var a=Object(s.a)(t,e,!0),o=Object(f.a)(t,a),d=Object(f.a)(Object(i.a)(o,"float32"),Object(u.a)(Object(p.a)(Object(c.a)(o),e,!0)));n([d]);return{value:d,gradFunc:function(t,n){var a=Object(r.a)(n,1)[0],o=Object(c.a)(a);return Object(f.a)(t,Object(l.a)(Object(p.a)(t,e,!0),o))}}}));return d(n)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66),u=n(74);var s=Object(c.b)({maxPool3d_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",d=Object(o.a)(t,"x","maxPool3d"),f=d,p=!1;4===d.rank&&(p=!0,f=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),i.b(5===f.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(f.rank,".")})),i.b("NDHWC"===l,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(l)})),null!=s&&i.b(i.v(c),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(s," but got pad ").concat(c,".")}));var h={x:f},b={filterSize:e,strides:n,pad:c,dimRoundingMode:s,dataFormat:l},m=r.a.runKernel(a.Kb,h,b);return p?Object(u.a)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({maxPoolWithArgmax_:function(t,e,n,i){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=Object(o.a)(t,"x","maxPoolWithArgmax"),s={x:u},l={filterSize:e,strides:n,pad:i,includeBatchInIndex:c},d=r.a.runKernel(a.Nb,s,l);return{result:d[0],indexes:d[1]}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(123),c=n(66);var u=Object(c.b)({mirrorPad_:function(t,e,n){i.b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var c=Object(o.a)(t,"x","mirrorPad");if(0===c.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");i.b(e.length===c.rank,(function(){return"Padding doesn't match input. Must be ".concat(c.rank,". ")+"Got ".concat(e.length,".")}));for(var u="reflect"===n?1:0,s=function(t){i.b(2===e[t].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),i.b(e[t][0]>=0&&e[t][0]<=c.shape[t]-u&&e[t][1]>=0&&e[t][1]<=c.shape[t]-u,(function(){return"Padding in dimension ".concat(t," cannot be greater than or equal ")+"to ".concat(c.shape[t]-u," or less than 0 for input of ")+"shape ".concat(c.shape)}))},l=0;l<c.rank;l++)s(l);var d={paddings:e,mode:n},f={x:c};return r.a.runKernel(a.Sb,f,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(78),c=n(67),u=n(66);var s=Object(u.b)({mod_:function(t,e){var n=Object(c.a)(t,"a","mod"),u=Object(c.a)(e,"b","mod"),s=Object(i.makeTypesMatch)(n,u),l=Object(r.a)(s,2),d={a:n=l[0],b:u=l[1]};return a.a.runKernel(o.Tb,d)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(66),c=n(74);var u=Object(i.b)({multinomial_:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(o.a)(t,"logits","multinomial"),s=u.size,l=u.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(s,"."));if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(l));n=n||Math.random();var d=1===l?Object(c.a)(u,[1,-1]):u,f={logits:d},p={numSamples:e,seed:n,normalized:i},h=r.a.runKernel(a.Ub,f,p);return 1===l?Object(c.a)(h,[h.size]):h}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({onesLike_:function(t){var e={x:Object(o.a)(t,"x","onesLike")};return r.a.runKernel(a.cc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(88),c=n(66);var u=Object(c.b)({prod_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=Object(o.a)(t,"x","prod");"bool"===c.dtype&&(c=Object(i.a)(c,"int32"));var u={x:c},s={axis:e,keepDims:n};return r.a.runKernel(a.ic,u,s)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({reciprocal_:function(t){var e={x:Object(o.a)(t,"x","reciprocal")};return r.a.runKernel(a.mc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({rsqrt_:function(t){var e={x:Object(o.a)(t,"x","rsqrt")};return r.a.runKernel(a.xc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({selu_:function(t){var e={x:Object(o.a)(t,"x","selu")};return r.a.runKernel(a.Ac,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(75),a=n.n(r),o=n(76),i=n(92),c=n(67),u=n(123);function s(){return(s=Object(o.a)(a.a.mark((function t(e,n){var r,o,s,l,d,f,p,h,b,m,v;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(c.a)(e,"x","setdiff1d"),o=Object(c.a)(n,"y","setdiff1d"),u.b(r.dtype===o.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(o.dtype,").")})),u.b(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),u.b(1===o.rank,(function(){return"y should be 1D tensor, but got y (".concat(o.shape,").")})),t.next=7,r.data();case 7:return s=t.sent,t.next=10,o.data();case 10:for(l=t.sent,d=new Set(l),f=0,p=0;p<s.length;p++)d.has(s[p])||f++;for(h=new i.b([f],r.dtype),b=new i.b([f],"int32"),m=0,v=0;m<s.length;m++)d.has(s[m])||(h.values[v]=s[m],b.values[v]=m,v++);return t.abrupt("return",[h.toTensor(),b.toTensor()]);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var l=function(t,e){return s.apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({sign_:function(t){var e={x:Object(o.a)(t,"x","sign")};return r.a.runKernel(a.Cc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({sin_:function(t){var e={x:Object(o.a)(t,"x","sin")};return r.a.runKernel(a.Dc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({sinh_:function(t){var e={x:Object(o.a)(t,"x","sinh")};return r.a.runKernel(a.Ec,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({softmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(o.a)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));var i={logits:n},c={dim:e};return r.a.runKernel(a.Gc,i,c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({stridedSlice_:function(t,e,n,i){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,f=Object(o.a)(t,"x","stridedSlice","string_or_numeric"),p={x:f},h={begin:e,end:n,strides:i,beginMask:c,endMask:u,ellipsisMask:s,newAxisMask:l,shrinkAxisMask:d};return r.a.runKernel(a.Tc,p,h)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({tan_:function(t){var e={x:Object(o.a)(t,"x","tan")};return r.a.runKernel(a.Zc,e)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(72),a=n(68),o=n(69),i=n(67),c=n(66);var u=Object(c.b)({topk_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=Object(i.a)(t,"x","topk");if(0===c.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var u=c.shape[c.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>u)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(u,") ")+"but got ".concat(e));var s={x:c},l={k:e,sorted:n},d=a.a.runKernel(o.cd,s,l),f=Object(r.a)(d,2),p=f[0],h=f[1];return{values:p,indices:h}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(105),a=n(66),o=n(164);var i=Object(a.b)({truncatedNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var c=new o.a(e,n,a,!0,i),u=Object(r.a)(t,a),s=0;s<u.values.length;s++)u.values[s]=c.nextValue();return u.toTensor()}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(72),a=n(68),o=n(69),i=n(67),c=n(123),u=n(66);var s=Object(u.b)({unique_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(t,"x","unique","string_or_numeric");Object(c.b)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var u={x:n},s={axis:e},l=a.a.runKernel(o.fd,u,s),d=Object(r.a)(l,2),f=d[0],p=d[1];return{values:f,indices:p}}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69),o=n(67),i=n(66),c=n(147);var u=Object(i.b)({scatterND_:function(t,e,n){var i=Object(o.a)(t,"indices","scatterND","int32"),u=Object(o.a)(e,"updates","scatterND");c.validateInput(u,i,n);var s={indices:i,updates:u},l={shape:n};return r.a.runKernel(a.yc,s,l)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(68),a=n(69),o=n(67),i=n(66);var c=Object(i.b)({gatherND_:function(t,e){var n=Object(o.a)(e,"indices","gatherND","int32"),i={params:Object(o.a)(t,"x","gatherND","string_or_numeric"),indices:n};return r.a.runKernel(a.mb,i)}})},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return a}));var r="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof t?t:function(t){return t()};function a(){return new Promise((function(t){return r((function(){return t()}))}))}}).call(this,n(335).setImmediate)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return E})),n.d(e,"i",(function(){return R})),n.d(e,"c",(function(){return _})),n.d(e,"f",(function(){return F})),n.d(e,"e",(function(){return P})),n.d(e,"d",(function(){return L})),n.d(e,"k",(function(){return V})),n.d(e,"g",(function(){return z})),n.d(e,"h",(function(){return U})),n.d(e,"j",(function(){return W})),n.d(e,"b",(function(){return G}));var r=n(72),a=n(77),o=n(70),i=n(73),c=n(65),u=n(337),s=n(148),l=n(82),d=n(338),f=n(339),p=n(340),h=n(341),b=n(342),m=n(343),v=n(344),g=n(345),y=n(346),x=n(347),O=n(348),w=n(349),k=n(350),j=n(351),T=n(352),S=n(353),N=n(354),C=n(355),I=n(356),E=function(){function t(){var e;Object(o.a)(this,t);var n=[d,f,p,h,b,m,v,g,y,x,O,w,k,j,T,S,N,C,I],r=(e=[]).concat.apply(e,Object(a.a)(n.map((function(t){return t.json}))));this.opMappers=r.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object(i.a)(t,[{key:"transformGraph",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.node,o=[],i=[],c=[],u=a.reduce((function(t,n){return t[n.name]=e.mapNode(n),n.op.startsWith("Placeholder")?o.push(t[n.name]):"Const"===n.op?i.push(t[n.name]):null!=n.input&&0!==n.input.length||c.push(t[n.name]),t}),{}),s=[],d=[],f={},p={};null!=n&&(f=this.mapSignatureEntries(n.inputs),p=this.mapSignatureEntries(n.outputs));var h=Object.keys(u);h.forEach((function(t){var e=u[t];e.inputNames.forEach((function(t,n){var a=Object(l.b)(t),o=Object(r.a)(a,3),i=o[0],c=o[2],s=u[i];if(null!=s.outputs){var d=s.outputs.indexOf(c);if(-1!==d){var f="".concat(i,":").concat(d);e.inputNames[n]=f}}e.inputs.push(s),s.children.push(e)}))})),0===Object.keys(p).length?h.forEach((function(t){var e=u[t];0===e.children.length&&d.push(e)})):Object.keys(p).forEach((function(t){var e=Object(l.b)(t),n=Object(r.a)(e,1)[0],a=u[n];null!=a&&(a.signatureKey=p[t],d.push(a))})),Object.keys(f).length>0?Object.keys(f).forEach((function(t){var e=Object(l.b)(t),n=Object(r.a)(e,1)[0],a=u[n];a&&(a.signatureKey=f[t],s.push(a))})):s=o;var b={};null!=t.library&&null!=t.library.function&&(b=t.library.function.reduce((function(t,n){return t[n.signature.name]=e.mapFunction(n),t}),{}));var m={nodes:u,inputs:s,outputs:d,weights:i,placeholders:o,signature:n,functions:b};return c.length>0&&(m.initNodes=c),m}},{key:"mapSignatureEntries",value:function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})}},{key:"mapNode",value:function(t){var e=Object(s.b)(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=R(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=R(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=U(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=U(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=F(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=F(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=z(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=z(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=_(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=G(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=G(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=V(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=V(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=W(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=W(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=P(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=P(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=L(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=L(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=M(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=M(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:a,type:r},e}),{})),n}},{key:"mapFunction",value:function(t){var e=this,n=t.nodeDef,a=[],o={};null!=n&&(o=n.reduce((function(t,n){return t[n.name]=e.mapNode(n),"Const"===n.op&&a.push(t[n.name]),t}),{}));var i=[],c=[];t.signature.inputArg.forEach((function(t){var e=Object(l.b)(t.name),n=Object(r.a)(e,1)[0],a={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:D(t.type),type:"dtype"}},children:[]};a.signatureKey=t.name,i.push(a),o[n]=a})),Object.keys(o).forEach((function(t){var e=o[t];e.inputNames.forEach((function(t,n){var a=Object(l.b)(t),i=Object(r.a)(a,3),c=i[0],u=i[2],s=o[c];if(null!=s.outputs){var d=s.outputs.indexOf(u);if(-1!==d){var f="".concat(c,":").concat(d);e.inputNames[n]=f}}e.inputs.push(s),s.children.push(e)}))}));var u=t.ret;t.signature.outputArg.forEach((function(t){var e=Object(l.b)(u[t.name]),n=Object(r.a)(e,2),a=n[0],i=n[1],s=o[a];null!=s&&(s.defaultOutput=i,c.push(s))}));var s=this.mapArgsToSignature(t);return{nodes:o,inputs:i,outputs:c,weights:a,placeholders:[],signature:s}}},{key:"mapArgsToSignature",value:function(t){var e=this;return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((function(t,n){return t[n.name]=e.mapArgToTensorInfo(n),t}),{}),outputs:t.signature.outputArg.reduce((function(n,r){return n[r.name]=e.mapArgToTensorInfo(r,t.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(t,e){var n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();function A(e,n){var r=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var n=Object(c.env)().global;if("undefined"!==typeof n.atob)return n.atob(e);if("undefined"!==typeof t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return n?r:r.toLowerCase()}function R(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t[e];return null!=a?A(a.s,r):n}function _(t,e,n){var r=t[e];return r?r.b:n}function F(t,e,n){var r=t[e]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function D(t){switch("string"===typeof t&&(t=u.a[t]),t){case u.a.DT_FLOAT:return"float32";case u.a.DT_INT32:case u.a.DT_INT64:case u.a.DT_INT8:case u.a.DT_UINT8:return"int32";case u.a.DT_BOOL:return"bool";case u.a.DT_DOUBLE:return"float32";case u.a.DT_STRING:return"string";default:return null}}function M(t,e,n){var r=t[e];return r&&r.func?r.func.name:n}function P(t,e,n){var r=t[e];return r&&r.type?D(r.type):n}function L(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return D(t)})):n}function B(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"===typeof t.size?t.size:parseInt(t.size,10)})):[]}function V(t,e,n){var r=t[e];return r&&r.shape?B(r.shape):n}function z(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"===typeof t?t:parseInt(t,10)})):n}function U(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t[e];return a&&a.list&&a.list.s?a.list.s.map((function(t){return A(t,r)})):n}function W(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return B(t)})):n}function G(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n(234).Buffer)},,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"GraphModel",(function(){return On})),n.d(e,"loadGraphModel",(function(){return wn})),n.d(e,"deregisterOp",(function(){return b.a})),n.d(e,"registerOp",(function(){return b.c})),n.d(e,"version_converter",(function(){return jn}));var r={};n.r(r),n.d(r,"abs",(function(){return It.b})),n.d(r,"acos",(function(){return It.c})),n.d(r,"acosh",(function(){return It.d})),n.d(r,"add",(function(){return It.e})),n.d(r,"addN",(function(){return It.f})),n.d(r,"all",(function(){return It.g})),n.d(r,"any",(function(){return It.h})),n.d(r,"argMax",(function(){return It.i})),n.d(r,"argMin",(function(){return It.j})),n.d(r,"asin",(function(){return It.k})),n.d(r,"asinh",(function(){return It.l})),n.d(r,"atan",(function(){return It.m})),n.d(r,"atan2",(function(){return It.n})),n.d(r,"atanh",(function(){return It.o})),n.d(r,"avgPool",(function(){return It.p})),n.d(r,"avgPool3d",(function(){return It.q})),n.d(r,"basicLSTMCell",(function(){return It.r})),n.d(r,"batchToSpaceND",(function(){return It.w})),n.d(r,"batchNorm",(function(){return It.s})),n.d(r,"batchNorm2d",(function(){return It.t})),n.d(r,"batchNorm3d",(function(){return It.u})),n.d(r,"batchNorm4d",(function(){return It.v})),n.d(r,"bincount",(function(){return It.x})),n.d(r,"broadcastTo",(function(){return It.z})),n.d(r,"buffer",(function(){return It.A})),n.d(r,"cast",(function(){return It.B})),n.d(r,"ceil",(function(){return It.C})),n.d(r,"clipByValue",(function(){return It.D})),n.d(r,"clone",(function(){return It.E})),n.d(r,"complex",(function(){return It.F})),n.d(r,"concat",(function(){return It.G})),n.d(r,"concat1d",(function(){return It.H})),n.d(r,"concat2d",(function(){return It.I})),n.d(r,"concat3d",(function(){return It.J})),n.d(r,"concat4d",(function(){return It.K})),n.d(r,"conv1d",(function(){return It.L})),n.d(r,"conv2d",(function(){return It.M})),n.d(r,"conv2dTranspose",(function(){return It.N})),n.d(r,"conv3d",(function(){return It.O})),n.d(r,"conv3dTranspose",(function(){return It.P})),n.d(r,"cos",(function(){return It.Q})),n.d(r,"cosh",(function(){return It.R})),n.d(r,"cumsum",(function(){return It.T})),n.d(r,"denseBincount",(function(){return It.U})),n.d(r,"depthToSpace",(function(){return It.V})),n.d(r,"depthwiseConv2d",(function(){return It.W})),n.d(r,"diag",(function(){return It.X})),n.d(r,"dilation2d",(function(){return It.Y})),n.d(r,"div",(function(){return It.Z})),n.d(r,"divNoNan",(function(){return It.ab})),n.d(r,"dot",(function(){return It.bb})),n.d(r,"einsum",(function(){return It.db})),n.d(r,"elu",(function(){return It.eb})),n.d(r,"equal",(function(){return It.gb})),n.d(r,"erf",(function(){return It.hb})),n.d(r,"exp",(function(){return It.ib})),n.d(r,"expandDims",(function(){return It.jb})),n.d(r,"expm1",(function(){return It.kb})),n.d(r,"eye",(function(){return It.lb})),n.d(r,"fill",(function(){return It.nb})),n.d(r,"floor",(function(){return It.ob})),n.d(r,"floorDiv",(function(){return It.pb})),n.d(r,"gather",(function(){return It.rb})),n.d(r,"greater",(function(){return It.tb})),n.d(r,"greaterEqual",(function(){return It.ub})),n.d(r,"imag",(function(){return It.wb})),n.d(r,"isFinite",(function(){return It.Ab})),n.d(r,"isInf",(function(){return It.Bb})),n.d(r,"isNaN",(function(){return It.Cb})),n.d(r,"leakyRelu",(function(){return It.Db})),n.d(r,"less",(function(){return It.Eb})),n.d(r,"lessEqual",(function(){return It.Fb})),n.d(r,"linspace",(function(){return It.Hb})),n.d(r,"localResponseNormalization",(function(){return It.Ib})),n.d(r,"log",(function(){return It.Jb})),n.d(r,"log1p",(function(){return It.Kb})),n.d(r,"logSigmoid",(function(){return It.Lb})),n.d(r,"logSoftmax",(function(){return It.Mb})),n.d(r,"logSumExp",(function(){return It.Nb})),n.d(r,"logicalAnd",(function(){return It.Ob})),n.d(r,"logicalNot",(function(){return It.Pb})),n.d(r,"logicalOr",(function(){return It.Qb})),n.d(r,"logicalXor",(function(){return It.Rb})),n.d(r,"matMul",(function(){return It.Tb})),n.d(r,"max",(function(){return It.Ub})),n.d(r,"maxPool",(function(){return It.Vb})),n.d(r,"maxPool3d",(function(){return It.Wb})),n.d(r,"maxPoolWithArgmax",(function(){return It.Xb})),n.d(r,"maximum",(function(){return It.Yb})),n.d(r,"mean",(function(){return It.Zb})),n.d(r,"meshgrid",(function(){return It.ac})),n.d(r,"min",(function(){return It.bc})),n.d(r,"minimum",(function(){return It.cc})),n.d(r,"mirrorPad",(function(){return It.dc})),n.d(r,"mod",(function(){return It.ec})),n.d(r,"moments",(function(){return It.fc})),n.d(r,"mul",(function(){return It.hc})),n.d(r,"multiRNNCell",(function(){return It.ic})),n.d(r,"multinomial",(function(){return It.jc})),n.d(r,"neg",(function(){return It.kc})),n.d(r,"notEqual",(function(){return It.mc})),n.d(r,"oneHot",(function(){return It.nc})),n.d(r,"ones",(function(){return It.oc})),n.d(r,"onesLike",(function(){return It.pc})),n.d(r,"outerProduct",(function(){return It.rc})),n.d(r,"pad",(function(){return It.sc})),n.d(r,"pad1d",(function(){return It.tc})),n.d(r,"pad2d",(function(){return It.uc})),n.d(r,"pad3d",(function(){return It.vc})),n.d(r,"pad4d",(function(){return It.wc})),n.d(r,"pool",(function(){return It.xc})),n.d(r,"pow",(function(){return It.yc})),n.d(r,"prelu",(function(){return It.zc})),n.d(r,"print",(function(){return It.Ac})),n.d(r,"prod",(function(){return It.Bc})),n.d(r,"rand",(function(){return It.Cc})),n.d(r,"randomGamma",(function(){return It.Dc})),n.d(r,"randomNormal",(function(){return It.Ec})),n.d(r,"randomUniform",(function(){return It.Fc})),n.d(r,"range",(function(){return It.Gc})),n.d(r,"real",(function(){return It.Hc})),n.d(r,"reciprocal",(function(){return It.Ic})),n.d(r,"relu",(function(){return It.Jc})),n.d(r,"relu6",(function(){return It.Kc})),n.d(r,"reshape",(function(){return It.Lc})),n.d(r,"reverse",(function(){return It.Mc})),n.d(r,"reverse1d",(function(){return It.Nc})),n.d(r,"reverse2d",(function(){return It.Oc})),n.d(r,"reverse3d",(function(){return It.Pc})),n.d(r,"reverse4d",(function(){return It.Qc})),n.d(r,"round",(function(){return It.Sc})),n.d(r,"rsqrt",(function(){return It.Tc})),n.d(r,"scalar",(function(){return It.Uc})),n.d(r,"selu",(function(){return It.Wc})),n.d(r,"separableConv2d",(function(){return It.Xc})),n.d(r,"setdiff1dAsync",(function(){return It.Yc})),n.d(r,"sigmoid",(function(){return It.Zc})),n.d(r,"sign",(function(){return It.ad})),n.d(r,"sin",(function(){return It.cd})),n.d(r,"sinh",(function(){return It.dd})),n.d(r,"slice",(function(){return It.ed})),n.d(r,"slice1d",(function(){return It.fd})),n.d(r,"slice2d",(function(){return It.gd})),n.d(r,"slice3d",(function(){return It.hd})),n.d(r,"slice4d",(function(){return It.id})),n.d(r,"softmax",(function(){return It.jd})),n.d(r,"softplus",(function(){return It.kd})),n.d(r,"spaceToBatchND",(function(){return It.ld})),n.d(r,"fft",(function(){return It.mb})),n.d(r,"ifft",(function(){return It.vb})),n.d(r,"irfft",(function(){return It.zb})),n.d(r,"rfft",(function(){return It.Rc})),n.d(r,"split",(function(){return It.pd})),n.d(r,"sqrt",(function(){return It.qd})),n.d(r,"square",(function(){return It.rd})),n.d(r,"squaredDifference",(function(){return It.sd})),n.d(r,"squeeze",(function(){return It.td})),n.d(r,"stack",(function(){return It.ud})),n.d(r,"step",(function(){return It.vd})),n.d(r,"stridedSlice",(function(){return It.wd})),n.d(r,"sub",(function(){return It.yd})),n.d(r,"sum",(function(){return It.zd})),n.d(r,"tan",(function(){return It.Ad})),n.d(r,"tanh",(function(){return It.Bd})),n.d(r,"tensor",(function(){return It.Cd})),n.d(r,"tensor1d",(function(){return It.Dd})),n.d(r,"tensor2d",(function(){return It.Ed})),n.d(r,"tensor3d",(function(){return It.Fd})),n.d(r,"tensor4d",(function(){return It.Gd})),n.d(r,"tensor5d",(function(){return It.Hd})),n.d(r,"tensor6d",(function(){return It.Id})),n.d(r,"tile",(function(){return It.Jd})),n.d(r,"topk",(function(){return It.Kd})),n.d(r,"truncatedNormal",(function(){return It.Md})),n.d(r,"unique",(function(){return It.Nd})),n.d(r,"unsortedSegmentSum",(function(){return It.Od})),n.d(r,"unstack",(function(){return It.Pd})),n.d(r,"variable",(function(){return It.Qd})),n.d(r,"where",(function(){return It.Rd})),n.d(r,"whereAsync",(function(){return It.Sd})),n.d(r,"zeros",(function(){return It.Td})),n.d(r,"zerosLike",(function(){return It.Ud})),n.d(r,"booleanMaskAsync",(function(){return It.y})),n.d(r,"transpose",(function(){return It.Ld})),n.d(r,"norm",(function(){return It.lc})),n.d(r,"movingAverage",(function(){return It.gc})),n.d(r,"scatterND",(function(){return It.Vc})),n.d(r,"sparseToDense",(function(){return It.nd})),n.d(r,"gatherND",(function(){return It.sb})),n.d(r,"dropout",(function(){return It.cb})),n.d(r,"enclosingPowerOfTwo",(function(){return It.fb})),n.d(r,"cosineWindow",(function(){return It.S})),n.d(r,"inTopKAsync",(function(){return It.yb})),n.d(r,"op",(function(){return It.qc})),n.d(r,"OP_SCOPE_SUFFIX",(function(){return It.a})),n.d(r,"image",(function(){return It.xb})),n.d(r,"linalg",(function(){return It.Gb})),n.d(r,"losses",(function(){return It.Sb})),n.d(r,"spectral",(function(){return It.od})),n.d(r,"fused",(function(){return It.qb})),n.d(r,"signal",(function(){return It.bd})),n.d(r,"sparse",(function(){return It.md})),n.d(r,"string",(function(){return It.xd}));var a=n(75),o=n.n(a),i=n(76),c=n(70),u=n(73),s=n(65),l=n(293),d=n(72),f=n(77),p=n(82),h=function(){function t(e,n,r){var a=this;Object(c.a)(this,t),this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((function(t){return a.getInput(t)})),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((function(t,e){return t[e]=a.getAttr(e),t}),{}))}return Object(u.a)(t,[{key:"getInput",value:function(t){return Object(p.e)(t,this.tensorMap,this.context)}},{key:"getAttr",value:function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return Object(p.e)(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(l.f)(this.node.rawAttrs,t,e);if(null!=n.s)return Object(l.i)(this.node.rawAttrs,t,e);if(null!=n.b)return Object(l.c)(this.node.rawAttrs,t,e);if(null!=n.shape)return Object(l.k)(this.node.rawAttrs,t,e);if(null!=n.type)return Object(l.e)(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(l.g)(this.node.rawAttrs,t,e);if(null!=n.list.s)return Object(l.h)(this.node.rawAttrs,t,e);if(null!=n.list.shape)return Object(l.j)(this.node.rawAttrs,t,e);if(null!=n.list.b)return Object(l.b)(this.node.rawAttrs,t,e);if(null!=n.list.type)return Object(l.d)(this.node.rawAttrs,t,e)}return e}}]),t}(),b=n(148),m=n(83),v=n(238),g=n(273),y=n(79),x=n(91),O=n(261),w=n(186),k=n(85),j=n(207),T=n(187),S=n(138),N=n(217),C=n(115),I=n(236),E=n(237),A=n(243),R=n(244),_=n(245),F=n(246),D=n(247),M=n(249),P=n(114),L=n(255),B=n(256),V=n(194),z=n(263),U=n(127),W=n(264),G=n(197),H=n(141),q=n(201),K=n(159),X=n(116),Y=n(277),Q=n(166),Z=n(144),J=n(215),$=n(279),tt=n(139),et=n(282),nt=n(281),rt=n(283),at=n(202),ot=n(125),it=n(107),ct=n(189),ut=n(286),st=n(250),lt=n(214),dt=n(278),ft=n(276),pt=n(200),ht=n(211),bt=n(265);function mt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof t&&"number"!==typeof e){s.util.assert(t.length===e.length,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}));for(var r=0;r<t.length;r++){var a=t[r],o=e[r];s.util.assert(a<0||o<0||a===o,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}}}function vt(t){return"number"!==typeof t&&!t.some((function(t){return t<0}))}function gt(t,e,n){var r=yt(t,n),a=!vt(r);if(a&&0===e.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&e.forEach((function(t){r=yt(t.shape,r)})),!vt(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function yt(t,e){if("number"===typeof t)return e;if("number"===typeof e)return t;if(t.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(t," vs. ").concat(e));for(var n=[],r=0;r<t.length;++r){var a=t[r],o=e[r];if(a>=0&&o>=0&&a!==o)throw new Error("Incompatible shape during merge: ".concat(t," vs. ").concat(e));n[r]=a>=0?a:o}return n}var xt=function(){function t(e,n,r,a,o,i,u){Object(c.a)(this,t),this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=Object(s.scalar)(0),Object(s.keep)(this.idTensor)}return Object(u.a)(t,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.tensor.id)||e.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}},{key:"readMany",value:function(t){var e=this;return t.map((function(t){return e.read(t)}))}},{key:"write",value:function(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),mt(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,Object(s.keep)(e),n.written=!0,this.tensors[t]=n}},{key:"writeMany",value:function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach((function(t,r){return n.write(t,e[r])}))}},{key:"gather",value:function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return Object(s.tensor)([],[0].concat(this.elementShape));var r=this.readMany(t);return mt(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(s.stack)(r,0)}},{key:"concat",value:function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return Object(s.tensor)([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return mt(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Object(s.concat)(r,0)}},{key:"scatter",value:function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var n=Math.max.apply(Math,Object(f.a)(t));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,Object(s.unstack)(e,0))}},{key:"split",value:function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));var r=0,a=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:e.size/r,i=[];Object(s.tidy)((function(){e=Object(s.reshape)(e,[1,r,o]);for(var c=0;c<t.length;++c){var u=[0,0===c?0:a[c-1],0],l=[1,t[c],o];i[c]=Object(s.reshape)(Object(s.slice)(e,u,l),n.elementShape)}return i}));for(var c=[],u=0;u<t.length;u++)c[u]=u;this.writeMany(c,i)}}]),t}(),Ot=function(){function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Object(c.a)(this,t),this.tensors=e,this.elementShape=n,this.elementDtype=r,null!=e&&e.forEach((function(t){if(r!==t.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(t.dtype));mt(n,t.shape,"TensorList shape mismatch: "),Object(s.keep)(t)})),this.idTensor=Object(s.scalar)(0),this.maxNumElements=a,Object(s.keep)(this.idTensor)}return Object(u.a)(t,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new t(Object(f.a)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.id)||e.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));mt(t,this.elementShape,"TensorList shape mismatch: ");var a=gt(this.elementShape,this.tensors,t);return Object(s.tidy)((function(){var t=n.tensors.map((function(t){return Object(s.reshape)(t,a)}));return Object(s.stack)(t,0)}))}},{key:"popBack",value:function(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=gt(this.elementShape,this.tensors,t),r=this.tensors.pop();return mt(r.shape,t,"TensorList shape mismatch: "),Object(s.reshape)(r,n)}},{key:"pushBack",value:function(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(mt(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(s.keep)(t),this.tensors.push(t)}},{key:"resize",value:function(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=t}},{key:"getItem",value:function(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));mt(this.tensors[t].shape,e,"TensorList shape mismatch: ");var r=gt(this.elementShape,this.tensors,e);return Object(s.reshape)(this.tensors[t],r)}},{key:"setItem",value:function(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));mt(this.elementShape,e.shape,"TensorList shape mismatch: "),Object(s.keep)(e),this.tensors[t]=e}},{key:"gather",value:function(t,e,n){var r=this;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));mt(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());var a=gt(this.elementShape,this.tensors,n);return 0===t.length?Object(s.tensor)([],[0].concat(a)):Object(s.tidy)((function(){var e=t.map((function(t){return Object(s.reshape)(r.tensors[t],a)}));return Object(s.stack)(e,0)}))}},{key:"concat",value:function(t,e){var n=this;if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));mt(this.elementShape,e,"TensorList shape mismatch: ");var r=gt(this.elementShape,this.tensors,e);return 0===this.size()?Object(s.tensor)([],[0].concat(r)):Object(s.tidy)((function(){var t=n.tensors.map((function(t){return Object(s.reshape)(t,r)}));return Object(s.concat)(t,0)}))}}]),t}();function wt(t,e,n){var r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));mt(t.shape.slice(1),e,"TensorList shape mismatch: ");var a=Object(s.unstack)(t);return new Ot(a,e,r)}function kt(t,e,n){return new Ot([],t,e,n)}function jt(t,e,n,r){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var a=Math.max.apply(Math,Object(f.a)(e));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var o=new Ot([],n,t.dtype,r),i=Object(s.unstack)(t,0);return e.forEach((function(t,e){o.setItem(t,i[e])})),o}function Tt(t,e,n){var r=0,a=e.map((function(t){return r+=t}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));for(var o=yt(t.shape.slice(1),n),i=0===r?0:t.size/r,c=Object(s.tidy)((function(){var n=[];t=Object(s.reshape)(t,[1,r,i]);for(var c=0;c<e.length;++c){var u=[0,0===c?0:a[c-1],0],l=[1,e[c],i];n[c]=Object(s.reshape)(Object(s.slice)(t,u,l),o)}return t.dispose(),n})),u=new Ot([],n,t.dtype,e.length),l=0;l<c.length;l++)u.setItem(l,c[l]);return u}var St=function(){var t=Object(i.a)(o.a.mark((function t(e,n,r){var a,i,c,u,l,d,f,h,b,m,v,g,y,x,O,w,k,j,T,S,N,C,I,E,A,R,_,F,D,M,P,L,B,V,z,U,W,G,H,q,K,X,Y,Q,Z,J,$,tt,et,nt,rt,at,ot,it,ct,ut,st,lt,dt,ft,pt,ht,bt,mt,vt,gt,yt,Ot,St,Nt,Ct,It,Et,At,Rt,_t,Ft,Dt,Mt,Pt,Lt,Bt,Vt,zt,Ut,Wt,Gt,Ht,qt,Kt,Xt,Yt,Qt,Zt,Jt,$t;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.op,t.next="If"===t.t0||"StatelessIf"===t.t0?3:"While"===t.t0||"StatelessWhile"===t.t0?15:"LoopCond"===t.t0?19:"Switch"===t.t0?21:"Merge"===t.t0?32:"Enter"===t.t0?37:"Exit"===t.t0?41:"NextIteration"===t.t0?44:"TensorArrayV3"===t.t0?47:"TensorArrayWriteV3"===t.t0?57:"TensorArrayReadV3"===t.t0?63:"TensorArrayGatherV3"===t.t0?67:"TensorArrayScatterV3"===t.t0?72:"TensorArrayConcatV3"===t.t0?78:"TensorArraySplitV3"===t.t0?82:"TensorArraySizeV3"===t.t0?88:"TensorArrayCloseV3"===t.t0?91:"TensorListSetItem"===t.t0?95:"TensorListGetItem"===t.t0?101:"TensorListScatterV2"===t.t0||"TensorListScatter"===t.t0?107:"TensorListReserve"===t.t0||"EmptyTensorList"===t.t0?114:"TensorListGather"===t.t0?121:"TensorListStack"===t.t0?127:"TensorListFromTensor"===t.t0?133:"TensorListConcat"===t.t0?139:"TensorListPushBack"===t.t0?144:"TensorListPopBack"===t.t0?149:"TensorListSplit"===t.t0?154:160;break;case 3:return a=Object(p.d)("thenBranch",e,n,r),i=Object(p.d)("elseBranch",e,n,r),c=Object(p.d)("cond",e,n,r),u=Object(p.d)("args",e,n,r),t.next=9,c.data();case 9:if(!t.sent[0]){t.next=14;break}return t.abrupt("return",r.functionMap[a].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 14:return t.abrupt("return",r.functionMap[i].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 15:return t.delegateYield(o.a.mark((function t(){var a,i,c,u,s,l,d,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(p.d)("body",e,n,r),i=Object(p.d)("cond",e,n,r),c=Object(p.d)("args",e,n,r),t.next=5,r.functionMap[i].executeFunctionAsync(c,r.tensorArrayMap,r.tensorListMap);case 5:return u=t.sent,s=c.map((function(t){return t.id})),t.next=9,u[0].data();case 9:l=t.sent,u.forEach((function(t){t.kept||-1!==s.indexOf(t.id)||t.dispose()})),d=c,f=o.a.mark((function t(){var e,n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=d,t.next=3,r.functionMap[a].executeFunctionAsync(d,r.tensorArrayMap,r.tensorListMap);case 3:return d=t.sent,n=d.map((function(t){return t.id})),e.forEach((function(t){t.kept||-1!==s.indexOf(t.id)||-1!==n.indexOf(t.id)||t.dispose()})),t.next=8,r.functionMap[i].executeFunctionAsync(d,r.tensorArrayMap,r.tensorListMap);case 8:return c=t.sent,t.next=11,c[0].data();case 11:l=t.sent,c.forEach((function(t){t.kept||-1!==s.indexOf(t.id)||-1!==n.indexOf(t.id)||t.dispose()}));case 13:case"end":return t.stop()}}),t)}));case 13:if(!l[0]){t.next=17;break}return t.delegateYield(f(),"t0",15);case 15:t.next=13;break;case 17:return t.abrupt("return",{v:d});case 18:case"end":return t.stop()}}),t)}))(),"t1",16);case 16:if("object"!==typeof(l=t.t1)){t.next=19;break}return t.abrupt("return",l.v);case 19:return d=Object(p.d)("pred",e,n,r),t.abrupt("return",[Object(p.a)(d)]);case 21:return f=Object(p.d)("pred",e,n,r),(h=Object(p.d)("data",e,n,r)).kept||(h=Object(p.a)(h)),t.next=26,f.data();case 26:if(!t.sent[0]){t.next=30;break}t.t2=[void 0,h],t.next=31;break;case 30:t.t2=[h,void 0];case 31:return t.abrupt("return",t.t2);case 32:if(!(b=e.inputNames.find((function(t){return void 0!==Object(p.e)(t,n,r)})))){t.next=36;break}return m=Object(p.e)(b,n,r),t.abrupt("return",[Object(p.a)(m)]);case 36:return t.abrupt("return",void 0);case 37:return v=Object(p.d)("frameName",e,n,r),g=Object(p.d)("tensor",e,n,r),r.enterFrame(v),t.abrupt("return",[Object(p.a)(g)]);case 41:return y=Object(p.d)("tensor",e,n,r),r.exitFrame(),t.abrupt("return",[Object(p.a)(y)]);case 44:return x=Object(p.d)("tensor",e,n,r),r.nextIteration(),t.abrupt("return",[Object(p.a)(x)]);case 47:return O=Object(p.d)("size",e,n,r),w=Object(p.d)("dtype",e,n,r),k=Object(p.d)("elementShape",e,n,r),j=Object(p.d)("dynamicSize",e,n,r),T=Object(p.d)("clearAfterRead",e,n,r),S=Object(p.d)("identicalElementShapes",e,n,r),N=Object(p.d)("name",e,n,r),C=new xt(N,w,O,k,S,j,T),r.addTensorArray(C),t.abrupt("return",[C.idTensor,Object(s.scalar)(1)]);case 57:return I=Object(p.d)("tensorArrayId",e,n,r),E=Object(p.d)("index",e,n,r),A=Object(p.d)("tensor",e,n,r),(R=r.getTensorArray(I.id)).write(E,A),t.abrupt("return",[R.idTensor]);case 63:return _=Object(p.d)("tensorArrayId",e,n,r),F=Object(p.d)("index",e,n,r),D=r.getTensorArray(_.id),t.abrupt("return",[D.read(F)]);case 67:return M=Object(p.d)("tensorArrayId",e,n,r),P=Object(p.d)("indices",e,n,r),L=Object(p.d)("dtype",e,n,r),B=r.getTensorArray(M.id),t.abrupt("return",[B.gather(P,L)]);case 72:return V=Object(p.d)("tensorArrayId",e,n,r),z=Object(p.d)("indices",e,n,r),U=Object(p.d)("tensor",e,n,r),(W=r.getTensorArray(V.id)).scatter(z,U),t.abrupt("return",[W.idTensor]);case 78:return G=Object(p.d)("tensorArrayId",e,n,r),H=r.getTensorArray(G.id),q=Object(p.d)("dtype",e,n,r),t.abrupt("return",[H.concat(q)]);case 82:return K=Object(p.d)("tensorArrayId",e,n,r),X=Object(p.d)("tensor",e,n,r),Y=Object(p.d)("lengths",e,n,r),(Q=r.getTensorArray(K.id)).split(Y,X),t.abrupt("return",[Q.idTensor]);case 88:return Z=Object(p.d)("tensorArrayId",e,n,r),J=r.getTensorArray(Z.id),t.abrupt("return",[Object(s.scalar)(J.size(),"int32")]);case 91:return $=Object(p.d)("tensorArrayId",e,n,r),(tt=r.getTensorArray($.id)).clearAndClose(),t.abrupt("return",[tt.idTensor]);case 95:return et=Object(p.d)("tensorListId",e,n,r),nt=Object(p.d)("index",e,n,r),rt=Object(p.d)("tensor",e,n,r),(at=r.getTensorList(et.id)).setItem(nt,rt),t.abrupt("return",[at.idTensor]);case 101:return ot=Object(p.d)("tensorListId",e,n,r),it=Object(p.d)("index",e,n,r),ct=Object(p.d)("elementShape",e,n,r),ut=Object(p.d)("elementDType",e,n,r),st=r.getTensorList(ot.id),t.abrupt("return",[st.getItem(it,ct,ut)]);case 107:return lt=Object(p.d)("indices",e,n,r),dt=Object(p.d)("tensor",e,n,r),ft=Object(p.d)("elementShape",e,n,r),pt=Object(p.d)("numElements",e,n,r),ht=jt(dt,lt,ft,pt),r.addTensorList(ht),t.abrupt("return",[ht.idTensor]);case 114:return bt=Object(p.d)("elementShape",e,n,r),mt=Object(p.d)("elementDType",e,n,r),vt="TensorListReserve"===e.op?"numElements":"maxNumElements",gt=Object(p.d)(vt,e,n,r),yt=kt(bt,mt,gt),r.addTensorList(yt),t.abrupt("return",[yt.idTensor]);case 121:return Ot=Object(p.d)("tensorListId",e,n,r),St=Object(p.d)("indices",e,n,r),Nt=Object(p.d)("elementShape",e,n,r),Ct=Object(p.d)("elementDType",e,n,r),It=r.getTensorList(Ot.id),t.abrupt("return",[It.gather(St,Ct,Nt)]);case 127:return Et=Object(p.d)("tensorListId",e,n,r),At=Object(p.d)("elementShape",e,n,r),Rt=Object(p.d)("elementDType",e,n,r),_t=Object(p.d)("numElements",e,n,r),Ft=r.getTensorList(Et.id),t.abrupt("return",[Ft.stack(At,Rt,_t)]);case 133:return Dt=Object(p.d)("tensor",e,n,r),Mt=Object(p.d)("elementShape",e,n,r),Pt=Object(p.d)("elementDType",e,n,r),Lt=wt(Dt,Mt,Pt),r.addTensorList(Lt),t.abrupt("return",[Lt.idTensor]);case 139:return Bt=Object(p.d)("tensorListId",e,n,r),Vt=r.getTensorList(Bt.id),zt=Object(p.d)("dtype",e,n,r),Ut=Object(p.d)("elementShape",e,n,r),t.abrupt("return",[Vt.concat(zt,Ut)]);case 144:return Wt=Object(p.d)("tensorListId",e,n,r),Gt=Object(p.d)("tensor",e,n,r),(Ht=r.getTensorList(Wt.id)).pushBack(Gt),t.abrupt("return",[Ht.idTensor]);case 149:return qt=Object(p.d)("tensorListId",e,n,r),Kt=Object(p.d)("elementShape",e,n,r),Xt=Object(p.d)("elementDType",e,n,r),Yt=r.getTensorList(qt.id),t.abrupt("return",[Yt.popBack(Kt,Xt)]);case 154:return Qt=Object(p.d)("tensor",e,n,r),Zt=Object(p.d)("elementShape",e,n,r),Jt=Object(p.d)("lengths",e,n,r),$t=Tt(Qt,Jt,Zt),r.addTensorList($t),t.abrupt("return",[$t.idTensor]);case 160:throw TypeError("Node type ".concat(e.op," is not implemented"));case 161:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),Nt=n(251),Ct=n(140),It=n(133),Et=n(252),At=n(157),Rt=n(254),_t=n(188),Ft=n(205),Dt=n(271),Mt=n(248),Pt=n(270),Lt=n(260);function Bt(t,e,n){var r=Object(p.d)("fusedOps",t,e,n),a=Object(d.a)(r,2),o=a[0],i=a[1],c="biasadd"===o,u=!c,s="prelu"===i,l="fusedbatchnorm"===o,f=Object(p.d)("numArgs",t,e,n);if(c){if(s&&2!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&c&&1!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var h=Object(p.d)("strides",t,e,n),b=Object(p.c)(t,e,n),m=Object(p.d)("dataFormat",t,e,n).toUpperCase(),v=Object(p.d)("dilations",t,e,n),g=Object(p.d)("args",t,e,n),y=Object(d.a)(g,2),x=y[0],O=y[1];return u&&(O=x,x=void 0),{stride:h,pad:b,dataFormat:m,dilations:v,biasArg:x,preluArg:O,activationFunc:i,leakyreluAlpha:Object(p.d)("leakyreluAlpha",t,e,n)}}var Vt=n(137),zt=n(267),Ut=n(274),Wt=n(209),Gt=n(163),Ht=n(275),qt=n(213),Kt=n(165),Xt=n(288),Yt=n(143),Qt=n(106),Zt=n(88),Jt=n(220),$t=n(280);function te(t,e,n){return{boxes:Object(p.d)("boxes",t,e,n),scores:Object(p.d)("scores",t,e,n),maxOutputSize:Object(p.d)("maxOutputSize",t,e,n),iouThreshold:Object(p.d)("iouThreshold",t,e,n),scoreThreshold:Object(p.d)("scoreThreshold",t,e,n),softNmsSigma:Object(p.d)("softNmsSigma",t,e,n)}}var ee=function(){var t=Object(i.a)(o.a.mark((function t(e,n,r){var a,i,c,u,s,l,d,f,h,b,m,v,g,y,x,O,w,k,j,T,S,N,C,I;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.op,t.next="NonMaxSuppressionV5"===t.t0?3:"NonMaxSuppressionV4"===t.t0?8:"NonMaxSuppressionV3"===t.t0||"NonMaxSuppressionV2"===t.t0?14:"Where"===t.t0?19:"ListDiff"===t.t0?26:27;break;case 3:return a=te(e,n,r),i=a.boxes,c=a.scores,u=a.maxOutputSize,s=a.iouThreshold,l=a.scoreThreshold,d=a.softNmsSigma,t.next=6,It.xb.nonMaxSuppressionWithScoreAsync(i,c,u,s,l,d);case 6:return f=t.sent,t.abrupt("return",[f.selectedIndices,f.selectedScores]);case 8:return h=te(e,n,r),b=h.boxes,m=h.scores,v=h.maxOutputSize,g=h.iouThreshold,y=h.scoreThreshold,x=Object(p.d)("padToMaxOutputSize",e,n,r),t.next=12,It.xb.nonMaxSuppressionPaddedAsync(b,m,v,g,y,x);case 12:return O=t.sent,t.abrupt("return",[O.selectedIndices,O.validOutputs]);case 14:return w=te(e,n,r),k=w.boxes,j=w.scores,T=w.maxOutputSize,S=w.iouThreshold,N=w.scoreThreshold,t.next=17,It.xb.nonMaxSuppressionAsync(k,j,T,S,N);case 17:return t.t1=t.sent,t.abrupt("return",[t.t1]);case 19:return C=Zt.a(Object(p.d)("condition",e,n,r),"bool"),t.next=22,Jt.a(C);case 22:return t.t2=t.sent,I=[t.t2],C.dispose(),t.abrupt("return",I);case 26:return t.abrupt("return",$t.a(Object(p.d)("x",e,n,r),Object(p.d)("y",e,n,r)));case 27:throw TypeError("Node type ".concat(e.op," is not implemented"));case 28:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),ne=n(287),re=n(289),ae=n(118),oe=n(87),ie=function(){function t(e,n){Object(c.a)(this,t),this.keyDType=e,this.valueDType=n,this.handle=Object(s.scalar)(0),this.tensorMap=new Map,Object(s.keep)(this.handle)}return Object(u.a)(t,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return oe.a(this.size(),"int32")}},{key:"import",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.checkKeyAndValueTensor(e,n),t.next=3,e.data();case 3:return r=t.sent,this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),t.abrupt("return",Object(s.tidy)((function(){var t=Object(s.unstack)(n),e=r.length,o=t.length;s.util.assert(e===o,(function(){return"The number of elements doesn't match, keys has "+"".concat(e," elements, the values has ").concat(o," ")+"elements."}));for(var i=0;i<e;i++){var c=r[i],u=t[i];Object(s.keep)(u),a.tensorMap.set(c,u)}return a.handle})));case 7:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"find",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.checkKeyAndValueTensor(e,n),t.next=3,e.data();case 3:return r=t.sent,t.abrupt("return",Object(s.tidy)((function(){for(var t=[],e=0;e<r.length;e++){var o=r[e],i=a.findWithDefault(o,n);t.push(i)}return Object(s.stack)(t)})));case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"findWithDefault",value:function(t,e){var n=this.tensorMap.get(t);return null!=n?n:e}},{key:"checkKeyAndValueTensor",value:function(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))}}]),t}(),ce=function(){var t=Object(i.a)(o.a.mark((function t(e,n,r,a){var i,c,u,s,l,d,f,h,b,m,v,g,y;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.op,t.next="HashTable"===t.t0||"HashTableV2"===t.t0?3:"LookupTableImport"===t.t0||"LookupTableImportV2"===t.t0?8:"LookupTableFind"===t.t0||"LookupTableFindV2"===t.t0?16:"LookupTableSize"===t.t0||"LookupTableSizeV2"===t.t0?24:27;break;case 3:return i=Object(p.d)("keyDType",e,n,r),c=Object(p.d)("valueDType",e,n,r),u=new ie(i,c),a.addHashTable(e.name,u),t.abrupt("return",[u.handle]);case 8:return s=Object(p.d)("tableHandle",e,n,r,a),l=Object(p.d)("keys",e,n,r),d=Object(p.d)("values",e,n,r),f=a.getHashTableById(s.id),t.next=14,f.import(l,d);case 14:return t.t1=t.sent,t.abrupt("return",[t.t1]);case 16:return h=Object(p.d)("tableHandle",e,n,r,a),b=Object(p.d)("keys",e,n,r),m=Object(p.d)("defaultValue",e,n,r),v=a.getHashTableById(h.id),t.next=22,v.find(b,m);case 22:return t.t2=t.sent,t.abrupt("return",[t.t2]);case 24:return g=Object(p.d)("tableHandle",e,n,r,a),y=a.getHashTableById(g.id),t.abrupt("return",[y.tensorSize()]);case 27:throw TypeError("Node type ".concat(e.op," is not implemented"));case 28:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),ue=n(193),se=n(208),le=n(158),de=n(199),fe=n(266),pe=n(160),he=n(161),be=n(203),me=n(204),ve=n(126),ge=n(108),ye=n(262),xe=n(172),Oe=n(150),we=n(268),ke=n(284),je=n(269),Te=n(318),Se=n(142),Ne=n(162),Ce=n(206),Ie=n(100),Ee=n(239),Ae=n(240),Re=n(241),_e=n(242),Fe=n(257),De=n(191),Me=n(258),Pe=n(99),Le=n(198),Be=n(117),Ve=n(95),ze=n(285),Ue=n(170),We=n(74),Ge=n(146),He=n(171),qe=n(196),Ke=n(145),Xe=n(290),Ye=n(291),Qe=n(167),Ze=n(168),Je=n(169),$e=n(216),tn=n(195),en=n(272),nn=n(129),rn=n(210),an=n(190),on=n(259),cn=n(192);function un(t,e,n,a){var o=function(t,e,n){switch(t.category){case"arithmetic":return s.tidy((function(){return function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[m.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"AddN":return[v.a(Object(p.d)("tensors",t,e,n))];case"FloorMod":case"Mod":return[g.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Mul":return[y.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"RealDiv":case"Div":return[x.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"DivNoNan":return[O.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"FloorDiv":return[w.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Sub":return[k.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Minimum":return[j.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Maximum":return[T.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Pow":return[S.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"SquaredDifference":return[N.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"basic_math":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[C.a(Object(p.d)("x",t,e,n))];case"Acos":return[I.a(Object(p.d)("x",t,e,n))];case"Acosh":return[E.a(Object(p.d)("x",t,e,n))];case"Asin":return[A.a(Object(p.d)("x",t,e,n))];case"Asinh":return[R.a(Object(p.d)("x",t,e,n))];case"Atan":return[_.a(Object(p.d)("x",t,e,n))];case"Atan2":return[F.a(Object(p.d)("x",t,e,n),Object(p.d)("y",t,e,n))];case"Atanh":return[D.a(Object(p.d)("x",t,e,n))];case"Ceil":return[M.a(Object(p.d)("x",t,e,n))];case"Complex":return[P.a(Object(p.d)("real",t,e,n),Object(p.d)("imag",t,e,n))];case"Cos":return[L.a(Object(p.d)("x",t,e,n))];case"Cosh":return[B.a(Object(p.d)("x",t,e,n))];case"Elu":return[V.a(Object(p.d)("x",t,e,n))];case"Erf":return[z.a(Object(p.d)("x",t,e,n))];case"Exp":return[U.a(Object(p.d)("x",t,e,n))];case"Expm1":return[W.a(Object(p.d)("x",t,e,n))];case"Floor":return[G.a(Object(p.d)("x",t,e,n))];case"Log":return[H.a(Object(p.d)("x",t,e,n))];case"Log1p":return[q.a(Object(p.d)("x",t,e,n))];case"Imag":return[K.a(Object(p.d)("x",t,e,n))];case"Neg":return[X.a(Object(p.d)("x",t,e,n))];case"Reciprocal":return[Y.a(Object(p.d)("x",t,e,n))];case"Real":return[Q.a(Object(p.d)("x",t,e,n))];case"Relu":return[Z.a(Object(p.d)("x",t,e,n))];case"Round":return[J.a(Object(p.d)("x",t,e,n))];case"Selu":return[$.a(Object(p.d)("x",t,e,n))];case"Sigmoid":return[tt.a(Object(p.d)("x",t,e,n))];case"Sin":return[et.a(Object(p.d)("x",t,e,n))];case"Sign":return[nt.a(Object(p.d)("x",t,e,n))];case"Sinh":return[rt.a(Object(p.d)("x",t,e,n))];case"Softplus":return[at.a(Object(p.d)("x",t,e,n))];case"Sqrt":return[ot.a(Object(p.d)("x",t,e,n))];case"Square":return[it.a(Object(p.d)("x",t,e,n))];case"Tanh":return[ct.a(Object(p.d)("x",t,e,n))];case"Tan":return[ut.a(Object(p.d)("x",t,e,n))];case"ClipByValue":return[st.a(Object(p.d)("x",t,e,n),Object(p.d)("clipValueMin",t,e,n),Object(p.d)("clipValueMax",t,e,n))];case"Relu6":return[lt.a(Object(p.d)("x",t,e,n))];case"Rsqrt":return[dt.a(Object(p.e)(t.inputNames[0],e,n))];case"Prod":return[ft.a(Object(p.d)("x",t,e,n),Object(p.d)("axes",t,e,n))];case"LeakyRelu":return[pt.a(Object(p.d)("x",t,e,n),Object(p.d)("alpha",t,e,n))];case"Prelu":return[ht.a(Object(p.d)("x",t,e,n),Object(p.d)("alpha",t,e,n))];case"IsNan":return[bt.a(Object(p.e)(t.inputNames[0],e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"control":return St(t,e,n);case"convolution":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Conv1D":var r=Object(p.d)("stride",t,e,n),a=Object(p.d)("pad",t,e,n),o=Object(p.d)("dataFormat",t,e,n).toUpperCase(),i=Object(p.d)("dilation",t,e,n);return[Nt.a(Object(p.d)("x",t,e,n),Object(p.d)("filter",t,e,n),r,a,o,i)];case"Conv2D":var c=Object(p.d)("strides",t,e,n),u=Object(p.c)(t,e,n),s=Object(p.d)("dataFormat",t,e,n).toUpperCase(),l=Object(p.d)("dilations",t,e,n);return[Ct.a(Object(p.d)("x",t,e,n),Object(p.d)("filter",t,e,n),[c[1],c[2]],u,s,[l[1],l[2]])];case"_FusedConv2D":var d=Bt(t,e,n),f=d.stride,h=d.pad,b=d.dataFormat,m=d.dilations,v=d.biasArg,g=d.preluArg,y=d.activationFunc,x=d.leakyreluAlpha;return[It.qb.conv2d({x:Object(p.d)("x",t,e,n),filter:Object(p.d)("filter",t,e,n),strides:[f[1],f[2]],pad:h,dataFormat:b,dilations:[m[1],m[2]],bias:v,activation:y,preluActivationWeights:g,leakyreluAlpha:x})];case"FusedDepthwiseConv2dNative":var O=Bt(t,e,n),w=O.stride,k=O.pad,j=O.dataFormat,T=O.dilations,S=O.biasArg,N=O.preluArg,C=O.activationFunc,I=O.leakyreluAlpha;return[It.qb.depthwiseConv2d({x:Object(p.d)("x",t,e,n),filter:Object(p.d)("filter",t,e,n),strides:[w[1],w[2]],pad:k,dataFormat:j,dilations:[T[1],T[2]],bias:S,activation:C,preluActivationWeights:N,leakyreluAlpha:I})];case"Conv2DBackpropInput":case"Conv2dTranspose":var E=Object(p.d)("outputShape",t,e,n),A=Object(p.d)("strides",t,e,n),R=Object(p.c)(t,e,n);return[Et.a(Object(p.d)("x",t,e,n),Object(p.d)("filter",t,e,n),E,[A[1],A[2]],R)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var _=Object(p.d)("strides",t,e,n),F=Object(p.c)(t,e,n),D=Object(p.d)("dilations",t,e,n),M=Object(p.d)("dataFormat",t,e,n).toUpperCase();return[At.a(Object(p.d)("input",t,e,n),Object(p.d)("filter",t,e,n),[_[1],_[2]],F,M,[D[1],D[2]])];case"Conv3D":var P=Object(p.d)("strides",t,e,n),L=Object(p.d)("pad",t,e,n),B=Object(p.d)("dataFormat",t,e,n).toUpperCase(),V=Object(p.d)("dilations",t,e,n);return[Rt.a(Object(p.d)("x",t,e,n),Object(p.d)("filter",t,e,n),[P[1],P[2],P[3]],L,B,[V[1],V[2],V[3]])];case"AvgPool":var z=Object(p.d)("strides",t,e,n),U=Object(p.d)("pad",t,e,n),W=Object(p.d)("kernelSize",t,e,n);return[_t.a(Object(p.d)("x",t,e,n),[W[1],W[2]],[z[1],z[2]],U)];case"MaxPool":var G=Object(p.d)("strides",t,e,n),H=Object(p.d)("pad",t,e,n),q=Object(p.d)("kernelSize",t,e,n);return[Ft.a(Object(p.d)("x",t,e,n),[q[1],q[2]],[G[1],G[2]],H)];case"MaxPoolWithArgmax":var K=Object(p.d)("strides",t,e,n),X=Object(p.d)("pad",t,e,n),Y=Object(p.d)("kernelSize",t,e,n),Q=Object(p.d)("includeBatchInIndex",t,e,n),Z=Dt.a(Object(p.d)("x",t,e,n),[Y[1],Y[2]],[K[1],K[2]],X,Q);return[Z.result,Z.indexes];case"AvgPool3D":var J=Object(p.d)("strides",t,e,n),$=Object(p.d)("pad",t,e,n),tt=Object(p.d)("kernelSize",t,e,n);return[Mt.a(Object(p.d)("x",t,e,n),[tt[1],tt[2],tt[3]],[J[1],J[2],J[3]],$)];case"MaxPool3D":var et=Object(p.d)("strides",t,e,n),nt=Object(p.d)("pad",t,e,n),rt=Object(p.d)("kernelSize",t,e,n);return[Pt.a(Object(p.d)("x",t,e,n),[rt[1],rt[2],rt[3]],[et[1],et[2],et[3]],nt)];case"Dilation2D":var at=Object(p.d)("strides",t,e,n),ot=Object(p.d)("pad",t,e,n),it=Object(p.d)("dilations",t,e,n),ct=at[1],ut=at[2],st=it[1],lt=it[2];return[Lt.a(Object(p.d)("x",t,e,n),Object(p.d)("filter",t,e,n),[ct,ut],ot,[st,lt],"NHWC")];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"creation":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Fill":var r=Object(p.d)("shape",t,e,n),a=Object(p.d)("dtype",t,e,n),o=Object(p.d)("value",t,e,n);return[Vt.a(r,o,a)];case"LinSpace":var i=Object(p.d)("start",t,e,n),c=Object(p.d)("stop",t,e,n),u=Object(p.d)("num",t,e,n);return[zt.a(i,c,u)];case"Multinomial":var s=Object(p.d)("logits",t,e,n),l=Object(p.d)("numSamples",t,e,n),d=Object(p.d)("seed",t,e,n);return[Ut.a(s,l,d)];case"OneHot":var f=Object(p.d)("indices",t,e,n),h=Object(p.d)("depth",t,e,n),b=Object(p.d)("onValue",t,e,n),m=Object(p.d)("offValue",t,e,n);return[Wt.a(f,h,b,m)];case"Ones":return[Gt.a(Object(p.d)("shape",t,e,n),Object(p.d)("dtype",t,e,n))];case"OnesLike":return[Ht.a(Object(p.d)("x",t,e,n))];case"RandomUniform":return[qt.a(Object(p.d)("shape",t,e,n),Object(p.d)("minval",t,e,n),Object(p.d)("maxval",t,e,n),Object(p.d)("dtype",t,e,n))];case"Range":var v=Object(p.d)("start",t,e,n),g=Object(p.d)("stop",t,e,n),y=Object(p.d)("step",t,e,n);return[Kt.a(v,g,y,Object(p.d)("dtype",t,e,n))];case"TruncatedNormal":var x=Object(p.d)("shape",t,e,n),O=Object(p.d)("mean",t,e,n),w=Object(p.d)("stdDev",t,e,n),k=Object(p.d)("seed",t,e,n);return[Xt.a(x,O,w,Object(p.d)("dtype",t,e,n),k)];case"Zeros":return[Yt.a(Object(p.d)("shape",t,e,n),Object(p.d)("dtype",t,e,n))];case"ZerosLike":return[Qt.a(Object(p.d)("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"dynamic":return ee(t,e,n);case"evaluation":return s.tidy((function(){return function(t,e,n){switch(t.op){case"TopKV2":var r=Object(p.d)("x",t,e,n),a=Object(p.d)("k",t,e,n),o=Object(p.d)("sorted",t,e,n),i=ne.a(r,a,o);return[i.values,i.indices];case"Unique":var c=Object(p.d)("x",t,e,n),u=re.a(c);return[u.values,u.indices];case"UniqueV2":var s=Object(p.d)("x",t,e,n),l=Object(p.d)("axis",t,e,n),d=re.a(s,l);return[d.values,d.indices];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"image":return s.tidy((function(){return function(t,e,n){switch(t.op){case"ResizeBilinear":var r=Object(p.d)("images",t,e,n),a=Object(p.d)("size",t,e,n),o=Object(p.d)("alignCorners",t,e,n),i=Object(p.d)("halfPixelCenters",t,e,n);return[It.xb.resizeBilinear(r,[a[0],a[1]],o,i)];case"ResizeNearestNeighbor":var c=Object(p.d)("images",t,e,n),u=Object(p.d)("size",t,e,n),s=Object(p.d)("alignCorners",t,e,n),l=Object(p.d)("halfPixelCenters",t,e,n);return[It.xb.resizeNearestNeighbor(c,[u[0],u[1]],s,l)];case"CropAndResize":var d=Object(p.d)("image",t,e,n),f=Object(p.d)("boxes",t,e,n),h=Object(p.d)("boxInd",t,e,n),b=Object(p.d)("cropSize",t,e,n),m=Object(p.d)("method",t,e,n),v=Object(p.d)("extrapolationValue",t,e,n);return[It.xb.cropAndResize(d,f,h,b,m,v)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"graph":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=Object(p.d)("default",t,e,n);return[Object(p.e)(t.name,e,n)||r];case"Placeholder":return[Object(p.e)(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":var a=Object(p.d)("x",t,e,n);return[Object(p.a)(a)];case"IdentityN":return Object(p.d)("x",t,e,n).map((function(t){return Object(p.a)(t)}));case"Snapshot":var o=Object(p.d)("x",t,e,n);return[Object(p.a)(o)];case"Shape":return[ae.a(Object(p.d)("x",t,e,n).shape,"int32")];case"ShapeN":return Object(p.d)("x",t,e,n).map((function(t){return ae.a(t.shape)}));case"Size":return[oe.a(Object(p.d)("x",t,e,n).size,"int32")];case"Rank":return[oe.a(Object(p.d)("x",t,e,n).rank,"int32")];case"NoOp":return[oe.a(1)];case"Print":var i=Object(p.d)("x",t,e,n),c=Object(p.d)("data",t,e,n),u=Object(p.d)("message",t,e,n),s=Object(p.d)("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(var l=0;l<c.length;l++)console.log(Array.prototype.slice.call(c[l].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"logical":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Equal":return[ue.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"NotEqual":return[se.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Greater":return[le.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"GreaterEqual":return[de.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Less":return[fe.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"LessEqual":return[pe.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"LogicalAnd":return[he.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"LogicalNot":return[be.a(Object(p.d)("a",t,e,n))];case"LogicalOr":return[me.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];case"Select":case"SelectV2":return[ve.a(Object(p.d)("condition",t,e,n),Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"matrices":return s.tidy((function(){return function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[ge.a(Object(p.d)("a",t,e,n),Object(p.d)("b",t,e,n),Object(p.d)("transposeA",t,e,n),Object(p.d)("transposeB",t,e,n))];case"Einsum":return[ye.a.apply(r,[Object(p.d)("equation",t,e,n)].concat(Object(f.a)(Object(p.d)("tensors",t,e,n))))];case"Transpose":return[xe.a(Object(p.d)("x",t,e,n),Object(p.d)("perm",t,e,n))];case"_FusedMatMul":var a=Object(p.d)("fusedOps",t,e,n),o=Object(d.a)(a,2),i=o[0],c=o[1],u="biasadd"===i,s="prelu"===c,l=Object(p.d)("numArgs",t,e,n),h=Object(p.d)("leakyreluAlpha",t,e,n);if(u){if(s&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var b=Object(p.d)("args",t,e,n),m=Object(d.a)(b,2),v=m[0],g=m[1];return[It.qb.matMul({a:Object(p.d)("a",t,e,n),b:Object(p.d)("b",t,e,n),transposeA:Object(p.d)("transposeA",t,e,n),transposeB:Object(p.d)("transposeB",t,e,n),bias:v,activation:c,preluActivationWeights:g,leakyreluAlpha:h})];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"normalization":return s.tidy((function(){return function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Oe.a(Object(p.d)("x",t,e,n),Object(p.d)("mean",t,e,n),Object(p.d)("variance",t,e,n),Object(p.d)("offset",t,e,n),Object(p.d)("scale",t,e,n),Object(p.d)("epsilon",t,e,n))];case"LRN":return[we.a(Object(p.d)("x",t,e,n),Object(p.d)("radius",t,e,n),Object(p.d)("bias",t,e,n),Object(p.d)("alpha",t,e,n),Object(p.d)("beta",t,e,n))];case"Softmax":return[ke.a(Object(p.d)("x",t,e,n))];case"LogSoftmax":return[je.a(Object(p.d)("x",t,e,n))];case"SparseToDense":return[Te.a(Object(p.d)("sparseIndices",t,e,n),Object(p.d)("outputShape",t,e,n),Object(p.d)("sparseValues",t,e,n),Object(p.d)("defaultValue",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"reduction":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Max":var r=Object(p.d)("axis",t,e,n),a=Object(p.d)("keepDims",t,e,n);return[Se.a(Object(p.d)("x",t,e,n),r,a)];case"Mean":var o=Object(p.d)("axis",t,e,n),i=Object(p.d)("keepDims",t,e,n);return[Ne.a(Object(p.d)("x",t,e,n),o,i)];case"Min":var c=Object(p.d)("axis",t,e,n),u=Object(p.d)("keepDims",t,e,n);return[Ce.a(Object(p.d)("x",t,e,n),c,u)];case"Sum":var s=Object(p.d)("axis",t,e,n),l=Object(p.d)("keepDims",t,e,n);return[Ie.a(Object(p.d)("x",t,e,n),s,l)];case"All":var d=Object(p.d)("axis",t,e,n),f=Object(p.d)("keepDims",t,e,n);return[Ee.a(Object(p.d)("x",t,e,n),d,f)];case"Any":var h=Object(p.d)("axis",t,e,n),b=Object(p.d)("keepDims",t,e,n);return[Ae.a(Object(p.d)("x",t,e,n),h,b)];case"ArgMax":var m=Object(p.d)("axis",t,e,n);return[Re.a(Object(p.d)("x",t,e,n),m)];case"ArgMin":var v=Object(p.d)("axis",t,e,n);return[_e.a(Object(p.d)("x",t,e,n),v)];case"Prod":var g=Object(p.d)("axis",t,e,n),y=Object(p.d)("keepDims",t,e,n);return[ft.a(Object(p.d)("x",t,e,n),g,y)];case"Cumsum":var x=Object(p.d)("axis",t,e,n),O=Object(p.d)("exclusive",t,e,n),w=Object(p.d)("reverse",t,e,n);return[Fe.a(Object(p.d)("x",t,e,n),x,O,w)];case"Bincount":var k=Object(p.d)("x",t,e,n),j=Object(p.d)("weights",t,e,n),T=Object(p.d)("size",t,e,n);return[De.a(k,j,T)];case"DenseBincount":var S=Object(p.d)("x",t,e,n),N=Object(p.d)("weights",t,e,n),C=Object(p.d)("size",t,e,n),I=Object(p.d)("binaryOutput",t,e,n);return[Me.a(S,N,C,I)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"slice_join":return s.tidy((function(){return function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=Object(p.d)("n",t,e,n),a=Object(p.d)("axis",t,e,n),o=Object(p.d)("tensors",t,e,n);return o=o.slice(0,r),[Pe.a(o,a)];case"Gather":var i=Object(p.d)("x",t,e,n),c=Object(p.d)("indices",t,e,n);return[Le.a(i,Zt.a(c,"int32"),0)];case"GatherV2":var u=Object(p.d)("axis",t,e,n),l=Object(p.d)("batchDims",t,e,n),d=Object(p.d)("x",t,e,n),f=Object(p.d)("indices",t,e,n);return[Le.a(d,Zt.a(f,"int32"),u,l)];case"Reverse":for(var h=Object(p.d)("dims",t,e,n),b=[],m=0;m<h.length;m++)h[m]&&b.push(m);var v=Object(p.d)("x",t,e,n);return[Be.a(v,b)];case"ReverseV2":var g=Object(p.d)("axis",t,e,n),y=Object(p.d)("x",t,e,n);return[Be.a(y,g)];case"Slice":var x=Object(p.d)("begin",t,e,n),O=Object(p.d)("size",t,e,n);return[Ve.a(Object(p.d)("x",t,e,n),x,O)];case"StridedSlice":var w=Object(p.d)("begin",t,e,n),k=Object(p.d)("end",t,e,n),j=Object(p.d)("strides",t,e,n),T=Object(p.d)("beginMask",t,e,n),S=Object(p.d)("endMask",t,e,n),N=Object(p.d)("ellipsisMask",t,e,n),C=Object(p.d)("newAxisMask",t,e,n),I=Object(p.d)("shrinkAxisMask",t,e,n),E=Object(p.d)("x",t,e,n);return[ze.a(E,w,k,j,T,S,N,C,I)];case"Pack":return Object(s.tidy)((function(){var r=Object(p.d)("axis",t,e,n),a=Object(p.d)("tensors",t,e,n),o=a[0].shape,i=Ue.a(a[0]).shape,c=a.map((function(t){var e=s.util.arraysEqual(t.shape,o);if(!e&&!s.util.arraysEqual(Ue.a(t).shape,i))throw new Error("the input tensors shape does not match");return e?t:We.a(t,o)}));return[Ge.a(c,r)]}));case"Unpack":var A=Object(p.d)("axis",t,e,n),R=Object(p.d)("tensor",t,e,n);return He.a(R,A);case"Tile":var _=Object(p.d)("reps",t,e,n);return[qe.a(Object(p.d)("x",t,e,n),_)];case"Split":case"SplitV":var F=Object(p.d)("axis",t,e,n),D=Object(p.d)("numOrSizeSplits",t,e,n),M=Object(p.d)("x",t,e,n);return Ke.a(M,D,F);case"ScatterNd":var P=Object(p.d)("indices",t,e,n),L=Object(p.d)("values",t,e,n),B=Object(p.d)("shape",t,e,n);return[Xe.a(P,L,B)];case"GatherNd":var V=Object(p.d)("x",t,e,n),z=Object(p.d)("indices",t,e,n);return[Ye.a(V,z)];case"SparseToDense":var U=Object(p.d)("sparseIndices",t,e,n),W=Object(p.d)("outputShape",t,e,n),G=Object(p.d)("sparseValues",t,e,n),H=Object(p.d)("defaultValue",t,e,n);return[Te.a(U,G,W,G.dtype===H.dtype?H:Zt.a(H,G.dtype))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"sparse":return s.tidy((function(){return function(t,e,n){switch(t.op){case"SparseFillEmptyRows":var r=It.md.sparseFillEmptyRows(Object(p.d)("indices",t,e,n),Object(p.d)("values",t,e,n),Object(p.d)("denseShape",t,e,n),Object(p.d)("defaultValue",t,e,n));return[r.outputIndices,r.outputValues,r.emptyRowIndicator,r.reverseIndexMap];case"SparseReshape":var a=It.md.sparseReshape(Object(p.d)("inputIndices",t,e,n),Object(p.d)("inputShape",t,e,n),Object(p.d)("newShape",t,e,n));return[a.outputIndices,a.outputShape];case"SparseSegmentMean":return[It.md.sparseSegmentMean(Object(p.d)("data",t,e,n),Object(p.d)("indices",t,e,n),Object(p.d)("segmentIds",t,e,n))];case"SparseSegmentSum":return[It.md.sparseSegmentSum(Object(p.d)("data",t,e,n),Object(p.d)("indices",t,e,n),Object(p.d)("segmentIds",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"spectral":return s.tidy((function(){return function(t,e,n){switch(t.op){case"FFT":return[Qe.a(Object(p.d)("x",t,e,n))];case"IFFT":return[Ze.a(Object(p.d)("x",t,e,n))];case"RFFT":return[Je.a(Object(p.d)("x",t,e,n))];case"IRFFT":return[$e.a(Object(p.d)("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"string":return s.tidy((function(){return function(t,e,n){switch(t.op){case"StringNGrams":var r=It.xd.stringNGrams(Object(p.d)("data",t,e,n),Object(p.d)("dataSplits",t,e,n),Object(p.d)("separator",t,e,n),Object(p.d)("nGramWidths",t,e,n),Object(p.d)("leftPad",t,e,n),Object(p.d)("rightPad",t,e,n),Object(p.d)("padWidth",t,e,n),Object(p.d)("preserveShortSequences",t,e,n));return[r.nGrams,r.nGramsSplits];case"StringSplit":var a=It.xd.stringSplit(Object(p.d)("input",t,e,n),Object(p.d)("delimiter",t,e,n),Object(p.d)("skipEmpty",t,e,n));return[a.indices,a.values,a.shape];case"StringToHashBucketFast":return[It.xd.stringToHashBucketFast(Object(p.d)("input",t,e,n),Object(p.d)("numBuckets",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"transformation":return s.tidy((function(){return function(t,e,n){switch(t.op){case"Cast":return[Zt.a(Object(p.d)("x",t,e,n),Object(p.d)("dtype",t,e,n))];case"ExpandDims":var r=Object(p.d)("axis",t,e,n);return[tn.a(Object(p.d)("x",t,e,n),r)];case"Squeeze":var a=Object(p.d)("axis",t,e,n);return[Ue.a(Object(p.d)("x",t,e,n),a)];case"Reshape":return[We.a(Object(p.d)("x",t,e,n),Object(p.d)("shape",t,e,n))];case"MirrorPad":return[en.a(Object(p.d)("x",t,e,n),Object(p.d)("padding",t,e,n),Object(p.d)("mode",t,e,n))];case"PadV2":case"Pad":return[nn.a(Object(p.d)("x",t,e,n),Object(p.d)("padding",t,e,n),Object(p.d)("constantValue",t,e,n))];case"SpaceToBatchND":var o=Object(p.d)("blockShape",t,e,n),i=Object(p.d)("paddings",t,e,n);return[rn.a(Object(p.d)("x",t,e,n),o,i)];case"BatchToSpaceND":var c=Object(p.d)("blockShape",t,e,n),u=Object(p.d)("crops",t,e,n);return[an.a(Object(p.d)("x",t,e,n),c,u)];case"DepthToSpace":var s=Object(p.d)("blockSize",t,e,n),l=Object(p.d)("dataFormat",t,e,n).toUpperCase();return[on.a(Object(p.d)("x",t,e,n),s,l)];case"BroadcastTo":return[cn.a(Object(p.d)("x",t,e,n),Object(p.d)("shape",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)}));case"hash_table":return ce(t,e,n,a);case"custom":var o=Object(b.b)(t.op);if(o&&o.customExecutor)return o.customExecutor(new h(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return s.util.isPromise(o)?o.then((function(t){return[].concat(t)})):[].concat(o)}var sn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(c.a)(this,t),this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return Object(u.a)(t,[{key:"newFrame",value:function(t,e){return{id:t,frameName:e,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}},{key:"contextIdforContexts",value:function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(t){return this.weightMap[t]}},{key:"addTensorArray",value:function(t){this.tensorArrayMap[t.id]=t}},{key:"getTensorArray",value:function(t){return this.tensorArrayMap[t]}},{key:"addTensorList",value:function(t){this.tensorListMap[t.id]=t}},{key:"getTensorList",value:function(t){return this.tensorListMap[t]}},{key:"dispose",value:function(t){for(var e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}]),t}();function ln(t,e,n,r){var a=new Set,o=[],i=null,c=null,u=new Set,s=Object.keys(t).map((function(t){return Object(p.g)(t)[0]})),l=[];null!=r&&(l=r.map((function(t){return Object(p.g)(t.name)[0]})));for(var d=Object(f.a)(e);d.length>0;){var h=d.pop();(hn(h)||bn(h)||mn(h))&&null==i&&(c=(i=h).children.map((function(t){return t.name})).filter((function(t){return a.has(t)}))),a.add(h.name),null==n[h.name]&&(-1===s.indexOf(h.name)&&-1===l.indexOf(h.name)&&(0!==h.inputs.length?h.inputs.forEach((function(t){u.has(t.name)||(u.add(t.name),d.push(t))})):o.push(h.name)))}return{inputs:t,outputs:e,usedNodes:a,missingInputs:o,dynamicNode:i,syncInputs:c}}var dn=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],fn=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],pn=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function hn(t){return dn.indexOf(t.op)>=0}function bn(t){return fn.indexOf(t.op)>=0}function mn(t){return pn.indexOf(t.op)>=0}var vn=function(){function t(e,n){var r=this;Object(c.a)(this,t),this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((function(n){r._functionExecutorMap[n]=new t(e.functions[n],r)}))}return Object(u.a)(t,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(t){var e,n=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this._weightIds=(e=[]).concat.apply(e,Object(f.a)(n)),this._weightMap=t}},{key:"resourceManager",set:function(t){this._resourceManager=t}},{key:"inputs",get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(t){var e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e}))}},{key:"functions",get:function(){var t=this;return Object.keys(this._functions).reduce((function(e,n){return e[n]=t._functions[n].signature,e}),{})}},{key:"getCompilationKey",value:function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(t,e){var n=ln(t,e,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,o=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(o,"]"));if(r.length>0){var i=e.map((function(t){return t.name})),c=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(i,"] from the provided inputs ")+"[".concat(c,"]. Missing the following inputs: [").concat(r,"]"))}return function(t,e,n){var r=n.usedNodes,a=n.inputs,o=[],i=Object.keys(a).map((function(t){return Object(p.g)(t)[0]})).map((function(e){return t.nodes[e]})),c=t.initNodes;i.forEach((function(t){r.has(t.name)&&o.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&o.push(t)})),null!=c&&c.forEach((function(t){r.has(t.name)&&o.push(t)}));for(var u=new Set,s=[];o.length>0;){var l=o.pop();u.add(l.name),e[l.name]||s.push(l),l.children.forEach((function(t){!u.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return u.has(t.name)}))&&o.push(t)}))}return s}(this.graph,this.weightMap,n)}},{key:"execute",value:function(t,e){var n=this;t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var a=r.map((function(t){return n.graph.nodes[Object(p.g)(t)[0]]})),o=e.map((function(t){return Object(p.g)(t)[0]})),i=o.map((function(t){return n.graph.nodes[t]}));0===i.length&&(i=this._outputs);var c=this.getCompilationKey(a,i),u=this.compiledMap.get(c);null==u&&(u=this.compile(t,i),this.compiledMap.set(c,u));var l={},f={};return Object(s.tidy)((function(){var r=new sn(n.weightMap,l,f,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(t).forEach((function(e){var n=Object(p.g)(e),r=Object(d.a)(n,2),o=r[0],i=[];i[r[1]]=t[e],a[o]=i}));for(var i=n.getFrozenTensorIds(a),c={},h=0;h<u.length;h++){var b=u[h];if(!a[b.name]){var m=un(b,a,r,n._resourceManager);if(s.util.isPromise(m))throw new Error("The execution of the op '".concat(b.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[b.name]=m,n.checkTensorForDisposal(b.name,b,a,r,i,o,c)}}return null==n.parent&&r.dispose(i),e.map((function(t){return Object(p.e)(t,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)}},{key:"checkTensorForDisposal",value:function(t,e,n,r,a,o,i){"control"!==e.category&&-1===o.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(i[t.id]=(i[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=Object(p.f)(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!t.kept&&!a.has(t.id)){var e=i[t.id];1===e?(t.dispose(),delete i[t.id]):null!=e&&i[t.id]--}}))}})))}},{key:"executeAsync",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._executeAsync(e,n));case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"_executeAsync",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r,a,i,c,u,s,l,d,h,b=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=b.length>2&&void 0!==b[2]&&b[2],a=b.length>3&&void 0!==b[3]?b[3]:{},i=b.length>4&&void 0!==b[4]?b[4]:{},r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n)),c=new sn(this.weightMap,a,i,this.functionExecutorMap),t.next=7,this.executeWithControlFlow(e,c,n,r);case 7:return u=t.sent,s=n.map((function(t){return Object(p.e)(t,u,c)})),l=s.map((function(t){return t.id})),d=Object.keys(e).map((function(t){return e[t].id})),h=new Set([].concat(Object(f.a)(l),Object(f.a)(d),Object(f.a)(this.weightIds))),Object.keys(u).forEach((function(t){u[t].forEach((function(t){!t||t.kept||t.isDisposed||h.has(t.id)||t.dispose()}))})),null==this.parent&&c.dispose(h),t.abrupt("return",s);case 15:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n,r){var a,i=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.reduce((function(t,e,n){return t[i.inputs[n].name]=e,t}),{}),t.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n,r,a){var i,c,u,s,l,h,b,m,v,g,y,x,O,w,k,j,T,S=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=Object.keys(e),c=i.map((function(t){return S.graph.nodes[Object(p.g)(t)[0]]})),u=r.map((function(t){return Object(p.g)(t)[0]})),0===(s=u.map((function(t){return S.graph.nodes[t]}))).length&&(s=this._outputs),l=ln(e,s,this.weightMap,this._initNodes),h=l.usedNodes,b=l.missingInputs,m=l.dynamicNode,v=l.syncInputs,g=[].concat(Object(f.a)(c),Object(f.a)(this.graph.weights),Object(f.a)(this._initNodes||[])).map((function(t){return{node:t,contexts:n.currentContext}})),y=Object.assign({},this.weightMap),Object.keys(e).forEach((function(t){var n=Object(p.g)(t),r=Object(d.a)(n,2),a=r[0],o=[];o[r[1]]=e[t],y[a]=o})),x={},O=this.getFrozenTensorIds(y),w={};case 12:if(!(g.length>0)){t.next=18;break}return k=this.processStack(c,g,n,y,w,O,u,x,h),t.next=16,Promise.all(k);case 16:t.next=12;break;case 18:if(null!=m||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((j=s.filter((function(t){return!hn(t)&&!Object(p.e)(t.name,y,n)})).map((function(t){return t.name}))).length>0)){t.next=24;break}throw T="",null!=m&&(T="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(v,"]")),new Error("Cannot compute the outputs [".concat(j,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(b,"]. ").concat(T));case 24:return t.abrupt("return",y);case 25:case"end":return t.stop()}}),t,this)})));return function(e,n,r,a){return t.apply(this,arguments)}}()},{key:"processStack",value:function(t,e,n,r,a,o,i,c,u){for(var l=this,f=[],h=function(){var t=e.pop();n.currentContext=t.contexts;var h="";if("Enter"===t.node.op&&Object(p.d)("isConstant",t.node,r,n)){var b=Object(p.b)(t.node.name,n),m=Object(d.a)(b,1);h=m[0]}if(null==r[t.node.name]){var v=un(t.node,r,n,l._resourceManager);if(!h){var g=Object(p.b)(t.node.name,n),y=Object(d.a)(g,1);h=y[0]}var x=n.currentContext;s.util.isPromise(v)?f.push(v.then((function(s){return r[h]=s,n.currentContext=x,l.checkTensorForDisposal(h,t.node,r,n,o,i,c),l.processChildNodes(t.node,e,n,r,a,u),s}))):(r[h]=v,l.checkTensorForDisposal(h,t.node,r,n,o,i,c),l.processChildNodes(t.node,e,n,r,a,u))}else l.processChildNodes(t.node,e,n,r,a,u)};e.length>0;)h();return f}},{key:"processChildNodes",value:function(t,e,n,r,a,o){t.children.forEach((function(t){var i=Object(p.b)(t.name,n),c=Object(d.a)(i,1)[0];!a[c]&&o.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!Object(p.e)(t,r,n)}))&&(a[c]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!Object(p.e)(t,r,n)}))&&(a[c]=!0,e.push({contexts:n.currentContext,node:t})))}))}},{key:"dispose",value:function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],a=Object(p.g)(n),o=Object(d.a)(a,1)[0],i=e.graph.nodes[o];if(i.attrParams.shape&&i.attrParams.shape.value){var c=i.attrParams.shape.value,u=c.length===r.shape.length&&r.shape.every((function(t,e){return-1===c[e]||c[e]===t}));s.util.assert(u,(function(){return"The shape of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be [".concat(c,"], but was ")+"[".concat(r.shape,"]")}))}i.attrParams.dtype&&i.attrParams.dtype.value&&s.util.assert(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(i.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(t){var e={};for(var n in t){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])e[this._signature.inputs[n].name]=t[n];else e[n]=t[n]}return e}},{key:"checkInputs",value:function(t){var e=this,n=Object.keys(t).filter((function(t){var n=Object(p.g)(t),r=Object(d.a)(n,1)[0];return null==e.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(t){var e=this;return t.map((function(t){return null!=e._signature&&null!=e._signature.outputs&&null!=e._signature.outputs[t]?e._signature.outputs[t].name:t}),{})}},{key:"checkOutputs",value:function(t){var e=this;t.forEach((function(t){var n=Object(p.g)(t),r=Object(d.a)(n,1)[0];if(!e.graph.nodes[r])throw new Error("The output '".concat(t,"' is not found in the graph"))}))}}]),t}(),gn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,t),this.hashTableNameToHandle=e,this.hashTableMap=n}return Object(u.a)(t,[{key:"addHashTable",value:function(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}},{key:"getHashTableHandleByName",value:function(t){return this.hashTableNameToHandle[t]}},{key:"getHashTableById",value:function(t){return this.hashTableMap[t]}},{key:"dispose",value:function(){for(var t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(var e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}]),t}(),yn="?tfjs-format=file",xn="model.json",On=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,t),this.modelUrl=e,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={}),this.resourceManager=new gn}return Object(u.a)(t,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"findIOHandler",value:function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=s.io.browserHTTPRequest(t,this.loadOptions);else{var e=s.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(s.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}}},{key:"load",value:function(){var t=Object(i.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.findIOHandler(),null!=this.handler.load){t.next=3;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return t.next=5,this.handler.load();case 5:return e=t.sent,t.abrupt("return",this.loadSync(e));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadSync",value:function(t){this.artifacts=t;var e,n=this.artifacts.modelTopology;e=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=e,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer);var r=s.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new vn(l.a.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){var a=l.a.Instance.transformGraph(t.modelInitializer);this.initializer=new vn(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=9;break}if(0!==(r=s.io.getSaveHandlers(e)).length){t.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));case 6:if(!(r.length>1)){t.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(e,"'"));case 8:e=r[0];case 9:if(null!=e.save){t.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.abrupt("return",e.save(this.artifacts));case 12:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"predict",value:function(t,e){return this.execute(t,this.outputNodes)}},{key:"normalizeInputs",value:function(t){if(!(t instanceof s.Tensor)&&!Array.isArray(t))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(t.length," input tensors."));return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})}},{key:"normalizeOutputs",value:function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}},{key:"execute",value:function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var t=Object(i.a)(o.a.mark((function t(e,n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.normalizeInputs(e),n=this.normalizeOutputs(n),t.next=4,this.executor.executeAsync(e,n);case 4:return r=t.sent,t.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"convertTensorMapToTensorsMap",value:function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),t}();function wn(t){return kn.apply(this,arguments)}function kn(){return(kn=Object(i.a)(o.a.mark((function t(e){var n,r,a=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=e){t.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==e.load&&(e.endsWith("/")||(e+="/"),e="".concat(e).concat(xn).concat(yn)),r=new On(e,n),t.next=8,r.load();case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var jn="3.8.0"},,function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(68),a=n(69);function o(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));var a=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(o,"."));var i=e.size;if(0!==e.rank&&(1!==e.rank||i!==a))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(a,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var i=n(67),c=n(66);var u=Object(c.b)({sparseToDense_:function(t,e,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=Object(i.a)(t,"sparseIndices","sparseToDense","int32"),s=Object(i.a)(e,"sparseValues","sparseToDense"),l=Object(i.a)(c,"defaultValue","sparseToDense",s.dtype);o(u,s,n,l);var d={sparseIndices:u,sparseValues:s,defaultValue:l},f={outputShape:n};return r.a.runKernel(a.Nc,d,f)}})},function(t,e){t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(S){}function r(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function a(t){return!0===(t&&t.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=a;var o={},i={};function c(t,e){var n,r,a;return e?(a=0<=(t>>>=0)&&t<256)&&(r=i[t])?r:(n=s(t,(0|t)<0?-1:0,!0),a&&(i[t]=n),n):(a=-128<=(t|=0)&&t<128)&&(r=o[t])?r:(n=s(t,t<0?-1:0,!1),a&&(o[t]=n),n)}function u(t,e){if(isNaN(t))return e?g:v;if(e){if(t<0)return g;if(t>=h)return k}else{if(t<=-b)return j;if(t+1>=b)return w}return t<0?u(-t,e).neg():s(t%p|0,t/p|0,e)}function s(t,e,n){return new r(t,e,n)}r.fromInt=c,r.fromNumber=u,r.fromBits=s;var l=Math.pow;function d(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return d(t.substring(1),e,n).neg();for(var a=u(l(n,8)),o=v,i=0;i<t.length;i+=8){var c=Math.min(8,t.length-i),s=parseInt(t.substring(i,i+c),n);if(c<8){var f=u(l(n,c));o=o.mul(f).add(u(s))}else o=(o=o.mul(a)).add(u(s))}return o.unsigned=e,o}function f(t,e){return"number"===typeof t?u(t,e):"string"===typeof t?d(t,e):s(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}r.fromString=d,r.fromValue=f;var p=4294967296,h=p*p,b=h/2,m=c(1<<24),v=c(0);r.ZERO=v;var g=c(0,!0);r.UZERO=g;var y=c(1);r.ONE=y;var x=c(1,!0);r.UONE=x;var O=c(-1);r.NEG_ONE=O;var w=s(-1,2147483647,!1);r.MAX_VALUE=w;var k=s(-1,-1,!0);r.MAX_UNSIGNED_VALUE=k;var j=s(0,-2147483648,!1);r.MIN_VALUE=j;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},T.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(j)){var e=u(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var a=u(l(t,6),this.unsigned),o=this,i="";;){var c=o.div(a),s=(o.sub(c.mul(a)).toInt()>>>0).toString(t);if((o=c).isZero())return s+i;for(;s.length<6;)s="0"+s;i=""+s+i}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(j)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1===(1&this.low)},T.isEven=function(){return 0===(1&this.low)},T.equals=function(t){return a(t)||(t=f(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},T.eq=T.equals,T.notEquals=function(t){return!this.eq(t)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(t){return this.comp(t)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(t){return this.comp(t)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(t){return this.comp(t)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(t){return this.comp(t)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(t){if(a(t)||(t=f(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(j)?j:this.not().add(y)},T.neg=T.negate,T.add=function(t){a(t)||(t=f(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,i=t.high>>>16,c=65535&t.high,u=t.low>>>16,l=0,d=0,p=0,h=0;return p+=(h+=o+(65535&t.low))>>>16,d+=(p+=r+u)>>>16,l+=(d+=n+c)>>>16,l+=e+i,s((p&=65535)<<16|(h&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},T.subtract=function(t){return a(t)||(t=f(t)),this.add(t.neg())},T.sub=T.subtract,T.multiply=function(t){if(this.isZero())return v;if(a(t)||(t=f(t)),n)return s(n.mul(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned);if(t.isZero())return v;if(this.eq(j))return t.isOdd()?j:v;if(t.eq(j))return this.isOdd()?j:v;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return u(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,r=65535&this.high,o=this.low>>>16,i=65535&this.low,c=t.high>>>16,l=65535&t.high,d=t.low>>>16,p=65535&t.low,h=0,b=0,g=0,y=0;return g+=(y+=i*p)>>>16,b+=(g+=o*p)>>>16,g&=65535,b+=(g+=i*d)>>>16,h+=(b+=r*p)>>>16,b&=65535,h+=(b+=o*d)>>>16,b&=65535,h+=(b+=i*l)>>>16,h+=e*p+r*d+o*l+i*c,s((g&=65535)<<16|(y&=65535),(h&=65535)<<16|(b&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(t){if(a(t)||(t=f(t)),t.isZero())throw Error("division by zero");var e,r,o;if(n)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?s((this.unsigned?n.div_u:n.div_s)(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:v;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return x;o=g}else{if(this.eq(j))return t.eq(y)||t.eq(O)?j:t.eq(j)?y:(e=this.shr(1).div(t).shl(1)).eq(v)?t.isNegative()?y:O:(r=this.sub(t.mul(e)),o=e.add(r.div(t)));if(t.eq(j))return this.unsigned?g:v;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=v}for(r=this;r.gte(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(e)/Math.LN2),c=i<=48?1:l(2,i-48),d=u(e),p=d.mul(t);p.isNegative()||p.gt(r);)p=(d=u(e-=c,this.unsigned)).mul(t);d.isZero()&&(d=y),o=o.add(d),r=r.sub(p)}return o},T.div=T.divide,T.modulo=function(t){return a(t)||(t=f(t)),n?s((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return s(~this.low,~this.high,this.unsigned)},T.and=function(t){return a(t)||(t=f(t)),s(this.low&t.low,this.high&t.high,this.unsigned)},T.or=function(t){return a(t)||(t=f(t)),s(this.low|t.low,this.high|t.high,this.unsigned)},T.xor=function(t){return a(t)||(t=f(t)),s(this.low^t.low,this.high^t.high,this.unsigned)},T.shiftLeft=function(t){return a(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?s(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):s(0,this.low<<t-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(t){return a(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?s(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):s(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(t){if(a(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?s(this.low>>>t|e<<32-t,e>>>t,this.unsigned):s(32===t?e:e>>>t-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},T.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},T.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},r.fromBytes=function(t,e,n){return n?r.fromBytesLE(t,e):r.fromBytesBE(t,e)},r.fromBytesLE=function(t,e){return new r(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},r.fromBytesBE=function(t,e){return new r(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=s(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=s(t),i=r[0],c=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,i,c)),l=0,d=c>0?i-4:i;for(n=0;n<d;n+=4)e=a[t.charCodeAt(n)]<<18|a[t.charCodeAt(n+1)]<<12|a[t.charCodeAt(n+2)]<<6|a[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===c&&(e=a[t.charCodeAt(n)]<<2|a[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===c&&(e=a[t.charCodeAt(n)]<<10|a[t.charCodeAt(n+1)]<<4|a[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,a=n%3,o=[],i=16383,c=0,u=n-a;c<u;c+=i)o.push(l(t,c,c+i>u?u:c+i));1===a?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===a&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],a=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=i.length;c<u;++c)r[c]=i[c],a[i.charCodeAt(c)]=c;function s(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var a,o,i=[],c=e;c<n;c+=3)a=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),i.push(r[(o=a)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,a){var o,i,c=8*a-r-1,u=(1<<c)-1,s=u>>1,l=-7,d=n?a-1:0,f=n?-1:1,p=t[e+d];for(d+=f,o=p&(1<<-l)-1,p>>=-l,l+=c;l>0;o=256*o+t[e+d],d+=f,l-=8);for(i=o&(1<<-l)-1,o>>=-l,l+=r;l>0;i=256*i+t[e+d],d+=f,l-=8);if(0===o)o=1-s;else{if(o===u)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),o-=s}return(p?-1:1)*i*Math.pow(2,o-r)},e.write=function(t,e,n,r,a,o){var i,c,u,s=8*o-a-1,l=(1<<s)-1,d=l>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,b=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,i=l):(i=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-i))<1&&(i--,u*=2),(e+=i+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(i++,u/=2),i+d>=l?(c=0,i=l):i+d>=1?(c=(e*u-1)*Math.pow(2,a),i+=d):(c=e*Math.pow(2,d-1)*Math.pow(2,a),i=0));a>=8;t[n+p]=255&c,p+=h,c/=256,a-=8);for(i=i<<a|c,s+=a;s>0;t[n+p]=255&i,p+=h,i/=256,s-=8);t[n+p-h]|=128*b}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(t){var e,r=n(70),a=n(73),o=n(84),i=function(){return n(324)};var c=function(){function c(){Object(r.a)(this,c),this.util=n(325),this.textEncoder=new this.util.TextEncoder}return Object(a.a)(c,[{key:"fetch",value:function(t,n){return null!=Object(o.c)().global.fetch?Object(o.c)().global.fetch(t,n):(null==e&&(e=i()),e(t,n))}},{key:"now",value:function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}]),c}();Object(o.c)().get("IS_NODE")&&Object(o.c)().setPlatform("node",new c)}).call(this,n(154))},,,function(t,e,n){var r=n(327),a=n(328),o=n(329),i=n(330),c=n(331),u=n(332),s=n(333);s.alea=r,s.xor128=a,s.xorwow=o,s.xorshift7=i,s.xor4096=c,s.tychei=u,t.exports=s},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this,n=function(){var t=4022871197;return function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function c(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new i(t),r=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.alea=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function c(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xor128=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function c(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xorwow=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function c(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.x&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xorshift7=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,o=e.i;return e.w=r=r+1640531527|0,n=a[o+34&127],t=a[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,a,o,i,c=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=i+1640531527|0,a=0==(n=c[127&o]^=r+i)?a+1:0);for(a>=128&&(c[127&(e&&e.length||0)]=-1),a=127,o=512;o>0;--o)r=c[a+34&127],n=c[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,c[a]=r^n;t.w=i,t.X=c,t.i=a}(e,t)}function c(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.X&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xor4096=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){(function(t){var r;!function(t,a,o){function i(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function c(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&c(r,n),a.state=function(){return c(n,{})}),a}a&&a.exports?a.exports=u:n(96)&&n(130)?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.tychei=u}(0,t,n(96))}).call(this,n(103)(t))},function(t,e,n){var r;!function(a,o){var i,c=this,u=256,s=o.pow(u,6),l=o.pow(2,52),d=2*l,f=255;function p(t,e,n){var r=[],f=v(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,g(a)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(u):(t=new Uint8Array(u),(c.crypto||c.msCrypto).getRandomValues(t)),g(t)}catch(r){var e=c.navigator,n=e&&e.plugins;return[+new Date,c,n,c.screen,g(a)]}}():t,3),r),p=new h(r),y=function(){for(var t=p.g(6),e=s,n=0;t<l;)t=(t+n)*u,e*=u,n=p.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return y.int32=function(){return 0|p.g(4)},y.quick=function(){return p.g(4)/4294967296},y.double=y,v(g(p.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&b(r,p),t.state=function(){return b(p,{})}),n?(o.random=t,e):t})(y,f,"global"in e?e.global:this==o,e.state)}function h(t){var e,n=t.length,r=this,a=0,o=r.i=r.j=0,i=r.S=[];for(n||(t=[n++]);a<u;)i[a]=a++;for(a=0;a<u;a++)i[a]=i[o=f&o+t[a%n]+(e=i[a])],i[o]=e;(r.g=function(t){for(var e,n=0,a=r.i,o=r.j,i=r.S;t--;)e=i[a=f&a+1],n=n*u+i[f&(i[a]=i[o=f&o+e])+(i[o]=e)];return r.i=a,r.j=o,n})(u)}function b(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],a=typeof t;if(e&&"object"==a)for(n in t)try{r.push(m(t[n],e-1))}catch(o){}return r.length?r:"string"==a?t:t+"\0"}function v(t,e){for(var n,r=t+"",a=0;a<r.length;)e[f&a]=f&(n^=19*e[f&a])+r.charCodeAt(a++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(o.seedrandom=p,v(o.random(),a),t.exports){t.exports=p;try{i=n(334)}catch(y){}}else void 0===(r=function(){return p}.call(e,n,e,t))||(t.exports=r)}([],Math)},,function(t,e,n){(function(t){var r="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(a.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(a.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(336),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(23))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,a=1,o={},i=!1,c=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){l(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"===typeof n.data&&0===n.data.indexOf(e)&&l(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),r=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){l(t.data)},r=function(e){t.port2.postMessage(e)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var t=c.documentElement;r=function(e){var n=c.createElement("script");n.onreadystatechange=function(){l(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():r=function(t){setTimeout(l,0,t)},u.setImmediate=function(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return o[a]=i,r(a),a++},u.clearImmediate=s}function s(t){delete o[t]}function l(t){if(i)setTimeout(l,0,t);else{var e=o[t];if(e){i=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{s(t),i=!1}}}}}("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,n(23),n(154))},function(t,e,n){"use strict";var r,a;n.d(e,"a",(function(){return r})),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(a||(a={}))},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));var r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"load",(function(){return f})),n.d(e,"BlazeFaceModel",(function(){return d}));var r=n(65),a=n(316);function o(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{u(r.next(t))}catch(t){o(t)}}function c(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,c)}u((r=r.apply(t,e||[])).next())}))}function i(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}var c=function(t){return{startEndTensor:t,startPoint:Object(r.slice)(t,[0,0],[-1,2]),endPoint:Object(r.slice)(t,[0,2],[-1,2])}},u={strides:[8,16],anchors:[2,6]};function s(t,e){var n,a,o;if(t.topLeft instanceof r.Tensor&&t.bottomRight instanceof r.Tensor){var i=Object(r.tidy)((function(){return[Object(r.concat)([Object(r.slice)(Object(r.sub)(e-1,t.topLeft),0,1),Object(r.slice)(t.topLeft,1,1)]),Object(r.concat)([Object(r.sub)(e-1,Object(r.slice)(t.bottomRight,0,1)),Object(r.slice)(t.bottomRight,1,1)])]}));n=i[0],a=i[1],null!=t.landmarks&&(o=Object(r.tidy)((function(){var n=Object(r.sub)(Object(r.tensor1d)([e-1,0]),t.landmarks),a=Object(r.tensor1d)([1,-1]);return Object(r.mul)(n,a)})))}else{var c=t.topLeft,u=c[0],s=c[1],l=t.bottomRight,d=l[0],f=l[1];n=[e-1-u,s],a=[e-1-d,f],null!=t.landmarks&&(o=t.landmarks.map((function(t){return[e-1-t[0],t[1]]})))}var p={topLeft:n,bottomRight:a};return null!=o&&(p.landmarks=o),null!=t.probability&&(p.probability=t.probability instanceof r.Tensor?t.probability.clone():t.probability),p}function l(t,e){return Object(r.tidy)((function(){var n;return n=t.hasOwnProperty("box")?t.box:t,Object(r.squeeze)(function(t,e){var n=Object(r.mul)(t.startPoint,e),a=Object(r.mul)(t.endPoint,e),o=Object(r.concat2d)([n,a],1);return c(o)}(n,e).startEndTensor)}))}var d=function(){function t(t,e,n,a,o,i){this.blazeFaceModel=t,this.width=e,this.height=n,this.maxFaces=a,this.anchorsData=function(t,e,n){for(var r=[],a=0;a<n.strides.length;a++)for(var o=n.strides[a],i=Math.floor((e+o-1)/o),c=Math.floor((t+o-1)/o),u=n.anchors[a],s=0;s<i;s++)for(var l=o*(s+.5),d=0;d<c;d++)for(var f=o*(d+.5),p=0;p<u;p++)r.push([f,l]);return r}(e,n,u),this.anchors=Object(r.tensor2d)(this.anchorsData),this.inputSizeData=[e,n],this.inputSize=Object(r.tensor1d)([e,n]),this.iouThreshold=o,this.scoreThreshold=i}return t.prototype.getBoundingBoxes=function(t,e,n){return void 0===n&&(n=!0),o(this,void 0,void 0,(function(){var a,u,s,l,d,f,p,h,b,m,v,g,y,x,O=this;return i(this,(function(w){switch(w.label){case 0:return a=Object(r.tidy)((function(){var e=r.image.resizeBilinear(t,[O.width,O.height]),n=Object(r.mul)(Object(r.sub)(Object(r.div)(e,255),.5),2),a=O.blazeFaceModel.predict(n),o=Object(r.squeeze)(a),i=function(t,e,n){var a=Object(r.slice)(t,[0,1],[-1,2]),o=Object(r.add)(a,e),i=Object(r.slice)(t,[0,3],[-1,2]),c=Object(r.div)(i,n),u=Object(r.div)(o,n),s=Object(r.div)(c,2),l=Object(r.sub)(u,s),d=Object(r.add)(u,s),f=Object(r.mul)(l,n),p=Object(r.mul)(d,n);return Object(r.concat2d)([f,p],1)}(o,O.anchors,O.inputSize),c=Object(r.slice)(o,[0,0],[-1,1]);return[o,i,Object(r.squeeze)(Object(r.sigmoid)(c))]})),u=a[0],s=a[1],l=a[2],d=console.warn,console.warn=function(){},f=r.image.nonMaxSuppression(s,l,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=d,[4,f.array()];case 1:return p=w.sent(),f.dispose(),h=p.map((function(t){return Object(r.slice)(s,[t,0],[1,-1])})),e?[3,3]:[4,Promise.all(h.map((function(t){return o(O,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,t.array()];case 1:return e=n.sent(),t.dispose(),[2,e]}}))}))})))];case 2:h=w.sent(),w.label=3;case 3:for(b=t.shape[1],m=t.shape[2],v=e?Object(r.div)([m,b],this.inputSize):[m/this.inputSizeData[0],b/this.inputSizeData[1]],g=[],y=function(t){var a=h[t],o=Object(r.tidy)((function(){var o=c(a instanceof r.Tensor?a:Object(r.tensor2d)(a));if(!n)return o;var i,s=p[t];return i=e?Object(r.slice)(O.anchors,[s,0],[1,2]):O.anchorsData[s],{box:o,landmarks:Object(r.reshape)(Object(r.squeeze)(Object(r.slice)(u,[s,5],[1,-1])),[6,-1]),probability:Object(r.slice)(l,[s],[1]),anchor:i}}));g.push(o)},x=0;x<h.length;x++)y(x);return s.dispose(),l.dispose(),u.dispose(),[2,{boxes:g,scaleFactor:v}]}}))}))},t.prototype.estimateFaces=function(t,e,n,a){return void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===a&&(a=!0),o(this,void 0,void 0,(function(){var c,u,d,f,p,h,b=this;return i(this,(function(m){switch(m.label){case 0:return c=function(t){return t instanceof r.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),u=c[1],d=Object(r.tidy)((function(){return t instanceof r.Tensor||(t=r.browser.fromPixels(t)),Object(r.expandDims)(Object(r.cast)(t,"float32"),0)})),[4,this.getBoundingBoxes(d,e,a)];case 1:return f=m.sent(),p=f.boxes,h=f.scaleFactor,d.dispose(),e?[2,p.map((function(t){var e=l(t,h),o={topLeft:Object(r.slice)(e,[0],[2]),bottomRight:Object(r.slice)(e,[2],[2])};if(a){var i=t,c=i.landmarks,d=i.probability,f=i.anchor,p=Object(r.mul)(Object(r.add)(c,f),h);o.landmarks=p,o.probability=d}return n&&(o=s(o,u)),o}))]:[2,Promise.all(p.map((function(t){return o(b,void 0,void 0,(function(){var e,r,c,d,f,p,b,m,v,g,y,x=this;return i(this,(function(O){switch(O.label){case 0:return e=l(t,h),a?[3,2]:[4,e.array()];case 1:return f=O.sent(),r={topLeft:f.slice(0,2),bottomRight:f.slice(2)},[3,4];case 2:return[4,Promise.all([t.landmarks,e,t.probability].map((function(t){return o(x,void 0,void 0,(function(){return i(this,(function(e){return[2,t.array()]}))}))})))];case 3:c=O.sent(),d=c[0],f=c[1],p=c[2],b=t.anchor,v=(m=h)[0],g=m[1],y=d.map((function(t){return[(t[0]+b[0])*v,(t[1]+b[1])*g]})),r={topLeft:f.slice(0,2),bottomRight:f.slice(2),landmarks:y,probability:p},function(t){t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()}(t.box),t.landmarks.dispose(),t.probability.dispose(),O.label=4;case 4:return e.dispose(),n&&(r=s(r,u)),[2,r]}}))}))})))]}}))}))},t}();function f(t){var e=void 0===t?{}:t,n=e.maxFaces,r=void 0===n?10:n,c=e.inputWidth,u=void 0===c?128:c,s=e.inputHeight,l=void 0===s?128:s,f=e.iouThreshold,p=void 0===f?.3:f,h=e.scoreThreshold,b=void 0===h?.75:h,m=e.modelUrl;return o(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return null==m?[3,2]:[4,Object(a.loadGraphModel)(m)];case 1:return t=e.sent(),[3,4];case 2:return[4,Object(a.loadGraphModel)("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0})];case 3:t=e.sent(),e.label=4;case 4:return[2,new d(t,u,l,r,p,b)]}}))}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"version_webgl",(function(){return Rr})),n.d(e,"MathBackendWebGL",(function(){return Ar})),n.d(e,"setWebGLContext",(function(){return O})),n.d(e,"GPGPUContext",(function(){return ne})),n.d(e,"gpgpu_util",(function(){return a})),n.d(e,"webgl_util",(function(){return r})),n.d(e,"forceHalfFloat",(function(){return _r})),n.d(e,"webgl",(function(){return Fr}));var r={};n.r(r),n.d(r,"callAndCheck",(function(){return N})),n.d(r,"canBeRepresented",(function(){return C})),n.d(r,"getWebGLErrorMessage",(function(){return I})),n.d(r,"getExtensionOrThrow",(function(){return E})),n.d(r,"createVertexShader",(function(){return A})),n.d(r,"createFragmentShader",(function(){return R})),n.d(r,"createProgram",(function(){return M})),n.d(r,"linkProgram",(function(){return P})),n.d(r,"validateProgram",(function(){return L})),n.d(r,"createStaticVertexBuffer",(function(){return B})),n.d(r,"createStaticIndexBuffer",(function(){return V})),n.d(r,"getNumChannels",(function(){return z})),n.d(r,"createTexture",(function(){return U})),n.d(r,"validateTextureSize",(function(){return W})),n.d(r,"createFramebuffer",(function(){return G})),n.d(r,"bindVertexBufferToProgramAttribute",(function(){return H})),n.d(r,"bindTextureUnit",(function(){return q})),n.d(r,"unbindTextureUnit",(function(){return K})),n.d(r,"getProgramUniformLocationOrThrow",(function(){return X})),n.d(r,"getProgramUniformLocation",(function(){return Y})),n.d(r,"bindTextureToProgramUniformSampler",(function(){return Q})),n.d(r,"bindCanvasToFramebuffer",(function(){return Z})),n.d(r,"bindColorTextureToFramebuffer",(function(){return J})),n.d(r,"unbindColorTextureFromFramebuffer",(function(){return $})),n.d(r,"validateFramebuffer",(function(){return tt})),n.d(r,"getFramebufferErrorMessage",(function(){return et})),n.d(r,"getBatchDim",(function(){return at})),n.d(r,"getRowsCols",(function(){return ot})),n.d(r,"getShapeAs3D",(function(){return it})),n.d(r,"getTextureShapeFromLogicalShape",(function(){return ct})),n.d(r,"isReshapeFree",(function(){return st})),n.d(r,"getWebGLMaxTextureSize",(function(){return lt})),n.d(r,"resetMaxTextureSize",(function(){return dt})),n.d(r,"resetMaxTexturesInShader",(function(){return ft})),n.d(r,"getMaxTexturesInShader",(function(){return pt})),n.d(r,"getWebGLDisjointQueryTimerVersion",(function(){return ht})),n.d(r,"hasExtension",(function(){return bt})),n.d(r,"isWebGLVersionEnabled",(function(){return mt})),n.d(r,"isCapableOfRenderingToFloatTexture",(function(){return vt})),n.d(r,"isDownloadFloatTextureEnabled",(function(){return gt})),n.d(r,"isWebGLFenceEnabled",(function(){return xt})),n.d(r,"assertNotComplex",(function(){return Ot}));var a={};n.r(a),n.d(a,"createVertexShader",(function(){return Ft})),n.d(a,"createVertexBuffer",(function(){return Dt})),n.d(a,"createIndexBuffer",(function(){return Mt})),n.d(a,"getInternalFormatForFloat32MatrixTexture",(function(){return Lt})),n.d(a,"createFloat32MatrixTexture",(function(){return Bt})),n.d(a,"getInternalFormatForFloat16MatrixTexture",(function(){return Vt})),n.d(a,"createFloat16MatrixTexture",(function(){return zt})),n.d(a,"getInternalFormatForUnsignedBytesMatrixTexture",(function(){return Ut})),n.d(a,"createUnsignedBytesMatrixTexture",(function(){return Wt})),n.d(a,"getInternalFormatForPackedMatrixTexture",(function(){return Gt})),n.d(a,"createPackedMatrixTexture",(function(){return Ht})),n.d(a,"getInternalFormatForFloat16PackedMatrixTexture",(function(){return qt})),n.d(a,"createFloat16PackedMatrixTexture",(function(){return Kt})),n.d(a,"bindVertexProgramAttributeStreams",(function(){return Xt})),n.d(a,"uploadDenseMatrixToTexture",(function(){return Yt})),n.d(a,"uploadPixelDataToTexture",(function(){return Qt})),n.d(a,"createBufferFromOutputTexture",(function(){return Zt})),n.d(a,"downloadFloat32MatrixFromBuffer",(function(){return Jt})),n.d(a,"downloadByteEncodedFloatMatrixFromOutputTexture",(function(){return $t})),n.d(a,"downloadPackedMatrixFromBuffer",(function(){return te})),n.d(a,"downloadMatrixFromPackedOutputTexture",(function(){return ee}));var o,i,c,u=n(65),s=n(72),l=n(75),d=n.n(l),f=n(77),p=n(76),h=n(70),b=n(73),m=n(90),v=n(81),g=n(80),y={},x={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function O(t,e){y[t]=e}function w(t){if(!(t in y)){var e=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!==typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);if(e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete y[t]}),!1),1===t)return e.getContext("webgl",x)||e.getContext("experimental-webgl",x);return e.getContext("webgl2",x)}(t);if(null===e)return console.log("Could not get context for WebGL version",t),null;y[t]=e}var n=y[t];return n.isContextLost()?(delete y[t],w(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),y[t])}function k(t,e){return[e,t]}function j(t){var e=u.util.sizeFromShape(t),n=Math.ceil(e/4);return u.util.sizeToSquarishShape(n)}function T(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function S(t,e){var n,r,a,o,i,c,s,l,d,f=t;return 2===Object(u.env)().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,o=f.RGBA32F,i=f.RED,c=4,s=1,l=f.HALF_FLOAT,d=f.FLOAT):(n=t.RGBA,r=t.RGBA,a=t.RGBA,o=f.RGBA,i=t.RGBA,c=4,s=4,l=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:c,defaultNumChannels:s,textureTypeHalfFloat:l,textureTypeFloat:d}}function N(t,e){var n=e();return Object(u.env)().getBool("DEBUG")&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+I(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(o||(o={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(i||(i={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(c||(c={}));function C(t){return!!(Object(u.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function I(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}function E(t,e){return nt(t,(function(){return t.getExtension(e)}),'Extension "'+e+'" not supported on this browser.')}function A(t,e){var n=nt(t,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(N(t,(function(){return t.shaderSource(n,e)})),N(t,(function(){return t.compileShader(n)})),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function R(t,e){var n=nt(t,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(N(t,(function(){return t.shaderSource(n,e)})),N(t,(function(){return t.compileShader(n)})),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){var n=D.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);for(var r=+n[1],a=t.split("\n"),o=a.length.toString().length+2,i=a.map((function(t,e){return u.util.rightPad((e+1).toString(),o)+t})),c=0,s=0;s<i.length;s++)c=Math.max(i[s].length,c);var l=i.slice(0,r-1),d=i.slice(r-1,r),f=i.slice(r);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(u.util.rightPad(d[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var _,F,D=/ERROR: [0-9]+:([0-9]+):/g;function M(t){return nt(t,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function P(t,e){if(N(t,(function(){return t.linkProgram(e)})),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function L(t,e){if(N(t,(function(){return t.validateProgram(e)})),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function B(t,e){var n=nt(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return N(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),N(t,(function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)})),n}function V(t,e){var n=nt(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return N(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)})),N(t,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)})),n}function z(){return 2===Object(u.env)().getNumber("WEBGL_VERSION")?1:4}function U(t){return nt(t,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function W(t,e){var n=Object(u.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){var a="[".concat(t,"x").concat(e,"]"),o="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+o+".")}}function G(t){return nt(t,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function H(t,e,n,r,a,o,i){var c=t.getAttribLocation(e,n);return-1!==c&&(N(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),N(t,(function(){return t.vertexAttribPointer(c,a,t.FLOAT,!1,o,i)})),N(t,(function(){return t.enableVertexAttribArray(c)})),!0)}function q(t,e,n){rt(t,n),N(t,(function(){return t.activeTexture(t.TEXTURE0+n)})),N(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)}))}function K(t,e){rt(t,e),N(t,(function(){return t.activeTexture(t.TEXTURE0+e)})),N(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function X(t,e,n){return nt(t,(function(){return t.getUniformLocation(e,n)}),'uniform "'+n+'" not present in program.')}function Y(t,e,n){return t.getUniformLocation(e,n)}function Q(t,e,n,r){N(t,(function(){return q(t,e,r)})),N(t,(function(){return t.uniform1i(n,r)}))}function Z(t){N(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),N(t,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),N(t,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))}function J(t,e,n){N(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),N(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}))}function $(t,e){N(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)})),N(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function tt(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+et(t,e))}function et(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}function nt(t,e,n){var r=N(t,(function(){return e()}));if(null==r)throw new Error(n);return r}function rt(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function at(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return u.util.sizeFromShape(t.slice(0,t.length-e))}function ot(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function it(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[at(t)].concat(Object(f.a)(ot(t)))),e}function ct(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(u.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((function(e,n){return n>=t.length-2?u.util.nearestLargerEven(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var r=u.util.squeezeShape(t);t=r.newShape}var a=u.util.sizeFromShape(t);if(t.length<=1&&a<=n)return[1,a];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){var o=at(t),i=2,c=2;if(t.length){var l=ot(t),d=Object(s.a)(l,2);i=d[0],c=d[1]}return a=o*(i/2)*(c/2),u.util.sizeToSquarishShape(a).map((function(t){return 2*t}))}return u.util.sizeToSquarishShape(a)}function ut(t){return t%2===0}function st(t,e){if(t=t.slice(-2),e=e.slice(-2),u.util.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(ut(n)&&ut(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&ut(t[0])&&ut(e[0])}function lt(t){if(null==_){var e=w(t);_=e.getParameter(e.MAX_TEXTURE_SIZE)}return _}function dt(){_=null}function ft(){F=null}function pt(t){if(null==F){var e=w(t);F=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,F)}function ht(t){if(0===t)return 0;var e=w(t);return bt(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:bt(e,"EXT_disjoint_timer_query")?1:0}function bt(t,e){return null!=t.getExtension(e)}function mt(t){try{if(null!=w(t))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function vt(t){if(0===t)return!1;var e=w(t);if(1===t){if(!bt(e,"OES_texture_float"))return!1}else if(!bt(e,"EXT_color_buffer_float"))return!1;return yt(e)}function gt(t){if(0===t)return!1;var e=w(t);if(1!==t){if(bt(e,"EXT_color_buffer_float"))return yt(e);var n="EXT_color_buffer_half_float";if(bt(e,n)){var r=e.getExtension(n);return function(t,e){var n=S(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);var a=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,a,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var c=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),c}(e,r)}return!1}return!!bt(e,"OES_texture_float")&&(!!bt(e,"WEBGL_color_buffer_float")&&yt(e))}function yt(t){var e=S(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),a}function xt(t){return 2===t&&null!=w(t).fenceSync}function Ot(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&u.util.assert("complex64"!==t.dtype,(function(){return"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var wt=Object(u.env)();function kt(){var t,e,n,r,a,o,i,c,s,l;return 2===Object(u.env)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",a="texture",o="outputColor",i="out vec4 outputColor;",c="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",s="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",i="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:c,defineSpecialInf:s,defineRound:l}}function jt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=u.util.computeStrides(e);return r.map((function(e,a){var o="int ".concat(t[a]," = ").concat(n," / ").concat(e),i=a===r.length-1?"int ".concat(t[a+1]," = ").concat(n," - ").concat(t[a]," * ").concat(e):"index -= ".concat(t[a]," * ").concat(e);return"".concat(o,"; ").concat(i,";")})).join("")}function Tt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=u.util.computeStrides(e);return r.map((function(e,a){var o="int ".concat(t[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),i=a===r.length-1?"int ".concat(t[a+1]," = ").concat(n," - ").concat(t[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(t[a]," * outShapeStrides[").concat(a,"]");return"".concat(o,"; ").concat(i,";")})).join("")}function St(t){var e=u.util.computeStrides(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}wt.registerFlag("HAS_WEBGL",(function(){return wt.getNumber("WEBGL_VERSION")>0})),wt.registerFlag("WEBGL_VERSION",(function(){return mt(2)?2:mt(1)?1:0})),wt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),wt.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===wt.get("WEBGL_VERSION")})),wt.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),wt.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),wt.registerFlag("WEBGL_PACK",(function(){return wt.getBool("HAS_WEBGL")})),wt.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_CLIP",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_PACK_REDUCE",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_CONV_IM2COL",(function(){return wt.getBool("WEBGL_PACK")})),wt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return lt(wt.getNumber("WEBGL_VERSION"))})),wt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return pt(wt.getNumber("WEBGL_VERSION"))})),wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=wt.getNumber("WEBGL_VERSION");return 0===t?0:ht(t)})),wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return wt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!u.device_util.isMobile()})),wt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return vt(wt.getNumber("WEBGL_VERSION"))})),wt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!wt.getBool("WEBGL_FORCE_F16_TEXTURES")&&wt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),wt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return gt(wt.getNumber("WEBGL_VERSION"))})),wt.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return xt(wt.getNumber("WEBGL_VERSION"))})),wt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return wt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),wt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(t){if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))})),wt.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return u.device_util.isMobile()&&wt.getBool("IS_CHROME")?1:-1}),(function(t){if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))})),wt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),wt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),wt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),wt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128}));var Nt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",Ct=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=o.DENSE;var n=j(e),r=kt();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(jt(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},It=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=o.DENSE;var n=j(e),r=kt();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(jt(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},Et=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.outTexUsage=i.DOWNLOAD;var n=kt();this.outputShape=e,this.userCode="\n      ".concat(Nt,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},At=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=i.DOWNLOAD;var n=kt();this.outputShape=e,this.userCode="\n      ".concat(Nt,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},Rt=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),this.variableNames=["A"];var a=kt(),o=Object(s.a)(n,2),i=o[0],c=o[1];this.outputShape=e;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(St(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(c,";\n        int c = imod(flatIndex, ").concat(c,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")},_t=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=kt(),o=Object(s.a)(n,2),i=o[0],c=o[1];this.outputShape=e;var u="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var d=0;d<=1;d++)for(var f=0;f<=1;f++){var p=2*d+f;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(f," < ").concat(e[2],") {\n            localCoords[2] += ").concat(f,";\n            if(localCoords[1] + ").concat(d," < ").concat(e[1],") {\n              localCoords[1] += ").concat(d,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(c,";\n              c = imod(flatIndex, ").concat(c,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(p,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(p,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(p,"] = values[2];\n              } else {\n                result[").concat(p,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(St(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")};function Ft(t){var e=kt();return A(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Dt(t){return B(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Mt(t){return V(t,new Uint16Array([0,1,2,2,1,3]))}function Pt(t,e,n,r,a,o){W(e,n);var i=U(t),c=t.TEXTURE_2D;return N(t,(function(){return t.bindTexture(c,i)})),N(t,(function(){return t.texParameteri(c,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),N(t,(function(){return t.texParameteri(c,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),N(t,(function(){return t.texParameteri(c,t.TEXTURE_MIN_FILTER,t.NEAREST)})),N(t,(function(){return t.texParameteri(c,t.TEXTURE_MAG_FILTER,t.NEAREST)})),N(t,(function(){return t.texImage2D(c,0,r,e,n,0,a,o,null)})),N(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),i}function Lt(t){return t.internalFormatFloat}function Bt(t,e,n,r){var a=k(e,n),o=Object(s.a)(a,2);return Pt(t,o[0],o[1],Lt(r),r.textureFormatFloat,t.FLOAT)}function Vt(t){return t.internalFormatHalfFloat}function zt(t,e,n,r){var a=k(e,n),o=Object(s.a)(a,2);return Pt(t,o[0],o[1],Vt(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Ut(t){return t.downloadTextureFormat}function Wt(t,e,n,r){var a=k(e,n),o=Object(s.a)(a,2);return Pt(t,o[0],o[1],Ut(r),t.RGBA,t.UNSIGNED_BYTE)}function Gt(t){return t.internalFormatPackedFloat}function Ht(t,e,n,r){var a=T(e,n),o=Object(s.a)(a,2);return Pt(t,o[0],o[1],Gt(r),t.RGBA,t.FLOAT)}function qt(t){return t.internalFormatPackedHalfFloat}function Kt(t,e,n,r){var a=T(e,n),o=Object(s.a)(a,2);return Pt(t,o[0],o[1],qt(r),t.RGBA,r.textureTypeHalfFloat)}function Xt(t,e,n){return N(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),H(t,e,"clipSpacePos",n,3,20,0)&&H(t,e,"uv",n,2,20,12)}function Yt(t,e,n,r,a,o){var i,c,u;N(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),a instanceof Uint8Array?(i=new Uint8Array(n*r*4),c=t.UNSIGNED_BYTE,u=t.RGBA):(i=new Float32Array(n*r*4),c=t.FLOAT,u=o.internalFormatPackedFloat),i.set(a),N(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,u,n,r,0,t.RGBA,c,i)})),N(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Qt(t,e,n){N(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),n.data instanceof Uint8Array?N(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)})):N(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)})),N(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Zt(t,e,n,r){var a=t.createBuffer();N(t,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,a)}));var o=16*e*n;return N(t,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),N(t,(function(){return t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)})),N(t,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),a}function Jt(t,e,n){var r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function $t(t,e,n,r){var a=k(e,n),o=Object(s.a)(a,2),i=o[0],c=o[1],u=new Uint8Array(e*n*4);return N(t,(function(){return t.readPixels(0,0,i,c,r.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function te(t,e,n,r,a,o,i,c){var u=t,l=new Float32Array(function(t,e){var n=T(t,e),r=Object(s.a)(n,2);return r[0]*r[1]*4}(o,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function ee(t,e,n){var r=new Float32Array(e*n*4);return N(t,(function(){return t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)})),r}var ne=function(){function t(e){Object(h.a)(this,t),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Object(u.env)().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,O(n,e)):this.gl=w(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===Object(u.env)().getNumber("WEBGL_VERSION")){var o="OES_texture_half_float";if(this.textureFloatExtension=E(this.gl,"OES_texture_float"),bt(this.gl,o))this.textureHalfFloatExtension=E(this.gl,o);else if(Object(u.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),bt(this.gl,a))this.colorBufferHalfFloatExtension=E(this.gl,a);else if(Object(u.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",bt(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!bt(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=Dt(this.gl),this.indexBuffer=Mt(this.gl),this.framebuffer=G(this.gl),this.textureConfig=S(this.gl,this.textureHalfFloatExtension)}return Object(b.a)(t,[{key:"debug",get:function(){return Object(u.env)().getBool("DEBUG")}},{key:"dispose",value:function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;N(e,(function(){return e.finish()})),N(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),N(e,(function(){return e.deleteFramebuffer(t.framebuffer)})),N(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),N(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),N(e,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(t,e){return this.throwIfDisposed(),Bt(this.gl,t,e,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(t,e){return this.throwIfDisposed(),zt(this.gl,t,e,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(t,e){return this.throwIfDisposed(),Wt(this.gl,t,e,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(t,e){this.throwIfDisposed(),Qt(this.gl,t,e)}},{key:"uploadDenseMatrixToTexture",value:function(t,e,n,r){this.throwIfDisposed(),Yt(this.gl,t,e,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(t,e){return this.throwIfDisposed(),Kt(this.gl,t,e,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(t,e){return this.throwIfDisposed(),Ht(this.gl,t,e,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&($(this.gl,this.framebuffer),this.outputTexture=null),N(this.gl,(function(){return e.gl.deleteTexture(t)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return $t(r.gl,e,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(t,e,n,r,a,o){return te(this.gl,t,0,0,0,a,o,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(t,e){return Jt(this.gl,t,e)}},{key:"createBufferFromTexture",value:function(t,e,n){this.bindTextureToFrameBuffer(t);var r=Zt(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var t=this.createFence(this.gl);return this.pollFence(t)}},{key:"createFence",value:function(t){var e,n,r=this;if(Object(u.env)().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=a.clientWaitSync(o,0,0);return t===a.ALREADY_SIGNALED||t===a.CONDITION_SATISFIED},e=o}else Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return ee(r.gl,e,n)}))}},{key:"createProgram",value:function(t){var e=this;this.throwIfDisposed();var n=this.gl,r=R(n,t);null==this.vertexShader&&(this.vertexShader=Ft(n));var a=M(n);return N(n,(function(){return n.attachShader(a,e.vertexShader)})),N(n,(function(){return n.attachShader(a,r)})),P(n,a),this.debug&&L(n,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=Xt(n,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&N(this.gl,(function(){return e.gl.deleteProgram(t)}))}},{key:"setProgram",value:function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&L(this.gl,this.program),N(this.gl,(function(){return e.gl.useProgram(t)}))}},{key:"getUniformLocation",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?X(this.gl,t,e):Y(this.gl,t,e)}},{key:"getAttributeLocation",value:function(t,e){var n=this;return this.throwIfDisposed(),N(this.gl,(function(){return n.gl.getAttribLocation(t,e)}))}},{key:"getUniformLocationNoThrow",value:function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}},{key:"setInputMatrixTexture",value:function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Q(this.gl,t,e,n)}},{key:"setOutputMatrixTexture",value:function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}},{key:"setOutputPackedMatrixTexture",value:function(t,e,n){this.throwIfDisposed();var r=T(e,n),a=Object(s.a)(r,2),o=a[0],i=a[1];this.setOutputMatrixTextureDriver(t,o,i)}},{key:"setOutputMatrixWriteRegion",value:function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}},{key:"setOutputPackedMatrixWriteRegion",value:function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&L(this.gl,this.program),tt(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),N(t,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var t=this;this.throwIfDisposed(),N(this.gl,(function(){return t.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=E(this.gl,2===Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var t=Object(p.a)(d.a.mark((function t(e){var n=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.util.repeatedTry((function(){return n.disposed||n.isQueryAvailable(e,Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return t.abrupt("return",this.getQueryTime(e,Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getQueryTime",value:function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var o=this.getQueryTimerExtensionWebGL1(),i=o.getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}},{key:"pollFence",value:function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var t=function(t){for(var e=0;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e){(0,this.itemsToPoll[e].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}},{key:"addItemToPoll",value:function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||u.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(t){this.throwIfDisposed(),J(this.gl,t,this.framebuffer),this.debug&&tt(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(J(this.gl,this.outputTexture,this.framebuffer),this.debug&&tt(this.gl)):$(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(t,e,n){this.throwIfDisposed();var r=this.gl;J(r,t,this.framebuffer),this.debug&&tt(r),this.outputTexture=t,N(r,(function(){return r.viewport(0,0,e,n)})),N(r,(function(){return r.scissor(0,0,e,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(t,e,n,r){var a=this;this.throwIfDisposed(),N(this.gl,(function(){return a.gl.scissor(t,e,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),t}();var re=u.backend_util.getBroadcastDims;function ae(t,e,n){var r=[];if(t.forEach((function(t){var e=u.util.sizeFromShape(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(r.push("uniform sampler2D ".concat(t.name,";")),r.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){switch(ke(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(t.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(t.name,"Shape;"))}r.push("uniform ivec2 ".concat(t.name,"TexShape;"))}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(t){r.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))}));var a,o,i=r.join("\n"),c=t.map((function(t){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?ie(t,r):oe(t,r);var o=t.shapeInfo.logicalShape,i=e.logicalShape;o.length<=i.length&&(a+=n?xe(t,e):Oe(t,e));return a}(t,e,n.packedInputs,n.enableShapeUniforms)})).join("\n"),s=e.texShape,l=kt(),d=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),f=function(t){return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(ce,"\n    ").concat(ue,"\n    ").concat(se,"\n  ")}(l);return e.isPacked?(a=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(u.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(t[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),o=a*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),o=a*Math.ceil(t[t.length-2]/2),i=o,c="",u="b, r, c",s=2;s<t.length-1;s++)i*=t[t.length-s-1],c="\n      int b".concat(s," = index / ").concat(i,";\n      index -= b").concat(s," * ").concat(i,";\n    ")+c,u="b".concat(s,", ")+u;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(c,"\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(t.length,"(").concat(u,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,s,n.enableShapeUniforms),o=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(l)):(a=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){if(1===e[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){if(u.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){var r=Tt(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=jt(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){var r=Tt(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=jt(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return function(t,e){var n=jt(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){var n=jt(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,s,n.enableShapeUniforms),o=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),n.packedInputs&&(f+=le),[f,d,o,i,a,c,n.userCode].join("\n")}function oe(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.shapeInfo.logicalShape;switch(n.length){case 0:return fe(t,e);case 1:return pe(t,e);case 2:return he(t,e);case 3:return be(t,e);case 4:return me(t,e);case 5:return ve(t);case 6:return ge(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function ie(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=kt();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,o=kt();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ");var i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],c=o[1],s=kt();if(null!=o&&u.util.arraysEqual(n,o))return e?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");var l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],d=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(d,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var c=[1,2],u=je(t,n.slice(1)),s=["b","row","col"];return"\n        ".concat(ie(u,e),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Te(s,c),");\n        }\n      ")}var l=kt();if(e)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var d=i[0],f=i[1],p=Math.ceil(n[2]/2),h=p*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(d,", ").concat(f,", ").concat(h,", ").concat(p,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=kt();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var o=t.shapeInfo.logicalShape,i=o.length,c=t.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],s=u[0],l=u[1],d=Math.ceil(o[i-1]/2),f=d*Math.ceil(o[i-2]/2),p="int b, int row, int col",h="b * ".concat(f," + (row / 2) * ").concat(d," + (col / 2)"),b=2;b<i-1;b++)p="int b".concat(b,", ")+p,f*=o[i-b-1],h="b".concat(b," * ").concat(f," + ")+h;return"\n    vec4 ".concat(r,"(").concat(p,") {\n      int index = ").concat(h,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(s,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}var ce="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ue="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",se="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",le="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function de(t){return"offset".concat(t)}function fe(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=Object(s.a)(t.shapeInfo.texShape,2),o=a[0],i=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var c=de(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(c,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=Object(s.a)(t.shapeInfo.texShape,2),l=u[0],d=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(l,", ").concat(d,", ").concat(c,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function pe(t,e){var n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(ye(t),"\n      }\n    ");var a=t.shapeInfo.texShape,o=a[0],i=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var c=de(n);return 1===i?e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(c,") + 0.5) / ").concat(o,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===o?e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(c,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):e?"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(c,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(i,", index + ").concat(c,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function he(t,e){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(null!=o&&u.util.arraysEqual(n,o)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var i=o[0],c=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(c,".0, ").concat(i,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var s=u.util.squeezeShape(n),l=s.newShape,d=s.keptDims,f=l;if(f.length<n.length){var p=je(t,f);return"\n      ".concat(oe(p,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Te(["row","col"],d),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(ye(t),"\n      }\n    ");var h=o[0],b=o[1],m=de(r);return 1===b?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):1===h?e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(b,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):e?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(m,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(b,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}function be(t,e){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],c=u.util.squeezeShape(n),s=c.newShape,l=c.keptDims,d=s;if(d.length<n.length){var f=je(t,d);return"\n        ".concat(oe(f,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Te(["row","col","depth"],l),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(i,", 1)));\n        ").concat(ye(t),"\n      }\n    ");var p=t.shapeInfo.texShape,h=p[0],b=p[1],m=t.shapeInfo.flatOffset;if(b===o&&null==m)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(b,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(b===i&&null==m)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(b,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var v=de(r);return e?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * ").concat(o," + col * ").concat(i," + depth + ").concat(v,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(i," + depth + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(b,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}function me(t,e){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,c=n[1]*i,s=u.util.squeezeShape(n),l=s.newShape,d=s.keptDims;if(l.length<n.length){var f=je(t,l);return"\n      ".concat(oe(f,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Te(["row","col","depth","depth2"],d),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(c,", ").concat(i,", ").concat(o,", 1)));\n        ").concat(ye(t),"\n      }\n    ");var p=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,b=h[0],m=h[1],v="int stride2 = ".concat(r,"Shape[3];"),g="int stride1 = ".concat(r,"Shape[2] * stride2;"),y="int stride0 = ".concat(r,"Shape[1] * stride1;");if(m===c&&null==p)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(v,"\n        ").concat(g,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(b,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(m===o&&null==p)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(b,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var x=de(r);return e?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(v,"\n      ").concat(g,"\n      ").concat(y,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(b,", ").concat(m,", index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}function ve(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],o=e[3]*a,i=e[2]*o,c=e[1]*i,s=u.util.squeezeShape(e),l=s.newShape,d=s.keptDims;if(l.length<e.length){var f=je(t,l);return"\n      ".concat(oe(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Te(["row","col","depth","depth2","depth3"],d),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(i,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(ye(t),"\n      }\n    ");var p=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,b=h[0],m=h[1];if(m===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(b,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(b,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var v=de(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(i," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(v,";\n      vec2 uv = uvFromFlat(").concat(b,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function ge(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=u.util.squeezeShape(e),o=a.newShape,i=a.keptDims;if(o.length<e.length){var c=je(t,o);return"\n      ".concat(oe(c),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Te(["row","col","depth","depth2","depth3","depth4"],i),");\n      }\n    ")}var s=e[5],l=e[4]*s,d=e[3]*l,f=e[2]*d,p=e[1]*f;if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(f,", ").concat(d,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(ye(t),"\n      }\n    ");var h=t.shapeInfo.flatOffset,b=t.shapeInfo.texShape,m=b[0],v=b[1];if(v===p&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(d,", ").concat(l,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===s&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=de(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(f," + depth * ").concat(d," +\n          depth2 * ").concat(l," + depth3 * ").concat(s," + depth4 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function ye(t){var e=t.name,n=u.util.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function xe(t,e){var n,r=t.name,a=r.charAt(0).toUpperCase()+r.slice(1),o="get"+a+"AtOutCoords",i=t.shapeInfo.logicalShape.length,c=e.logicalShape.length,s=re(t.shapeInfo.logicalShape,e.logicalShape),l=we(c),d=c-i,f=["x","y","z","w","u","v"];n=0===i?"":c<2&&s.length>=1?"coords = 0;":s.map((function(t){return"coords.".concat(f[t+d]," = 0;")})).join("\n");var p="";p=c<2&&i>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(f[e+d])})).join(", ");var h="return outputValue;",b=1===u.util.sizeFromShape(t.shapeInfo.logicalShape),m=1===u.util.sizeFromShape(e.logicalShape);if(1!==i||b||m){if(b&&!m)h=1===c?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var v=i-2,g=i-1;s.indexOf(v)>-1&&s.indexOf(g)>-1?h="return vec4(outputValue.x);":s.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(g)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(p,");\n      ").concat(h,"\n    }\n  ")}function Oe(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,c=t.shapeInfo.logicalShape.length,s=e.logicalShape.length;if(!t.shapeInfo.isUniform&&c===s&&null==t.shapeInfo.flatOffset&&u.util.arraysEqual(i,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,d=we(s),f=re(t.shapeInfo.logicalShape,e.logicalShape),p=s-c,h=["x","y","z","w","u","v"];l=0===c?"":s<2&&f.length>=1?"coords = 0;":f.map((function(t){return"coords.".concat(h[t+p]," = 0;")})).join("\n");var b="";return b=s<2&&c>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(h[e+p])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(d," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(r,"(").concat(b,");\n    }\n  ")}function we(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function ke(t,e,n){var r=u.util.squeezeShape(e).newShape,a=e.length,o=t&&3===a&&1===e[0],i=o?e.slice(1):r,c=!t&&a>1&&!u.util.arraysEqual(e,n)&&r.length<a||o;return{useSqueezeShape:c,uniformShape:c?i:e}}function je(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Te(t,e){return e.map((function(e){return t[e]})).join(", ")}function Se(t,e,n,r){var a=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=a.map((function(t){return t.shapeInfo})),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=ae(a,i,e),s=t.createProgram(c),l=null,d=t.getUniformLocation(s,"NAN",!1);1===Object(u.env)().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(s,"INFINITY",!1));for(var f,p,h,b=!1,m={},v={},g={},y=0;y<e.variableNames.length;y++){var x=e.variableNames[y];m[x]=t.getUniformLocation(s,x,b),m["offset".concat(x)]=t.getUniformLocation(s,"offset".concat(x),b),e.enableShapeUniforms&&(v["".concat(x,"Shape")]=t.getUniformLocation(s,"".concat(x,"Shape"),b),g["".concat(x,"TexShape")]=t.getUniformLocation(s,"".concat(x,"TexShape"),b))}e.enableShapeUniforms&&(f=t.getUniformLocation(s,"outShape",b),h=t.getUniformLocation(s,"outShapeStrides",b),p=t.getUniformLocation(s,"outTexShape",b));var O=[];return e.customUniforms&&e.customUniforms.forEach((function(e,n){O[n]=t.getUniformLocation(s,e.name,b)})),{program:e,source:c,webGLProgram:s,uniformLocations:m,customUniformLocations:O,inShapeInfos:o,outShapeInfo:i,infLoc:l,nanLoc:d,inShapesLocations:v,inTexShapesLocations:g,outShapeLocation:f,outShapeStridesLocation:h,outTexShapeLocation:p}}function Ne(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach((function(t,n){var r=t.logicalShape,a=e[n],o=a.shape;if(!u.util.arraysEqual(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(!t.isUniform||!a.isUniform){var i=t.texShape,c=a.isUniform?null:a.texData.texShape;if(!u.util.arraysEqual(i,c))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(i," and ").concat(c," must match"))}}))}function Ce(t,e,n,r,a){e.program.enableShapeUniforms||(Ne(e.inShapeInfos,n),Ne([e.outShapeInfo],[r]));var o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,i[0],i[1]):t.setOutputMatrixTexture(o,i[0],i[1]),t.setProgram(e.webGLProgram),1===Object(u.env)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var a=e.program.variableNames[r],o=e.uniformLocations[a],i=e.uniformLocations["offset".concat(a)],c=e.inShapesLocations["".concat(a,"Shape")],s=e.inTexShapesLocations["".concat(a,"TexShape")];if(c){var l=ke(e.program.packedInputs,n.shape,n.texData.texShape).uniformShape;switch(l.length){case 1:t.gl.uniform1iv(c,new Int32Array(l));break;case 2:t.gl.uniform2iv(c,new Int32Array(l));break;case 3:t.gl.uniform3iv(c,new Int32Array(l));break;case 4:t.gl.uniform4iv(c,new Int32Array(l))}}if(s&&t.gl.uniform2i(s,n.texData.texShape[0],n.texData.texShape[1]),null!=o)if(n.isUniform)if(u.util.sizeFromShape(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var d=n.uniformValues;d instanceof Float32Array||(d=new Float32Array(d)),t.gl.uniform1fv(o,d)}else null!=n.texData.slice&&null!=i&&t.gl.uniform1i(i,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)}));var c=e.outShapeLocation;if(c)switch(r.shape.length){case 1:t.gl.uniform1iv(c,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(c,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(c,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(c,new Int32Array(r.shape))}if(e.outShapeStridesLocation){var s=u.util.computeStrides(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(s));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(s));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(s))}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a&&e.program.customUniforms.forEach((function(n,r){var o=e.customUniformLocations[r],i=a[r];if("float"===n.type)t.gl.uniform1fv(o,i);else if("vec2"===n.type)t.gl.uniform2fv(o,i);else if("vec3"===n.type)t.gl.uniform3fv(o,i);else if("vec4"===n.type)t.gl.uniform4fv(o,i);else if("int"===n.type)t.gl.uniform1iv(o,i);else if("ivec2"===n.type)t.gl.uniform2iv(o,i);else if("ivec3"===n.type)t.gl.uniform3iv(o,i);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));t.gl.uniform4iv(o,i)}})),t.executeProgram()}function Ie(t,e,n){var r="";e.concat(n).forEach((function(e){var a=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){var o=e.texData.texShape,i=ke(t.packedInputs,e.shape,o),c=i.useSqueezeShape,s=i.uniformShape,l="",d="",f="";if(1===s.length&&t.packedInputs){var p=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];l="".concat(p[0]>1,"_").concat(p[1]>1)}else if(2!==s.length||t.packedInputs){if(s.length>2&&!t.packedInputs){var h=u.util.computeStrides(s);f="".concat(h[0]===o[1],"_").concat(h[h.length-1]===o[1])}}else d="".concat(s[0]>1,"_").concat(s[1]>1);var b=e.shape.length,m=2===b&&u.util.arraysEqual(e.shape,o),v=1===u.util.sizeFromShape(e.shape),g=u.backend_util.getBroadcastDims(e.shape,n.shape),y=!t.packedInputs&&b===n.shape.length&&u.util.arraysEqual(o,n.texData.texShape),x=t.packedInputs||b>2?"":"".concat(o[0]>1,"_").concat(o[1]>1);r+="".concat(b,"_").concat(y,"_").concat(c,"_").concat(s.length,"_").concat(v,"_").concat(g,"_").concat(m,"_").concat(l,"_").concat(d,"_").concat(f,"_").concat(x,"_").concat(a)}else{var O=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(O,"_").concat(a)}}));var a=t.userCode,o=t.constructor.name;return o+="_"+r+"_"+a+"".concat(Object(u.env)().getNumber("WEBGL_VERSION"))}function Ee(t){return Object(u.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}function Ae(t){return function(e,n,r,a,o){var i=u.backend_util.assertAndGetBroadcastShape(e,n),c=i.length,s=u.util.computeStrides(i),l=u.util.sizeFromShape(i),d=u.util.getTypedArrayFromDType(o,l),f=e.length,p=n.length,h=u.util.computeStrides(e),b=u.util.computeStrides(n),m=u.backend_util.getBroadcastDims(e,i),v=u.backend_util.getBroadcastDims(n,i);if(m.length+v.length===0)for(var g=0;g<d.length;++g)d[g]=t(r[g%r.length],a[g%a.length]);else for(var y=function(e){var n=u.util.indexToLoc(e,c,s),o=n.slice(-f);m.forEach((function(t){return o[t]=0}));var i=u.util.locToIndex(o,f,h),l=n.slice(-p);v.forEach((function(t){return l[t]=0}));var g=u.util.locToIndex(l,p,b);d[e]=t(r[i],a[g])},x=0;x<d.length;++x)y(x);return[d,i]}}function Re(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&u.util.assert("complex64"!==t.dtype,(function(){return"".concat(e," does not support complex64 tensors in the CPU backend.")}))}))}function _e(t){var e=t.inputs,n=t.backend,r=e.real,a=e.imag,o=n.data.get(r.dataId).values,i=n.data.get(a.dataId).values,c=n.makeTensorInfo(r.shape,"complex64");return n.data.get(c.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(a.shape,"float32",i)},c}u.Complex;function Fe(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=Fe(t,e,"float32"),a=Fe(t,e,"float32");return _e({inputs:{real:r,imag:a},backend:t})}var o=u.util.makeZerosTypedArray(u.util.sizeFromShape(e),n);return t.makeTensorInfo(e,n,o)}function De(t){var e=t.inputs,n=t.backend,r=e.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}u.Identity;function Me(t){var e=t.inputs,n=t.backend,r=e.input,a=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,o)}u.Real;function Pe(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.dtype;if("complex64"===o){if("complex64"===a.dtype)return De({inputs:{x:a},backend:n});var i=Fe(n,a.shape,a.dtype),c=Pe({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=_e({inputs:{real:c,imag:i},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),l}if("complex64"===a.dtype){var d=Me({inputs:{input:a},backend:n}),f=Pe({inputs:{x:d},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(d),f}if(!u.util.hasEncodingLoss(a.dtype,o)){var p=De({inputs:{x:a},backend:n});return{dataId:p.dataId,shape:p.shape,dtype:o}}if("int32"===o){var h=n.data.get(a.dataId).values,b=Int32Array.from(h);return n.makeTensorInfo(a.shape,"int32",b)}if("bool"===o){var m=n.data.get(a.dataId).values,v=u.util.toTypedArray([0],a.dtype),g=Ae((function(t,e){return t!==e?1:0}))(a.shape,[],m,v,"bool"),y=Object(s.a)(g,2),x=y[0],O=y[1];return n.makeTensorInfo(O,"bool",x)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(o))}u.Cast;function Le(t,e,n,r){return null==n?function(n){var a=n.inputs,o=n.backend,i=a.a,c=a.b,l=o;Re([i,c],t);var d=l.data.get(i.dataId).values,f=l.data.get(c.dataId).values,p="string"===i.dtype?u.backend_util.fromUint8ToStringArray(d):d,h="string"===i.dtype?u.backend_util.fromUint8ToStringArray(f):f,b=r||i.dtype,m=e(i.shape,c.shape,p,h,b),v=Object(s.a)(m,2),g=v[0],y=v[1];return l.makeTensorInfo(y,b,g)}:function(t){var a=t.inputs,o=t.backend,i=a.a,c=a.b,u=o;if("complex64"===i.dtype||"complex64"===c.dtype){var l=Pe({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),d=u.data.get(l.dataId),f=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,h=u.data.get(f.dataId).values,b=u.data.get(p.dataId).values,m=Pe({inputs:{x:c},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(m.dataId),g=v.complexTensorInfos.real,y=v.complexTensorInfos.imag,x=u.data.get(g.dataId).values,O=u.data.get(y.dataId).values,w=n(i.shape,c.shape,h,b,x,O),k=Object(s.a)(w,3),j=k[0],T=k[1],S=k[2],N=u.makeTensorInfo(S,"float32",j),C=u.makeTensorInfo(S,"float32",T),I=_e({inputs:{real:N,imag:C},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(N),u.disposeIntermediateTensorInfo(C),I}var E=u.data.get(i.dataId).values,A=u.data.get(c.dataId).values,R=r||i.dtype,_=e(i.shape,c.shape,E,A,R),F=Object(s.a)(_,2),D=F[0],M=F[1];return u.makeTensorInfo(M,R,D)}}function Be(t){return function(e,n,r,a,o,i){var c=u.backend_util.assertAndGetBroadcastShape(e,n),s=u.util.sizeFromShape(c),l=c.length,d=u.util.computeStrides(c),f=u.util.getTypedArrayFromDType("float32",s),p=u.util.getTypedArrayFromDType("float32",s),h=u.backend_util.getBroadcastDims(e,c),b=u.backend_util.getBroadcastDims(n,c),m=u.backend_util.mergeRealAndImagArrays(r,a),v=u.backend_util.mergeRealAndImagArrays(o,i),g=e.length,y=u.util.computeStrides(e),x=n.length,O=u.util.computeStrides(n);if(h.length+b.length===0)for(var w=0;w<f.length;w++){var k=w%m.length,j=w%v.length,T=t(m[2*k],m[2*k+1],v[2*j],v[2*j+1]);f[w]=T.real,p[w]=T.imag}else for(var S=function(e){var n=u.util.indexToLoc(e,l,d),r=n.slice(-g);h.forEach((function(t){return r[t]=0}));var a=u.util.locToIndex(r,g,y),o=n.slice(-x);b.forEach((function(t){return o[t]=0}));var i=u.util.locToIndex(o,x,O),c=t(m[2*a],m[2*a+1],v[2*i],v[2*i+1]);f[e]=c.real,p[e]=c.imag},N=0;N<f.length;N++)S(N);return[f,p,c]}}var Ve=Ae((function(t,e){return t+e})),ze=Be((function(t,e,n,r){return{real:t+n,imag:e+r}}));Le(u.Add,Ve,ze),u.Add;function Ue(t){return function(e,n,r){for(var a=u.util.getTypedArrayFromDType(n,e.length),o=0;o<e.length;++o)a[o]=t(e[o],r);return a}}function We(t,e,n){return function(r){var a=r.inputs,o=r.attrs,i=r.backend,c=a.x;if(Re(c,t),"string"===c.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=i,s=u.data.get(c.dataId).values,l=n||c.dtype,d=e(s,l,o);return u.makeTensorInfo(c.shape,l,d)}}var Ge=Ue((function(t){return Math.ceil(t)}));We(u.Ceil,Ge),u.Ceil;var He=Ae((function(t,e){return t===e?1:0})),qe=(Le(u.Equal,He,null,"bool"),u.Equal,Ue((function(t){return Math.exp(t)}))),Ke=(We(u.Exp,qe),u.Exp,Ue((function(t){return Math.expm1(t)}))),Xe=(We(u.Expm1,Ke),u.Expm1,Ue((function(t){return Math.floor(t)})));We(u.Floor,Xe),u.Floor;var Ye=Ae((function(t,e){return t>e?1:0})),Qe=(Le(u.Greater,Ye,null,"bool"),u.Greater,Ae((function(t,e){return t>=e?1:0}))),Ze=(Le(u.GreaterEqual,Qe,null,"bool"),u.GreaterEqual,Ae((function(t,e){return t<e?1:0}))),Je=(Le(u.Less,Ze,null,"bool"),u.Less,Ae((function(t,e){return t<=e?1:0})));Le(u.LessEqual,Je,null,"bool"),u.LessEqual;var $e=Ue((function(t){return Math.log(t)}));We(u.Log,$e),u.Log;var tn=Ae((function(t,e){return Math.max(t,e)})),en=(Le(u.Maximum,tn),u.Maximum,Ae((function(t,e){return Math.min(t,e)}))),nn=(Le(u.Minimum,en),u.Minimum,Ae((function(t,e){return t*e}))),rn=Be((function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}}));Le(u.Multiply,nn,rn),u.Multiply;function an(t,e,n){var r=u.util.createScalarValue(-1,n);return nn([],e,r,t,n)}u.Neg;var on=Ae((function(t,e){return t!==e?1:0}));Le(u.NotEqual,on,null,"bool"),u.NotEqual;function cn(t,e,n,r,a){for(var o=e.length,i=u.util.sizeFromShape(e),c=u.util.computeStrides(e),s=u.util.computeStrides(a),l=u.util.getTypedArrayFromDType(n,u.util.sizeFromShape(a)),d=0;d<i;++d){for(var f=u.util.indexToLoc(d,o,c),p=new Array(f.length),h=0;h<p.length;h++)p[h]=f[r[h]];l[u.util.locToIndex(p,o,s)]=t[d]}return l}u.Transpose;function un(t,e,n,r){for(var a=u.backend_util.computeOutAndReduceShapes(t,r),o=Object(s.a)(a,2),i=o[0],c=o[1],l=Object(u.upcastType)(e,"int32"),d=u.util.makeZerosTypedArray(u.util.sizeFromShape(i),l),f=u.util.sizeFromShape(c),p=0;p<d.length;++p){for(var h=p*f,b=1,m=0;m<f;++m)b*=n[h+m];d[p]=b}return{outVals:d,outShape:i,outDtype:l}}u.Prod;var sn=Ue((function(t){return 1/Math.sqrt(t)}));We(u.Rsqrt,sn),u.Rsqrt;function ln(t){for(var e=new Float32Array(t.length),n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}u.Abs;function dn(t,e,n,r,a){var o=u.slice_util.isSliceContinous(r,e,n),i=u.util.sizeFromShape(n),c=u.util.computeStrides(r);if(o){var s=u.slice_util.computeFlatOffset(e,c);return"string"===a?t.slice(s,s+i):t.subarray(s,s+i)}for(var l="string"===a?u.backend_util.fromUint8ToStringArray(t):t,d=Object(u.buffer)(r,a,l),p=Object(u.buffer)(n,a),h=0;h<p.size;++h){var b=p.indexToLoc(h),m=b.map((function(t,n){return t+e[n]}));p.set.apply(p,[d.get.apply(d,Object(f.a)(m))].concat(Object(f.a)(b)))}return"string"===a?u.backend_util.fromStringArrayToUint8(p.values):p.values}u.Slice;var fn=function(){function t(e,n,r,a,o,i){Object(h.a)(this,t),this.separator=u.util.encodeString(e),this.nGramWidths=n,this.leftPad=u.util.encodeString(r),this.rightPad=u.util.encodeString(a),this.padWidth=o,this.preserveShort=i}return Object(b.a)(t,[{key:"getPadWidth",value:function(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}},{key:"getNumNGrams",value:function(t,e){var n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}},{key:"createNGrams",value:function(t,e,n,r,a,o){for(var i=this,c=function(c){var u=i.getPadWidth(o),s=Math.max(0,u-c),l=Math.max(0,u-(a-(c+1))),d=o-(s+l),f=e+(s>0?0:c-u),p=0;p+=s*i.leftPad.length;for(var h=0;h<d;++h)p+=t[f+h].length;p+=l*i.rightPad.length,p+=(s+l+d-1)*i.separator.length,n[r+c]=new Uint8Array(p);for(var b=n[r+c],m=0,v=function(t){return t.forEach((function(t){return b[m++]=t}))},g=0;g<s;++g)v(i.leftPad),v(i.separator);for(var y=0;y<d-1;++y)v(t[f+y]),v(i.separator);if(d>0){v(t[f+d-1]);for(var x=0;x<l;++x)v(i.separator),v(i.rightPad)}else{for(var O=0;O<l-1;++O)v(i.rightPad),v(i.separator);v(i.rightPad)}},u=0;u<a;++u)c(u)}},{key:"compute",value:function(t,e){var n=this,r=t.length,a=e.length;if(a>0){var o=e[0];if(0!==o)throw new Error("First split value must be 0, got ".concat(o));for(var i=1;i<a;++i){var c=e[i]>=o;if(!(c=c&&e[i]<=r))throw new Error("Invalid split value ".concat(e[i],", must be in [").concat(o,", ").concat(r,"]"));o=e[i]}if(o!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(o))}var s=a-1,l=u.util.getArrayFromDType("int32",a);if(0===r||0===a){for(var d=new Array(r),f=0;f<=s;++f)l[f]=0;return[d,l]}l[0]=0;for(var p=function(t){var r=e[t]-e[t-1],a=0;n.nGramWidths.forEach((function(t){a+=n.getNumNGrams(r,t)})),n.preserveShort&&r>0&&0===a&&(a=1),l[t]=l[t-1]+a},h=1;h<=s;++h)p(h);for(var b=new Array(l[s]),m=function(r){var a=e[r],o=l[r];if(n.nGramWidths.forEach((function(i){var c=e[r+1]-e[r],u=n.getNumNGrams(c,i);n.createNGrams(t,a,b,o,u,i),o+=u})),n.preserveShort&&o===l[r]){var i=e[r+1]-e[r];if(0===i)return"continue";var c=i+2*n.padWidth;n.createNGrams(t,a,b,o,1,c)}},v=0;v<s;++v)m(v);return[b,l]}}]),t}();function pn(t,e,n){if(!t.length)return[];if(0===e.length){for(var r=new Array(t.length),a=0;a<t.length;++a)r[a]=t.subarray(a,a+1);return r}if(1===e.length){for(var o=e[0],i=[],c=t.indexOf(o);-1!==c;){var u=t.subarray(0,c);n&&0===u.length||i.push(u),c=(t=t.subarray(c+1)).indexOf(o)}return n&&0===t.length||i.push(t),i}for(var s=[],l=0,d=0;d<t.length+1;d++)if(d===t.length||-1!==e.indexOf(t[d])){var f=t.subarray(l,d);n&&0===f.length||s.push(f),l=d+1}return s}var hn=Ae((function(t,e){return t-e})),bn=Be((function(t,e,n,r){return{real:t-n,imag:e-r}}));Le(u.Sub,hn,bn),u.Sub;var mn=function(t,e){var n=e.value-t.value;return 0===n?t.index-e.index:n};function vn(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;r>n;){if(r-n>600){var a=r-n+1,o=e-n+1,i=Math.log(a),c=.5*Math.exp(2*i/3),s=.5*Math.sqrt(i*c*(a-c)/a)*Math.sign(o-a/2),l=Math.max(n,Math.floor(e-o*c/a+s)),d=Math.min(r,Math.floor(e+(a-o)*c/a+s));vn(t,e,l,d)}var f=t[e],p=n,h=r;for(u.util.swap(t,n,e),mn(t[r],f)>0&&u.util.swap(t,n,r);p<h;){for(u.util.swap(t,p,h),p++,h--;mn(t[p],f)<0;)p+=1;for(;mn(t[h],f)>0;)h-=1}0===mn(t[n],f)?u.util.swap(t,n,h):(h+=1,u.util.swap(t,h,r)),h<=e&&(n=h+1),e<=h&&(r=h-1)}}var gn=Ve,yn=function(t,e,n,r,a){for(var o=u.util.sizeFromShape(r),i=u.util.makeZerosTypedArray(a,n),c=0;c<t.length;c++){var s=t[c];if(s<0)throw new Error("Input x must be non-negative!");s>=a||(i[s]+=o>0?e[c]:1)}return i},xn=function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t.shape[0],o=t.shape[1],i=Object(u.buffer)([a,n],e.dtype),c=0;c<a;c++)for(var s=0;s<o;s++){var l=t.get(c,s);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?i.set(1,c,l):e.size>0?i.set(i.get(c,l)+e.get(c,s),c,l):i.set(i.get(c,l)+1,c,l))}return i},On=Ge,wn=function(t,e,n,r){var a=u.util.getArrayFromDType(n,u.util.sizeFromShape(e));if(r&&"string"!==n){var o=0;t.forEach((function(t){var e=u.util.sizeFromShape(t.shape);a.set(t.vals,o),o+=e}))}else{var i=0;t.forEach((function(t){for(var r="string"===n?u.backend_util.fromUint8ToStringArray(t.vals):t.vals,o=0,c=0;c<t.shape[0];++c)for(var s=c*e[1]+i,l=0;l<t.shape[1];++l)a[s+l]=r[o++];i+=t.shape[1]}))}return a},kn=He,jn=qe,Tn=Ke,Sn=Xe,Nn=function(t,e,n,r,a,o,i,c,s){for(var l=Object(u.buffer)([r,o],n),d=0;d<r;d++){for(var p=[],h=0,b=0;b<a;b++){var m=t[d*a+b];h+=m*i[b],p.push(m)}if(h<0||h>=s/o)throw new Error("Invalid indices: ".concat(p," does not index into ").concat(c));for(var v=0;v<o;v++)l.values[d*o+v]=e.get.apply(e,Object(f.a)(e.indexToLoc(h*o+v)))}return l},Cn=function(t,e,n){for(var r=Object(u.buffer)(n,t.dtype),a=0;a<r.size;++a){var o=r.indexToLoc(a).slice(),i=o[0],c=o[2],s=e.locToIndex([i,c]);o[2]=e.values[s];var l=t.locToIndex(o);r.values[a]=t.values[l]}return r},In=Ye,En=Qe,An=Ze,Rn=Je,_n=function(t,e,n){var r=(e-t)/(n-1),a=u.util.makeZerosTypedArray(n,"float32");a[0]=t;for(var o=1;o<a.length;o++)a[o]=a[o-1]+r;return a},Fn=$e,Dn=function(t,e,n,r){for(var a=u.util.getTypedArrayFromDType(r,u.util.sizeFromShape(n)),o=0;o<a.length;++o){for(var i=o*e,c=t[i],s=0;s<e;++s){var l=t[i+s];(Number.isNaN(l)||l>c)&&(c=l)}a[o]=c}return a},Mn=tn,Pn=en,Ln=nn,Bn=an,Vn=on,zn=un,Un=function(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return u.util.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((e-t)/n)),o=u.util.makeZerosTypedArray(a,r);e<t&&1===n&&(n=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return o},Wn=sn,Gn=ln,Hn=dn,qn=function(t,e,n,r,a,o,i){var c=e[0],s=o[0],l=new Array(s),d=new Array(c),f=e[1];if(0===s){if(0!==c)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n         indices.shape[0] = ".concat(c));return[u.util.getArrayFromDType(n,0),[0,f],u.util.getArrayFromDType(a,0),l,d]}for(var p=!0,h=0,b=new Array(s).fill(0),m=0;m<c;++m){var v=t[m*f];if(v<0)throw new Error("indices(".concat(m,", 0) is invalid: ").concat(v," < 0"));if(v>=s)throw new Error("indices(".concat(m,", 0) is invalid: ").concat(v," >= ").concat(s));++b[v],p=p&&v>=h,h=v}for(var g=!0,y=0;y<s;++y){var x=0===b[y];l[y]=x,g=g&&!x,b[y]=Math.max(b[y],1),y>0&&(b[y]+=b[y-1])}if(g&&p){for(var O=t,w=r,k=0;k<c;++k)d[k]=k;return[O,[c,f],w,l,d]}for(var j=b[s-1],T=u.util.getArrayFromDType(n,j*f),S=u.util.getArrayFromDType(a,j),N=new Array(s).fill(0),C=0;C<c;++C){var I=t[C*f],E=N[I],A=(0===I?0:b[I-1])+E;N[I]++;for(var R=0;R<f;++R)T[A*f+R]=t[C*f+R];S[A]=r[C],d[C]=A}for(var _=0;_<s;++_){if(0===N[_]){var F=0===_?0:b[_-1];T[F*f+0]=_;for(var D=1;D<f;++D)T[F*f+D]=0;S[F]=i}}return[T,[j,f],S,l,d]},Kn=function(t,e,n,r,a){for(var o=u.util.sizeFromShape(r),i=e[0],c=a.length,s=[],l=1,d=-1,f=0;f<c;++f){var p=a[f];if(-1===p){if(-1!==d)throw new Error("only one output dimension may be -1, not both ".concat(d," and ").concat(f));d=f,s.push(1)}else{if(p<0)throw new Error("size ".concat(f," must be non-negative, not ").concat(p));l*=p,s.push(p)}}if(-1!==d){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var h=Math.trunc(o/l);if(l*h!==o)throw new Error("Input to reshape is a SparseTensor with ".concat(o,"\n          dense values, but the requested shape requires a multiple of ").concat(l,". inputShape=").concat(r," outputShape= ").concat(s));s[d]=h}var b=u.util.sizeFromShape(s);if(b!==o)throw new Error("Input to reshape is a tensor with ".concat(o," dense values, but the requested shape has ").concat(b,". inputShape=").concat(r," outputShape=").concat(s));var m=r.length,v=[];if(m>0){v[m-1]=1;for(var g=m-2;g>=0;--g)v[g]=v[g+1]*r[g+1]}var y=[];if(c>0){y[c-1]=1;for(var x=c-2;x>=0;--x)y[x]=y[x+1]*s[x+1]}for(var O=u.util.getArrayFromDType(n,i*c),w=0;w<i;++w){for(var k=0,j=0;j<m;++j)k+=t[w*m+j]*v[j];for(var T=0;T<c;++T)O[w*c+T]=Math.trunc(k/y[T]),k%=y[T]}return[O,[i,c],s]},Xn=function(t,e,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=r.length;if(c!==a.length)throw new Error("segmentIds and indices should have same size.");var s=[e[0],t.length/e[0]],l=s[1],d=c>0?a[c-1]+1:0,f=d;if(f<0)throw new Error("segment ids must be >= 0");var p=e.slice();p[0]=f;var h=p.reduce((function(t,e){return t*e}),1),b=u.util.getArrayFromDType(n,h);if(0===c)return f>0&&b.fill(i),[b,p];if(f<=0)throw new Error("segment ids must be >= 0");for(var m=0,v=1,g=0,y=a[m];;){var x=0;if(v<c){if(y===(x=a[v])){++v;continue}if(y>=x)throw new Error("segment ids are not increasing")}if(y<0||y>=f)throw new Error("Segment id ".concat(y," out of range [0, ").concat(f,"), possibly because segmentIds input is not sorted."));y>g&&b.fill(i,g*l,y*l);for(var O=m;O<v;++O){var w=r[O];if(w<0||w>=s[0])throw new Error("Bad: indices[".concat(O,"] == ").concat(r[O]," out of range [0, ").concat(s[0],")"));for(var k=0;k<l;k++)b[y*l+k]+=t[w*l+k]}if(o)for(var j=0;j<l;j++)b[y*l+j]/=v-m;if(m=v,g=y+1,y=x,++v>c)break}return g<f&&b.fill(i,g*l,f*l),[b,p]},Yn=function(t,e,n,r){for(var a=Object(u.buffer)(t,e.dtype),o=0;o<a.size;o++){for(var i=a.indexToLoc(o),c=new Array(i.length),s=0;s<c.length;s++)c[s]=i[s]*n[s]+r[s];a.set.apply(a,[e.get.apply(e,c)].concat(Object(f.a)(i)))}return a},Qn=function(t,e,n,r,a,o,i,c){return new fn(n,r,a,o,i,c).compute(t,e)},Zn=function(t,e,n){for(var r=t.length,a=[],o=0,i=0,c=new Array(r),s=0;s<r;++s){var l=pn(t[s],e,n),d=l.length;c[s]=d,o+=d,i=Math.max(i,d),a.push.apply(a,Object(f.a)(l))}for(var p=u.util.getArrayFromDType("int32",2*o),h=new Array(o),b=[r,i],m=0,v=0;v<r;++v)for(var g=0;g<c[v];++g)p[2*m]=v,p[2*m+1]=g,h[m]=a[m],++m;return[p,h,b]},Jn=function(t,e){for(var n=u.util.getArrayFromDType("int32",t.length),r=0;r<t.length;++r)n[r]=u.util.fingerPrint64(t[r]).modulo(e).getLowBitsUnsigned();return n},$n=hn,tr=function(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];for(var a=Object(u.buffer)(n,t.dtype),o=0;o<a.values.length;++o){for(var i=a.indexToLoc(o),c=new Array(t.rank),s=0;s<c.length;s++)c[s]=i[s]%t.shape[s];var l=t.locToIndex(c);a.values[o]=t.values[l]}return a},er=function(t,e,n,r,a){for(var o=e[e.length-1],i=t.length/o,c=o,s=u.util.getTypedArrayFromDType(n,i*r),l=u.util.getTypedArrayFromDType("int32",i*r),d=function(e){var n=e*c,o=t.subarray(n,n+c),i=new Array(o.length);o.forEach((function(t,e){return i[e]={value:t,index:e}})),r<i.length&&(vn(i,r),i=i.slice(0,r)),a&&i.sort(mn);for(var u=e*r,d=s.subarray(u,u+r),f=l.subarray(u,u+r),p=0;p<r;p++)d[p]=i[p].value,f[p]=i[p].index},f=0;f<i;f++)d(f);var p=e.slice();return p[p.length-1]=r,[Object(u.buffer)(p,n,s),Object(u.buffer)(p,"int32",l)]},nr=cn,rr=function(t,e,n,r){for(var a=u.util.parseAxisParam(e,n)[0],o=[1,n[0],1],i=0;i<a;i++)o[0]*=n[i];o[1]=n[a];for(var c=a+1;c<n.length;c++)o[2]*=n[c];for(var s={},l=new Int32Array(n[a]),d=new u.TensorBuffer(o,r,t),f=[],p=1===o[0]&&1===o[2],h=0;h<n[a];h++){var b=void 0;if(p)b=t[h].toString();else{for(var m=[],v=0;v<o[0];v++)for(var g=0;g<o[2];g++)m.push(d.get(v,h,g));b=m.join(",")}if(void 0!==s[b])l[h]=s[b];else{var y=Object.keys(s).length;s[b]=y,l[h]=y,f.push(h)}}var x=o.slice();x[1]=Object.keys(s).length;var O=new u.TensorBuffer(x,r);f.forEach((function(t,e){for(var n=0;n<o[0];n++)for(var r=0;r<o[2];r++)O.set(d.get(n,t,r),n,e,r)}));var w=n.slice();return w[a]=x[1],{outputValues:O.values,outputShape:w,indices:l}};function ar(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return"".concat(t,".").concat(e)}))}function or(t,e){return 1===e?[t]:ar(t,e)}var ir=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var n=e.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=or("rc",n),a=we(n),o=function(t,e,n){if(1===t)return"rc > ".concat(e[0]);for(var r="",a=t-2;a<t;a++)r+="".concat(n[a]," >= ").concat(e[a]),a<t-1&&(r+="||");return r}(n,e,r),i=function(t,e,n,r){if(1===t)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(e,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,e[e.length-1],e[e.length-2],r),c=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var o="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),i=2;i<t;i++)o="".concat(e[e.length-1-i],",")+o;n.push(o)}return n}(n,e);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(t[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(e,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(o,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(c,"));\n          }\n        }\n      ")}};var cr=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r="",a=0;a<4;a++){var o="thisRC = rc;";a%2===1&&(o+="thisRC.z += 1;"),a>1&&(o+="thisRC.y += 1;"),r+="\n        ".concat(o,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t){var e=jt(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(e,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(St(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(e[1],";\n        int cols = ").concat(e[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")};var ur=function(){function t(e){Object(h.a)(this,t),this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return Object(b.a)(t,[{key:"acquireTexture",value:function(t,e,n){var r=lr(e,n),a=dr(t,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var o,i=sr(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();var u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}return r===c.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===c.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===c.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===c.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===c.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}},{key:"releaseTexture",value:function(t,e,n,r){if(null!=this.freeTextures){var a=lr(n,r),o=dr(e,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);var i=sr(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=Object(u.env)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=i):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;var s=this.usedTextures[o],l=s.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));var e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),t}();function sr(t,e,n,r,a){var o,i=function(t,e){switch(t){case c.PACKED_2X2_FLOAT32:return Gt(e);case c.PACKED_2X2_FLOAT16:return qt(e);case c.UNPACKED_FLOAT32:return Lt(e);case c.UNPACKED_FLOAT16:return Vt(e);case c.PACKED_4X1_UNSIGNED_BYTE:return Ut(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);if(a){var u=T(t[0],t[1]),l=Object(s.a)(u,2);o=l[0]*l[1]}else{var d=k(t[0],t[1]),f=Object(s.a)(d,2);o=f[0]*f[1]}return o*function(t,e){var n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(e))}(n,i)}function lr(t,e){if(t===i.UPLOAD)return c.PACKED_2X2_FLOAT32;if(t===i.RENDER||null==t)return function(t){return Object(u.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?c.PACKED_2X2_FLOAT32:c.UNPACKED_FLOAT32:t?c.PACKED_2X2_FLOAT16:c.UNPACKED_FLOAT16}(e);if(t===i.DOWNLOAD||t===i.PIXELS)return c.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function dr(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}var fr=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Ee(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},pr="if (isnan(x)) return x;",hr="return x;",br="return abs(x);";var mr="return (x >= 0.0) ? x : (exp(x) - 1.0);",vr=pr+"\n  return (x < 0.0) ? 0.0 : x;\n",gr=pr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",yr="return x;",xr="return 1.0 / (1.0 + exp(-1.0 * x));",Or="return x;",wr="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kr="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",jr="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Tr="return 1.0 / (1.0 + exp(-1.0 * x));",Sr=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Ee(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},Nr=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var n=e.length,r=or("rc",n),a=we(n),o=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(n,r),i=r.slice(-2),c=n<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(o,");\n\n        setOutput(getChannel(packedInput, ").concat(c,"));\n      }\n    ")},Cr=u.kernel_impls.whereImpl,Ir={};var Er=Object(u.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var Ar=function(t){Object(v.a)(n,t);var e=Object(g.a)(n);function n(t){var r,a;if(Object(h.a)(this,n),(r=e.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Object(u.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var o=w(Object(u.env)().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Object(u.env)().getNumber("WEBGL_VERSION"))in Ir||(Ir[a]={}),Ir[a]),r.gpgpu=new ne(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new ur(r.gpgpu),r.numMBBeforeWarning=null==Object(u.env)().global.screen?1024:Object(u.env)().global.screen.height*Object(u.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new u.DataStorage(Object(m.a)(r),Object(u.engine)()),r}return Object(b.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"write",value:function(t,e,n){if((Object(u.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(u.env)().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:i.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(t){return this.texData.has(t)?this.texData.get(t).refCount:0}},{key:"incRef",value:function(t){this.texData.get(t).refCount++}},{key:"decRef",value:function(t){this.texData.has(t)&&this.texData.get(t).refCount--}},{key:"move",value:function(t,e,n,r,a){if(Object(u.env)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:i.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(t){this.disposeData(t.dataId)}},{key:"readSync",value:function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,a=e.complexTensorInfos,o=e.slice,i=e.shape,c=e.isPacked;if(null!=o){var s;s=c?new Sr(i,yr):new fr(i,yr);var l=this.runWebGLProgram(s,[{dataId:t,shape:i,dtype:r}],r),d=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),d}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var f,p,h=null!=this.activeTimers;if(h&&(f=u.util.now()),"complex64"===r){var b=this.readSync(a.real.dataId),m=this.readSync(a.imag.dataId);p=u.backend_util.mergeRealAndImagArrays(b,m)}else p=this.getValuesFromTexture(t);return h&&(this.downloadWaitMs+=u.util.now()-f),this.convertAndCacheOnCPU(t,p)}},{key:"read",value:function(){var t=Object(p.a)(d.a.mark((function t(e){var n,r,a,o,i,c,s,l,p,h,b,m,v,g,y,x,O,w,k,T,S,C,I;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.pendingRead.has(e)){t.next=3;break}return n=this.pendingRead.get(e),t.abrupt("return",new Promise((function(t){return n.push(t)})));case 3:if(r=this.texData.get(e),a=r.values,o=r.shape,i=r.slice,c=r.dtype,s=r.complexTensorInfos,l=r.isPacked,null==i){t.next=11;break}return p=l?new Sr(o,yr):new fr(o,yr),h=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:c}],c),b=this.read(h.dataId),this.disposeIntermediateTensorInfo(h),t.abrupt("return",b);case 11:if(null==a){t.next=13;break}return t.abrupt("return",this.convertAndCacheOnCPU(e));case 13:if(Object(u.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Object(u.env)().getNumber("WEBGL_VERSION")){t.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(m=null,"complex64"!==c&&Object(u.env)().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(e),y=this.texData.get(v.dataId),m=(g=this.gpgpu).createBufferFromTexture.apply(g,[y.texture].concat(Object(f.a)(j(o))))),this.pendingRead.set(e,[]),"complex64"===c){t.next=21;break}return t.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==c){t.next=30;break}return t.next=24,Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]);case 24:O=t.sent,w=O[0],k=O[1],x=u.backend_util.mergeRealAndImagArrays(w,k),t.next=31;break;case 30:null==m?x=this.getValuesFromTexture(e):(T=u.util.sizeFromShape(o),x=this.gpgpu.downloadFloat32MatrixFromBuffer(m,T));case 31:return null!=v&&this.disposeIntermediateTensorInfo(v),null!=m&&N(S=this.gpgpu.gl,(function(){return S.deleteBuffer(m)})),C=this.convertAndCacheOnCPU(e,x),I=this.pendingRead.get(e),this.pendingRead.delete(e),I.forEach((function(t){return t(C)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Object(u.engine)().removeDataId(e,this),this.pendingDeletes--),t.abrupt("return",C);case 39:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"bufferSync",value:function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return u.util.decodeString(t)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(u.buffer)(t.shape,t.dtype,n)}},{key:"checkNumericalProblems",value:function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!C(n)){if(Object(u.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(t){var e=this.texData.get(t),n=e.shape,r=e.dtype,a=e.isPacked,o=u.util.sizeFromShape(n);if(Object(u.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var i,c=this.decode(t),s=this.texData.get(c.dataId),l=(i=this.gpgpu).downloadMatrixFromPackedTexture.apply(i,[s.texture].concat(Object(f.a)(j(n)))).subarray(0,o);return this.disposeIntermediateTensorInfo(c),l}var d=Object(u.env)().getBool("WEBGL_PACK")&&!0===a,p=d?it(n):n,h=d?new At(p):new Et(p),b=this.runWebGLProgram(h,[{shape:p,dtype:r,dataId:t}],"float32"),m=this.texData.get(b.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(b),v}},{key:"timerAvailable",value:function(){return Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(){var t=Object(p.a)(d.a.mark((function t(e){var n,r,a,o,i,c,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e(),o=u.util.flatten(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),i=u.util.flatten(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=n,a&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){t.next=19;break}return t.next=14,Promise.all(o);case 14:s=t.sent,c.kernelMs=u.util.sum(s),c.getExtraProfileInfo=function(){return s.map((function(t,e){return{name:i[e],ms:t}})).map((function(t){return"".concat(t.name,": ").concat(t.ms)})).join(", ")},t.next=20;break;case 19:c.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,t.abrupt("return",c);case 23:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:u.util.now(),endMs:null}}},{key:"endTimer",value:function(t){return Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=u.util.now(),t)}},{key:"getQueryTime",value:function(){var t=Object(p.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Object(u.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){t.next=2;break}return t.abrupt("return",this.gpgpu.waitForQueryAndGetTime(e));case 2:return n=e,t.abrupt("return",n.endMs-n.startMs);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"disposeData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);var n=this.texData.get(t),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,e),this.disposeData(r.imag.dataId,e)),this.texData.delete(t),!0}},{key:"releaseGPUData",value:function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,a=e.texShape,o=e.usage,i=e.isPacked,c=e.slice,u=c&&c.origDataId||t,s=this.dataRefCount.get(u);s>1?this.dataRefCount.set(u,s-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,o,i)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(t){return this.uploadToGPU(t),this.texData.get(t).texture}},{key:"getDataInfo",value:function(t){return this.texData.get(t)}},{key:"shouldExecuteOnCPU",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er;return Object(u.env)().getBool("WEBGL_CPU_FORWARD")&&t.every((function(t){return null==e.texData.get(t.dataId).texture&&u.util.sizeFromShape(t.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(t){u.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return Cr(t.shape,e)}},{key:"packedUnaryOp",value:function(t,e,n){var r=new Sr(t.shape,e),a=this.compileAndRun(r,[t],n);return Object(u.engine)().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}},{key:"abs",value:function(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){var e=Gn(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(Object(u.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,br,t.dtype);var n=new fr(t.shape,br),r=this.compileAndRun(n,[t]);return Object(u.engine)().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}},{key:"makeTensorInfo",value:function(t,e,n){var r;if("string"===e&&null!=n&&n.length>0&&u.util.isString(n[0])){var a=n.map((function(t){return u.util.encodeString(t)}));r=this.write(a,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}},{key:"makeOutput",value:function(t,e,n){var r=this.makeTensorInfo(t,e,n).dataId;return Object(u.engine)().makeTensorFromDataId(r,t,e,this)}},{key:"unpackTensor",value:function(t){var e=new Nr(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}},{key:"packTensor",value:function(t){var e=new ir(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}},{key:"packedReshape",value:function(t,e){var n=[at(t.shape)].concat(Object(f.a)(ot(t.shape))),r={dtype:t.dtype,shape:n,dataId:t.dataId},a=[at(e)].concat(Object(f.a)(ot(e))),o=new cr(a,n),i=this.runWebGLProgram(o,[r],t.dtype,null,!0);return{dataId:i.dataId,shape:e,dtype:i.dtype}}},{key:"decode",value:function(t){var e,n=this.texData.get(t),r=n.isPacked,a=n.shape,o=n.dtype,i=it(a);e=r?new It(i):new Ct(i);return{dtype:o,shape:a,dataId:this.runWebGLProgram(e,[{shape:i,dtype:o,dataId:t}],o,null,!0).dataId}}},{key:"runWebGLProgram",value:function(t,e,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(c.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===o.DENSE){var l=j(t.outputShape);s.texShape=l.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===u.util.sizeFromShape(c.shape))return s.values=u.util.getTypedArrayFromDType(c.dtype,0),c;var d=[],f=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&u.util.sizeFromShape(e.shape)<=Object(u.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!==!!t.packedInputs)e=n.isPacked?a.unpackTensor(e):a.packTensor(e),d.push(e),n=a.texData.get(e.dataId);else if(n.isPacked&&!st(n.shape,e.shape)){var r=e,o=e.shape;e.shape=n.shape,e=a.packedReshape(e,o),d.push(e),n=a.texData.get(e.dataId),r.shape=o}return a.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(c.dataId);var p,h={shape:c.shape,texData:s,isUniform:!1},b=Ie(t,f,h),m=this.getAndSaveBinary(b,(function(){return Se(a.gpgpu,t,f,h)})),v=null!=this.activeTimers;v&&(p=this.startTimer()),Ce(this.gpgpu,m,f,h,r),d.forEach((function(t){return a.disposeIntermediateTensorInfo(t)})),v&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)}));var g=Object(u.env)().get("WEBGL_FLUSH_THRESHOLD");if(g>0){var y=u.util.now();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!Object(u.env)().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var x=this.unpackTensor(c);return this.disposeIntermediateTensorInfo(c),x}return c}},{key:"compileAndRun",value:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;var o=this.runWebGLProgram(t,e,n,r,a);return o}},{key:"getAndSaveBinary",value:function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var t=this;if(!this.disposed){if(!Object(u.env)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(u.tidy)((function(){if(!Object(u.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=Object(u.env)().getBool("DEBUG");Object(u.env)().set("DEBUG",!1);var n=t.abs(Object(u.scalar)(1e-8)).dataSync()[0];if(Object(u.env)().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(t){var e=this.texData.get(t),n=e.shape,r=e.dtype,a=e.values,o=e.texture,c=e.usage,l=e.isPacked;if(null==o){var d,f=null!=this.activeTimers;f&&(d=u.util.now());var p=e.texShape;if(null==p&&(p=ct(n,l),e.texShape=p),null!=a){var h,b=it(n),m=p[1],v=p[0],g=a instanceof Uint8Array;if(l){var y=T(p[0],p[1]),x=Object(s.a)(y,2);m=x[0],v=x[1],h=new _t(b,[v,m],g)}else h=new Rt(b,[v,m],g);var O=this.makeTensorInfo([v,m],r);this.texData.get(O.dataId).usage=g?i.PIXELS:i.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(O.dataId),m,v,a);var w=this.runWebGLProgram(h,[O],r,null,!0),k=this.texData.get(w.dataId);e.texture=k.texture,e.texShape=k.texShape,e.isPacked=k.isPacked,e.usage=k.usage,this.disposeIntermediateTensorInfo(O),this.texData.delete(w.dataId),e.values=null,f&&(this.uploadWaitMs+=u.util.now()-d)}else{var j=this.acquireTexture(p,c,r,l);e.texture=j}}}},{key:"convertAndCacheOnCPU",value:function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}},{key:"acquireTexture",value:function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}},{key:"computeBytes",value:function(t,e){return t[0]*t[1]*u.util.bytesPerElement(e)}}]),n}(u.KernelBackend);Ar.nextDataId=0;var Rr="3.8.0";function _r(){Object(u.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}u.device_util.isBrowser()&&Object(u.registerBackend)("webgl",(function(){return new Ar}),2);var Fr={forceHalfFloat:_r},Dr=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["A","B"],this.outputShape=u.backend_util.assertAndGetBroadcastShape(n,r),this.enableShapeUniforms=Ee(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},Mr=function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(h.a)(this,t),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=u.backend_util.assertAndGetBroadcastShape(n,r);var o=this.outputShape.length;this.enableShapeUniforms=Ee(o);var i="";if(a)if(0===o||1===u.util.sizeFromShape(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var c=we(o);if(i="\n          ".concat(c," coords = getOutputCoords();\n        "),1===o)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=or("coords",o);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(s[o-2]," + 1) >= outShape[").concat(o," - 2];\n            bool nextColOutOfBounds =\n              (").concat(s[o-1]," + 1) >= outShape[").concat(o," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(s[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")};function Pr(t){var e=t.inputs,n=t.backend,r=e.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Lr={kernelName:u.Identity,backendName:"webgl",kernelFunc:Pr};function Br(t){var e=t.inputs,n=t.backend,r=e.real,a=e.imag,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),c=Pr({inputs:{x:r},backend:n}),u=Pr({inputs:{x:a},backend:n});return i.complexTensorInfos={real:c,imag:u},o}var Vr={kernelName:u.Complex,backendName:"webgl",kernelFunc:Br},zr="return (a < 0.) ? b * a : a;",Ur="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Wr={kernelName:u.LeakyRelu,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.alpha,i=n.makeTensorInfo([],"float32",u.util.createScalarValue(o,"float32")),c=Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(Ur,a.shape,i.shape):new Dr(zr,a.shape,i.shape),s=n.runWebGLProgram(c,[a,i],a.dtype);return n.disposeIntermediateTensorInfo(i),s}},Gr="return (a < 0.) ? b * a : a;",Hr="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var qr={kernelName:u.Prelu,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=e.alpha,o=Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(Hr,r.shape,a.shape):new Dr(Gr,r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)}};function Kr(t){var e=t.opSnippet,n=t.packedOpSnippet,r=t.cpuKernelImpl,a=t.dtype;return function(t){var o,i=t.inputs,c=t.backend,s=i.x,l=c,d=a||s.dtype;if(l.shouldExecuteOnCPU([s])&&null!=r){var f=l.texData.get(s.dataId),p=r(f.values,d);return l.makeTensorInfo(s.shape,d,p)}return o=Object(u.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Sr(s.shape,n):new fr(s.shape,e),l.runWebGLProgram(o,[s],d)}}function Xr(t){var e=t.opSnippet,n=t.packedOpSnippet,r=t.checkOutOfBounds,a=void 0!==r&&r,o=t.supportsComplex,i=void 0!==o&&o,c=t.cpuKernelImpl,l=t.dtype;return function(t){var r=t.inputs,o=t.backend,d=r.a,f=r.b,p=o;if(i&&"complex64"===d.dtype){var h=p.texData.get(d.dataId),b=p.texData.get(f.dataId),m=[[h.complexTensorInfos.real,b.complexTensorInfos.real],[h.complexTensorInfos.imag,b.complexTensorInfos.imag]].map((function(t){var n=Object(s.a)(t,2),r=n[0],a=n[1],o={dataId:r.dataId,dtype:r.dtype,shape:d.shape},i={dataId:a.dataId,dtype:a.dtype,shape:f.shape},c=new Dr(e,d.shape,f.shape);return p.runWebGLProgram(c,[o,i],Object(u.upcastType)(r.dtype,a.dtype))})),v=Object(s.a)(m,2),g=v[0],y=v[1],x=Br({inputs:{real:g,imag:y},backend:p});return p.disposeIntermediateTensorInfo(g),p.disposeIntermediateTensorInfo(y),x}var O,w=l||Object(u.upcastType)(d.dtype,f.dtype);if(("string"===d.dtype||"string"===f.dtype||p.shouldExecuteOnCPU([d,f]))&&null!=c){var k=p.texData.get(d.dataId).values,j=p.texData.get(f.dataId).values,T="string"===d.dtype?u.backend_util.fromUint8ToStringArray(k):k,S="string"===d.dtype?u.backend_util.fromUint8ToStringArray(j):j,N=c(d.shape,f.shape,T,S,w),C=Object(s.a)(N,2),I=C[0],E=C[1],A=p.makeTensorInfo(E,w);return p.texData.get(A.dataId).values=I,A}return O=Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new Mr(n,d.shape,f.shape,a):new Dr(e,d.shape,f.shape),p.runWebGLProgram(O,[d,f],w)}}function Yr(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return e?Or:hr;if("relu"===t)return e?kr:vr;if("elu"===t)return e?wr:mr;if("relu6"===t)return e?jr:gr;if("prelu"===t)return e?Hr:Gr;if("leakyrelu"===t)return e?Ur:zr;if("sigmoid"===t)return e?Tr:xr;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}var Qr=function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Object(h.a)(this,t),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var l=a?e[1]:e[2],d=Math.ceil(l/2),f=a?"i * 2, rc.y":"rc.y, i * 2",p=o?"rc.z, i * 2":"i * 2, rc.z",b=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],v="",g="";c&&(v=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(c,"\n        }"):s?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(c,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(c,"\n        }"),g="result = activation(result);");var y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha");var x="rc.x",O="rc.x";e[0]<n[0]?x="int(min(float(rc.x), ".concat(e[0]-1,".))"):n[0]<e[0]&&(O="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(v,"\n\n      const float sharedDimension = ").concat(d,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(d,"; i++) {\n          int batchA = ").concat(x,";\n          int batchB = ").concat(O,";\n          vec4 a = getMatrixA(batchA, ").concat(f,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(b[0]," * ").concat(m[0],");\n          result += (").concat(b[1]," * ").concat(m[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")},Zr="return areal * breal - aimag * bimag;",Jr="return areal * bimag + aimag * breal;",$r=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=u.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},ta="return a * b;";function ea(t){var e,n=t.inputs,r=t.backend,a=n.a,o=n.b,i=u.backend_util.upcastType(a.dtype,o.dtype);if("complex64"===a.dtype){var c=r.texData.get(a.dataId),l=r.texData.get(o.dataId),d=new $r(Zr,a.shape,o.shape),f=new $r(Jr,a.shape,o.shape),p=[{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:a.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],h=r.runWebGLProgram(d,p,"float32"),b=r.runWebGLProgram(f,p,"float32"),m=Br({inputs:{real:h,imag:b},backend:r});return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(b),m}if(r.shouldExecuteOnCPU([a,o])){var v=r.texData.get(a.dataId),g=r.texData.get(o.dataId),y=Ln(a.shape,o.shape,v.values,g.values,i),x=Object(s.a)(y,2),O=x[0],w=x[1],k=r.makeTensorInfo(w,i);return r.texData.get(k.dataId).values=O,k}return e=Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(ta,a.shape,o.shape):new Dr(ta,a.shape,o.shape),r.runWebGLProgram(e,[a,o],i)}var na={kernelName:u.Multiply,backendName:"webgl",kernelFunc:ea};function ra(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.shape,i=n,c=u.util.sizeFromShape(a.shape),s=u.util.inferFromImplicitShape(o,c),l=u.util.sizeFromShape(s);u.util.assert(c===l,(function(){return"The new shape (".concat(s,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements."}));var d=i.texData.get(a.dataId);return!d.isPacked||st(a.shape,s)||null!==d.texture&&st(d.shape,s)?(i.incRef(a.dataId),{dataId:a.dataId,shape:s,dtype:a.dtype}):function(t,e,n){var r=[at(t.shape)].concat(Object(f.a)(ot(t.shape))),a={dtype:t.dtype,shape:r,dataId:t.dataId},o=[at(e)].concat(Object(f.a)(ot(e))),i=new cr(o,r),c=n.runWebGLProgram(i,[a],t.dtype,null,!0);return{dataId:c.dataId,shape:e,dtype:c.dtype}}(a,s,i)}var aa={kernelName:u.Reshape,backendName:"webgl",kernelFunc:ra},oa=function t(e,n){Object(h.a)(this,t),this.variableNames=["x"];var r=e.windowSize,a=e.batchSize,o=e.inSize,i=e.outSize;this.outputShape=[a,i];var c=4*Math.floor(r/4),s=r%4,l="sumValue += dot(values, ones);";if(null!=n){var d=1/n;l="sumValue += dot(values * ".concat(u.util.isInt(d)?d.toPrecision(2):d,", ones);")}var f="";o%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},ia=function t(e,n){Object(h.a)(this,t),this.variableNames=["x"];var r=e.windowSize,a=e.batchSize,o=e.inSize,i=e.outSize;this.outputShape=[a,i];var c="0.0",u="";"prod"===n?c="1.0":"min"===n?(c="1.0 / 1e-20",u="min"):"max"===n&&(c="-1.0 / 1e-20",u="max");var s="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?s="sumValue":"prod"===n?s="prodValue":"all"===n?s="allValue":"any"===n&&(s="anyValue");var l=4*Math.floor(r/4),d=r%4,f="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),p="vec4";"all"===n?(c="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===n&&(c="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var b="";o%r>0&&(b="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(c,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(b,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(c,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat(s,");\n      }\n    ")};function ca(t,e,n,r){for(var a=function(t){for(var e=[];0===e.length||1!==e[e.length-1].outSize;){var n=e.length?e[e.length-1].outSize:t[1],r=u.backend_util.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape),o=t,i=0;i<a.length;i++){var c,s=a[i],l=s.inSize,d=s.windowSize,f=s.outSize,p=void 0;p="mean"===n?0===i?new oa({windowSize:d,inSize:l,batchSize:t.shape[0],outSize:f},l):new oa({windowSize:d,inSize:l,batchSize:t.shape[0],outSize:f}):new ia({windowSize:d,inSize:l,batchSize:t.shape[0],outSize:f},n),c=o,o=r.runWebGLProgram(p,[o],e),c.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(c)}return o}var ua=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"];for(var r=new Array(e.length),a=0;a<r.length;a++)r[a]=e[n[a]];this.outputShape=r,this.rank=r.length;var o=we(this.rank),i=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(o," resRC = getOutputCoords();\n      setOutput(getA(").concat(i,"));\n    }\n    ")};var sa=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(e.length),a=0;a<r.length;a++)r[a]=e[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var o=we(this.rank),i=ar("rc",this.rank),c=new Array(this.rank),u=0;u<n.length;u++)c[n[u]]=i[u];var s="vec2(".concat(c.slice(-2).join(),")"),l="++".concat(i[this.rank-1]," < ").concat(r[this.rank-1]),d="getChannel(getA(".concat(c.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(o," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(d,";\n      if(").concat(l,") {\n        result[1] = ").concat(d,";\n      }\n      --").concat(i[this.rank-1],";\n      if(++").concat(i[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(d,";\n        if(").concat(l,") {\n          result[3] = ").concat(d,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function la(t,e,n){var r=Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sa(t.shape,e):new ua(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}function da(t){var e=t.inputs,n=t.backend,r=t.attrs;return function(t,e,n,r){var a=e,o=t.shape.length,i=u.util.parseAxisParam(a,t.shape),c=i,l=u.backend_util.getAxesPermutation(c,o),d=null!=l,f=t;d&&(f=la(t,l,r),c=u.backend_util.getInnerMostAxes(c.length,o)),u.backend_util.assertAxesAreInnerMostDims("sum",c,o);var p=u.backend_util.computeOutAndReduceShapes(f.shape,c),h=Object(s.a)(p,2),b=h[0],m=h[1],v=b;n&&(v=u.backend_util.expandShapeToKeepDim(b,i));var g=u.util.sizeFromShape(m),y=ra({inputs:{x:f},attrs:{shape:[u.util.sizeFromShape(t.shape)/g,g]},backend:r}),x=ca(y,Object(u.sumOutType)(t.dtype),"sum",r),O=ra({inputs:{x:x},attrs:{shape:v},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),d&&r.disposeIntermediateTensorInfo(f),O}(e.x,r.axis,r.keepDims,n)}var fa={kernelName:u.Sum,backendName:"webgl",kernelFunc:da};function pa(t){for(var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=a.perm,c=r,u=o.shape.length,s=new Array(u),l=0;l<s.length;l++)s[l]=o.shape[i[l]];if(c.shouldExecuteOnCPU([o])){var d=c.texData.get(o.dataId).values,f=nr(d,o.shape,o.dtype,i,s);e=c.makeTensorInfo(s,o.dtype),c.texData.get(e.dataId).values=f}else e=la(o,i,c);return e}var ha={kernelName:u.Transpose,backendName:"webgl",kernelFunc:pa};function ba(t){var e=t.a,n=t.b,r=t.transposeA,a=t.transposeB,o=t.backend,i=t.bias,c=void 0===i?null:i,s=t.preluActivationWeights,l=void 0===s?null:s,d=t.leakyreluAlpha,f=void 0===d?0:d,p=t.activation,h=void 0===p?null:p,b=e.shape.length,m=n.shape.length,v=r?e.shape[b-2]:e.shape[b-1],g=a?n.shape[m-1]:n.shape[m-2],y=r?e.shape[b-1]:e.shape[b-2],x=a?n.shape[m-2]:n.shape[m-1],O=e.shape.slice(0,-2),w=n.shape.slice(0,-2),k=u.util.sizeFromShape(O),j=u.util.sizeFromShape(w),T=k===j||1===k||1===j;u.util.assert(b>=2&&m>=2&&T,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(O,") and (").concat(w,").")}));var S=(k>j?e.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,x]);u.util.assert(v===g,(function(){return"Error in matMul: inner shapes (".concat(v,") and (")+"".concat(g,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var N,C=r?[k,v,y]:[k,y,v],I=a?[j,x,g]:[j,g,x],E=ra({inputs:{x:e},backend:o,attrs:{shape:C}}),A=ra({inputs:{x:n},backend:o,attrs:{shape:I}}),R=[E,A],_=Math.max(k,j),F=r?E.shape[1]:E.shape[2],D=null!=c,M=null!=l,P="leakyrelu"===h,L=null!=h?Yr(h,!0):null;if((1===y||1===x)&&F>1e3&&!1===(D||M||P||null!=L)){var B=E,V=A;r&&(B=pa({inputs:{x:E},backend:o,attrs:{perm:[0,2,1]}}),R.push(B)),a&&(V=pa({inputs:{x:A},backend:o,attrs:{perm:[0,2,1]}}),R.push(V));var z=1===x,U=B;1!==x&&(U=ra({inputs:{x:B},backend:o,attrs:{shape:[_,F,1]}}),R.push(U));var W=1===x?2:1,G=V;z&&(G=ra({inputs:{x:V},backend:o,attrs:{shape:[_,1,F]}}),R.push(G));var H=ea({inputs:{a:U,b:G},backend:o});N=da({inputs:{x:H},backend:o,attrs:{axis:W,keepDims:!0}}),R.push(H)}else{var q=Object(u.upcastType)(e.dtype,n.dtype),K=new Qr(C,I,[_,y,x],r,a,D,L,M,P),X=[E,A];if(null!=c&&X.push(c),M&&X.push(l),P){var Y=o.makeTensorInfo([],"float32",u.util.createScalarValue(f,"float32"));X.push(Y),R.push(Y)}N=o.runWebGLProgram(K,X,q)}var Q=ra({inputs:{x:N},backend:o,attrs:{shape:S}});R.push(N);for(var Z=0,J=R;Z<J.length;Z++){var $=J[Z];o.disposeIntermediateTensorInfo($)}return Q}var ma={kernelName:u._FusedMatMul,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.a,o=e.b,i=e.bias,c=e.preluActivationWeights,u=r.transposeA,s=r.transposeB,l=r.activation;return ba({a:a,b:o,transposeA:u,transposeB:s,backend:n,bias:i,preluActivationWeights:c,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},va="return abs(x);";var ga={kernelName:u.Abs,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var o=r.texData.get(a.dataId),i=Gn(o.values);return r.makeTensorInfo(a.shape,a.dtype,i)}return e=Object(u.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Sr(a.shape,va):new fr(a.shape,va),r.runWebGLProgram(e,[a],a.dtype)}},ya=Kr({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),xa={kernelName:u.Acos,backendName:"webgl",kernelFunc:ya},Oa=Kr({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),wa={kernelName:u.Acosh,backendName:"webgl",kernelFunc:Oa},ka="return a + b;",ja=Xr({opSnippet:ka,packedOpSnippet:ka,supportsComplex:!0,cpuKernelImpl:gn}),Ta={kernelName:u.Add,backendName:"webgl",kernelFunc:ja},Sa=function t(e,n){Object(h.a)(this,t),this.outputShape=[],this.outputShape=e,this.variableNames=n.map((function(t,e){return"T".concat(e)}));var r=[];this.variableNames.forEach((function(t){r.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));var a=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},Na=function t(e,n){Object(h.a)(this,t),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((function(t,e){return"T".concat(e)}));var r=[];this.variableNames.forEach((function(t){r.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));var a=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};var Ca={kernelName:u.AddN,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,r=e.backend,a=n;if(1===a.length)return Pr({inputs:{x:a[0]},backend:r});if(a.length>Object(u.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(a.length/2),i=t({inputs:a.slice(0,o),backend:r}),c=t({inputs:a.slice(o),backend:r});return t({inputs:[i,c],backend:r})}var s=a.map((function(t){return t.dtype})).reduce((function(t,e){return Object(u.upcastType)(t,e)})),l=a.map((function(t){return t.shape})),d=Object(u.env)().getBool("WEBGL_PACK")?new Na(a[0].shape,l):new Sa(a[0].shape,l);return r.runWebGLProgram(d,a,s)}};var Ia={kernelName:u.All,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=r.keepDims,c=a.shape.length,l=u.util.parseAxisParam(o,a.shape),d=l,f=u.backend_util.getAxesPermutation(d,c),p=a;null!=f&&(p=pa({inputs:{x:a},backend:n,attrs:{perm:f}}),d=u.backend_util.getInnerMostAxes(d.length,c)),u.backend_util.assertAxesAreInnerMostDims("all",d,c);var h,b=u.backend_util.computeOutAndReduceShapes(p.shape,d),m=Object(s.a)(b,2),v=m[0],g=m[1],y=ra({inputs:{x:p},backend:n,attrs:{shape:[-1,u.util.sizeFromShape(g)]}}),x=ca(y,y.dtype,"all",n);return h=ra(i?{inputs:{x:x},backend:n,attrs:{shape:u.backend_util.expandShapeToKeepDim(v,l)}}:{inputs:{x:x},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=f&&n.disposeIntermediateTensorInfo(p),h}};var Ea={kernelName:u.Any,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=r.keepDims,c=a.shape.length,l=u.util.parseAxisParam(o,a.shape),d=l,f=u.backend_util.getAxesPermutation(d,c),p=a;null!=f&&(p=pa({inputs:{x:a},backend:n,attrs:{perm:f}}),d=u.backend_util.getInnerMostAxes(d.length,c)),u.backend_util.assertAxesAreInnerMostDims("any",d,c);var h,b=u.backend_util.computeOutAndReduceShapes(p.shape,d),m=Object(s.a)(b,2),v=m[0],g=m[1],y=ra({inputs:{x:p},backend:n,attrs:{shape:[-1,u.util.sizeFromShape(g)]}}),x=ca(y,y.dtype,"any",n);return h=ra(i?{inputs:{x:x},backend:n,attrs:{shape:u.backend_util.expandShapeToKeepDim(v,l)}}:{inputs:{x:x},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=f&&n.disposeIntermediateTensorInfo(p),h}},Aa=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["A"];var a=e.windowSize,o=e.batchSize,i=e.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];var c="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(c," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},Ra=function t(e,n,r,a){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,u.util.assert(e.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");var c,s,l=this.outputShape,d=l.length,f=we(d),p=or("coords",d);if(1===i){var b=we(s=d+1);c="\n        ".concat(b," sourceLocR = ").concat(b,"(").concat(p.join(),", 0);\n        ++").concat(p[d-1],";\n        ").concat(b," sourceLocG = ").concat(b,"(").concat(p.join(),", 0);\n        ++").concat(p[d-2],";\n        ").concat(b," sourceLocA = ").concat(b,"(").concat(p.join(),", 0);\n        --").concat(p[d-1],";\n        ").concat(b," sourceLocB = ").concat(b,"(").concat(p.join(),", 0);\n        --").concat(p[d-2],";")}else s=d,c="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(p[d-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(p[d-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(p[d-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(p[d-2],";");var m=["x","y","z","w","u","v"].slice(0,s),v="."+m[s-1],g=m.map((function(t){return"int "+t})),y=or("sourceLocR",s-1).concat("inIdx.r"),x=or("sourceLocG",s-1).concat("inIdx.g"),O=or("sourceLocB",s-1).concat("inIdx.b"),w=or("sourceLocA",s-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",j=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(O.join(),"),\n                             getBestIndicesAChannel(").concat(w.join(),")));"),T="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(O.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(w.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(m.join(),"),\n                                          vec2(").concat(m.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(m.join(),"),\n                               vec2(").concat(m.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[d-1]," < ").concat(l[d-1]-1,";\n        bool hasNextRow = ").concat(p[d-2]," < ").concat(l[d-2]-1,";\n        ").concat(c,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(T,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(j,"\n          vec4 candidate = ").concat(T,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function _a(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.shape[0],o=e.shape[1];null!=r&&(a=r.shape[0],o=r.shape[1]);var i=u.backend_util.computeOptimalWindowSize(o),c={windowSize:i,inSize:o,batchSize:a,outSize:Math.ceil(o/i)},s=new Aa(c,n,null==r),l=[e];null!=r&&l.push(r);var d=t.runWebGLProgram(s,l,"int32");if(1===d.shape[1])return d;var f=_a(t,e,n,d);return t.disposeIntermediateTensorInfo(d),f}function Fa(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:e.shape,o=a[a.length-1],i=u.backend_util.computeOptimalWindowSize(o),c=new Ra(a,i,n,null==r),s=null==r?[e]:[e,r],l=t.runWebGLProgram(c,s,"int32");if(l.shape.length===e.shape.length){var d=Fa(t,e,n,l);return t.disposeIntermediateTensorInfo(l),d}return l}function Da(t,e,n,r){var a=[n];if(u.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!Object(u.env)().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){var o=[],i=u.backend_util.computeOutAndReduceShapes(e.shape,a),c=Object(s.a)(i,2),l=c[0],d=c[1],f=u.util.sizeFromShape(d),p=ra({inputs:{x:e},backend:t,attrs:{shape:[-1,f]}});o.push(p);var h=_a(t,p,r);o.push(h);var b=ra({inputs:{x:h},backend:t,attrs:{shape:l}});return o.forEach((function(e){return t.disposeIntermediateTensorInfo(e)})),b}return Fa(t,e,r)}var Ma={kernelName:u.ArgMax,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=u.util.parseAxisParam(o,a.shape),c=u.backend_util.getAxesPermutation(i,a.shape.length),s=a,l=[];null!=c&&(s=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(s),i=u.backend_util.getInnerMostAxes(i.length,s.shape.length)),u.backend_util.assertAxesAreInnerMostDims("argMax",[i[0]],s.shape.length);var d=Da(n,s,i[0],"max");return l.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),d}};var Pa={kernelName:u.ArgMin,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=u.util.parseAxisParam(o,a.shape),c=u.backend_util.getAxesPermutation(i,a.shape.length),s=a,l=[];null!=c&&(s=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(s),i=u.backend_util.getInnerMostAxes(i.length,s.shape.length)),u.backend_util.assertAxesAreInnerMostDims("argMin",[i[0]],s.shape.length);var d=Da(n,s,i[0],"min");return l.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),d}},La=Kr({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Ba={kernelName:u.Asin,backendName:"webgl",kernelFunc:La},Va=Kr({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),za={kernelName:u.Asinh,backendName:"webgl",kernelFunc:Va},Ua=Kr({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),Wa={kernelName:u.Atan,backendName:"webgl",kernelFunc:Ua},Ga=Xr({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Ha={kernelName:u.Atan2,backendName:"webgl",kernelFunc:Ga},qa=Kr({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Ka={kernelName:u.Atanh,backendName:"webgl",kernelFunc:qa},Xa=function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(h.a)(this,t),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,c=e.strideHeight,u=e.strideWidth,s=e.dilationHeight,l=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;var m="avg"===n,v="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),y="0.0";if(m||(y="-1.0 / 1e-20"),r){var x=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(b,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(s,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(x," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?o?v:g:"wR * ".concat(f," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var O="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var k=4*Math.floor(i/4),j=i%4,T="\n      if (".concat(m,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(O,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(c,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(b,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(s,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(k,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(T,"\n          }\n\n          int xC = xCCorner + ").concat(k,";\n          if (").concat(1===j,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(T,"\n          } else if (").concat(2===j,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(T,"\n          } else if (").concat(3===j,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(T,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}},Ya=function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(h.a)(this,t),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,c=e.strideDepth,u=e.strideHeight,s=e.strideWidth,l=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,p=e.effectiveFilterDepth,b=e.effectiveFilterHeight,m=e.effectiveFilterWidth,v=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;var x="avg"===n,O="0.0";if(x||(O="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(c,", ").concat(u,", ").concat(s,");\n        const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(b,";\n                wR += ").concat(d,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(m,";\n                  wC += ").concat(f,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?o?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(b," * ").concat(m," +\n                      wR * ").concat(m," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",j="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(j="avgValue / count");var T=4*Math.floor(i/4),S=i%4,N="\n      if (".concat(x,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(c,", ").concat(u,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(O,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(O,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(b,";\n            wR += ").concat(d,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(T,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(f,", ch)\n              );\n\n              ").concat(N,"\n            }\n\n            int xC = xCCorner + ").concat(T,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                initializationValue\n              );\n\n              ").concat(N,"\n            }\n          }\n          setOutput(").concat(j,");\n        }\n      }\n    ")}};var Qa={kernelName:u.AvgPool,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x;Ot(a,"avgPool");var o=r.filterSize,i=r.strides,c=r.pad,s=r.dimRoundingMode;u.util.assert(u.backend_util.eitherStridesOrDilationsAreOne(i,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")}));var l=u.backend_util.computePool2DInfo(a.shape,o,i,1,c,s);if(1===l.filterWidth&&1===l.filterHeight&&u.util.arraysEqual(l.inShape,l.outShape))return Pr({inputs:{x:a},backend:n});var d=new Xa(l,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}};var Za={kernelName:u.AvgPool3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.filterSize,i=r.strides,c=r.pad,s=r.dimRoundingMode,l=r.dataFormat,d=u.backend_util.computePool3DInfo(a.shape,o,i,[1,1,1],c,s,l),f=new Ya(d,"avg",!1);return n.runWebGLProgram(f,[a],"float32")}},Ja=function t(e){Object(h.a)(this,t),this.variableNames=["dy"],this.outputShape=e.inShape;var n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,s=e.effectiveFilterWidth,l=u-1-e.padInfo.top,d=s-1-e.padInfo.left,f=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(d,");\n      const float avgMultiplier = float(").concat(f,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(s,";\n            wC+= ").concat(c,") {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},$a=function t(e){Object(h.a)(this,t),this.variableNames=["dy"],this.outputShape=e.inShape;var n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,b=d-1-e.padInfo.front,m=f-1-e.padInfo.top,v=p-1-e.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(b,", ").concat(m,", ").concat(v,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(o,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(s,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var to={kernelName:u.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.input,i=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode,d=u.backend_util.computePool3DInfo(o.shape,i,c,[1,1,1],s,l),f=new $a(d);return n.runWebGLProgram(f,[a],o.dtype)}};var eo={kernelName:u.AvgPoolGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.input,i=o;Ot([a,o],"avgPoolGrad");var c=r.filterSize,s=r.strides,l=r.pad,d=u.backend_util.computePool2DInfo(i.shape,c,s,1,l),f=new Ja(d);return n.runWebGLProgram(f,[a],i.dtype)}};var no={kernelName:u.BatchMatMul,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;return ba({a:e.a,b:e.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},ro=function t(e,n,r,a,o,i){Object(h.a)(this,t),this.outputShape=[],this.variableNames=["x","mean","variance"],u.backend_util.assertAndGetBroadcastShape(e,n),u.backend_util.assertAndGetBroadcastShape(e,r);var c="0.0";null!=a&&(u.backend_util.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var s="1.0";null!=o&&(u.backend_util.assertAndGetBroadcastShape(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(c,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},ao=function t(e,n,r,a,o,i){Object(h.a)(this,t),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],u.backend_util.assertAndGetBroadcastShape(e,n),u.backend_util.assertAndGetBroadcastShape(e,r);var c="vec4(0.0)";null!=a&&(u.backend_util.assertAndGetBroadcastShape(e,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(u.backend_util.assertAndGetBroadcastShape(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(c,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},oo={kernelName:u.FusedBatchNorm,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.mean,i=e.variance,c=e.offset,s=e.scale;u.util.assert(o.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),u.util.assert(null==c||o.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),u.util.assert(null==s||o.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=r.varianceEpsilon;null==l&&(l=.001);var d=[a,o,i],f=null;null!=c&&(f=c.shape,d.push(c));var p=null;null!=s&&(p=s.shape,d.push(s));var h=Object(u.env)().getBool("WEBGL_PACK_NORMALIZATION")?new ao(a.shape,o.shape,i.shape,f,p,l):new ro(a.shape,o.shape,i.shape,f,p,l);return n.runWebGLProgram(h,d,d[0].dtype)}},io=function t(e){Object(h.a)(this,t),this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n=we(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(t){if(1===t)return"sourceLoc";if(t<=6)return co.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank),o=e.map((function(t,e){return"sourceLoc.".concat(co[e]," = start[").concat(e,"] + coords.").concat(co[e],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")},co=["x","y","z","w","u","v"];var uo=function t(e){Object(h.a)(this,t),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=we(this.rank),r=or("coords",this.rank),a=or("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(o,")"),c="\n      result.x = ".concat(i,";\n      if (++").concat(r[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(r[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),s=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(e.map((function(t,e){return"start[".concat(e,"]")})).join(),");"):e.map((function(t,e){return"".concat(a[e]," = ").concat(r[e]," + start[").concat(e,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(s,"\n        vec4 result = vec4(0.);\n        ").concat(c,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")};function so(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.begin,i=r.size,c=u.slice_util.parseSliceParams(a,o,i),l=Object(s.a)(c,2),d=l[0],f=l[1];if(u.slice_util.assertParamsValid(a,d,f),0===u.util.sizeFromShape(f))return n.makeTensorInfo(f,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var p=n.texData.get(a.dataId),h=Hn(p.values,d,f,a.shape,a.dtype);return n.makeTensorInfo(f,a.dtype,h)}var b=n.texData.get(a.dataId).isPacked,m=u.slice_util.isSliceContinous(a.shape,d,f);if(b||!m){var v=Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uo(f):new io(f),g=[d];return n.runWebGLProgram(v,[a],a.dtype,g)}return n.uploadToGPU(a.dataId),function(t,e,n,r){var a=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,a),i.refCount=1,i.shape=n,i.dtype=t.dtype;var c=u.slice_util.computeFlatOffset(e,u.util.computeStrides(t.shape));a.slice&&(c+=a.slice.flatOffset),i.slice={flatOffset:c,origDataId:a.slice&&a.slice.origDataId||t.dataId};var s=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,s+1),o}(a,d,f,n)}var lo={kernelName:u.Slice,backendName:"webgl",kernelFunc:so},fo={kernelName:u.BatchToSpaceND,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.blockShape,i=r.crops;u.util.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var c=o.reduce((function(t,e){return t*e})),s=u.backend_util.getReshaped(a.shape,o,c),l=u.backend_util.getPermuted(s.length,o.length),d=u.backend_util.getReshapedPermuted(a.shape,o,c),f=u.backend_util.getSliceBeginCoords(i,o.length),p=u.backend_util.getSliceSize(d,i,o.length),h=[],b=ra({inputs:{x:a},backend:n,attrs:{shape:s}}),m=pa({inputs:{x:b},backend:n,attrs:{perm:l}}),v=ra({inputs:{x:m},backend:n,attrs:{shape:d}}),g=so({inputs:{x:v},backend:n,attrs:{begin:f,size:p}});return h.push(b),h.push(m),h.push(v),h.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),g}};var po={kernelName:u.Bincount,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.weights,i=r.size,c=n.readSync(a.dataId),u=n.readSync(o.dataId),s=yn(c,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,s)}},ho=Xr({opSnippet:"return float(a != b);",cpuKernelImpl:Vn,dtype:"bool"}),bo={kernelName:u.NotEqual,backendName:"webgl",kernelFunc:ho};function mo(t){var e=t.inputs,n=t.backend,r=e.input;return Pr({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var vo={kernelName:u.Real,backendName:"webgl",kernelFunc:mo};var go={kernelName:u.Cast,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,r=e.backend,a=e.attrs,o=n.x,i=a.dtype;if("complex64"===i){if("complex64"===o.dtype)return Pr({inputs:{x:o},backend:r});var c=u.zeros(o.shape),s=t({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),l=Br({inputs:{real:s,imag:c},backend:r});return c.dispose(),r.disposeIntermediateTensorInfo(s),l}if("complex64"===o.dtype){var d=mo({inputs:{input:o},backend:r}),f=t({inputs:{x:d},backend:r,attrs:{dtype:i}});return r.disposeIntermediateTensorInfo(d),f}if(!u.util.hasEncodingLoss(o.dtype,i)){var p=Pr({inputs:{x:o},backend:r});return{dataId:p.dataId,shape:p.shape,dtype:i}}if("int32"===i)return function(t,e){var n=new fr(t.shape,"return float(int(x));"),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===i){var h=r.makeTensorInfo([],"bool",u.util.getTypedArrayFromDType("bool",1)),b=ho({inputs:{a:o,b:h},backend:r});return r.disposeIntermediateTensorInfo(h),b}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(i))}},yo="return ceil(x);",xo=Kr({opSnippet:yo,packedOpSnippet:yo,cpuKernelImpl:On}),Oo={kernelName:u.Ceil,backendName:"webgl",kernelFunc:xo},wo=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "},ko=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "};var jo={kernelName:u.ClipByValue,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=a.clipValueMin,c=a.clipValueMax;e=Object(u.env)().getBool("WEBGL_PACK_CLIP")?new ko(o.shape):new wo(o.shape);var s=[[i],[c]];return r.runWebGLProgram(e,[o],o.dtype,s)}},To=function t(e){Object(h.a)(this,t),this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function So(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}var No={kernelName:u.ComplexAbs,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=n.texData.get(r.dataId),o=new To(r.shape),i=[So(r,a.complexTensorInfos.real),So(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}},Co=function t(e){Object(h.a)(this,t),this.outputShape=[],this.outputShape=u.backend_util.computeOutShape(e,1),this.variableNames=e.map((function(t,e){return"T".concat(e)}));var n=new Array(e.length-1);n[0]=e[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+e[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],o=1;o<n.length;o++){var i=n[o-1];a.push("else if (yC < ".concat(n[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(i,"));"))}var c=n.length,s=n[n.length-1];a.push("else setOutput(getT".concat(c,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")},Io=function t(e,n){Object(h.a)(this,t),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=u.backend_util.computeOutShape(e,n);var r=this.outputShape,a=r.length,o=we(a),i=or("coords",a),c=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((function(t,e){return"T".concat(e)}));var s=new Array(e.length-1);s[0]=e[0][n];for(var l=1;l<s.length;l++)s[l]=s[l-1]+e[l][n];for(var d=c[n],f=c.slice(-2),p=c.join(),b="if (".concat(d," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(f.join(),"));\n        }"),m=1;m<s.length;m++){var v=s[m-1];b+="\n        if (".concat(d," < ").concat(s[m],"  && ").concat(d," >= ").concat(s[m-1],") {\n          return getChannel(\n            getT").concat(m,"(").concat(Eo(c,d,v),"),\n            vec2(").concat(Eo(f,d,v),"));\n        }")}var g=s.length,y=s[s.length-1];b+="\n        return getChannel(\n          getT".concat(g,"(").concat(Eo(c,d,y),"),\n          vec2(").concat(Eo(f,d,y),"));"),this.userCode="\n      float getValue(".concat(c.map((function(t){return"int "+t})),") {\n        ").concat(b,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(r[a-2]," &&\n            ").concat(i[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")};function Eo(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?"".concat(t," - ").concat(n):t})).join()}function Ao(t){var e=t.inputs,n=t.backend,r=e.input;return Pr({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var Ro={kernelName:u.Imag,backendName:"webgl",kernelFunc:Ao};function _o(t,e,n){var r=t[0].dtype;if("complex64"===r){var a=t.map((function(t){return mo({inputs:{input:t},backend:n})})),o=t.map((function(t){return Ao({inputs:{input:t},backend:n})})),i=_o(a,e,n),c=_o(o,e,n),s=Br({inputs:{real:i,imag:c},backend:n});return a.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),o.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),s}var l=n.shouldExecuteOnCPU(t);if("string"===r&&(l=!0),l){var d=t.map((function(t){var r=u.util.sizeFromShape(t.shape.slice(e));return ra({inputs:{x:t},backend:n,attrs:{shape:[-1,r]}})})),f=d.map((function(t){return{vals:n.readSync(t.dataId),shape:t.shape}})),p=u.backend_util.computeOutShape(d.map((function(t){return t.shape})),1),h=1===d[0].shape[0],b=wn(f,p,r,h),m=u.backend_util.computeOutShape(t.map((function(t){return t.shape})),e),v=n.makeTensorInfo(m,r,b);return d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),v}if(t.length>Object(u.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var g=Math.floor(t.length/2),y=_o(t.slice(0,g),e,n),x=_o(t.slice(g),e,n),O=_o([y,x],e,n);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),O}if(Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){var w=new Io(t.map((function(t){return t.shape})),e);return n.runWebGLProgram(w,t,r)}var k=function(t,e,n){var r=u.backend_util.computeOutShape(t.map((function(t){return t.shape})),e);return{tensors2D:t.map((function(t){return ra({inputs:{x:t},attrs:{shape:[-1,u.util.sizeFromShape(t.shape.slice(e))]},backend:n})})),outShape:r}}(t,e,n),j=k.tensors2D,T=k.outShape,S=new Co(j.map((function(t){return t.shape}))),N=n.runWebGLProgram(S,j,r);j.forEach((function(t){return n.disposeIntermediateTensorInfo(t)}));var C=ra({inputs:{x:N},attrs:{shape:T},backend:n});return n.disposeIntermediateTensorInfo(N),C}function Fo(t){var e=t.inputs,n=t.backend,r=t.attrs.axis,a=u.util.parseAxisParam(r,e[0].shape)[0],o=u.backend_util.computeOutShape(e.map((function(t){return t.shape})),a);if(0===u.util.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);var i=e.filter((function(t){return u.util.sizeFromShape(t.shape)>0}));if(1===i.length)return Pr({inputs:{x:i[0]},backend:n});var c=i.map((function(t){return t.shape}));return u.backend_util.assertParamsConsistent(c,a),_o(i,a,n)}var Do={kernelName:u.Concat,backendName:"webgl",kernelFunc:Fo},Mo=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,c=e.padInfo.left,u=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,b=4*Math.floor(e.inChannels/4),m=e.inChannels%4,v="channelsLast"===e.dataFormat,g=v?1:2,y=v?2:3,x=v?3:1,O="",w="";r&&(O=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):o?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(O,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(x,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(f,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(b,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===m,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(b,") *\n                    getW(wR, wC, ").concat(b,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(b,", xR, xC) *\n                    getW(wR, wC, ").concat(b,", d2);\n              }\n\n            } else if (").concat(2===m,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(b,", d2),\n                getW(wR, wC, ").concat(b," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(b,"),\n                  getX(batch, xR, xC, ").concat(b," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(b,", xR, xC),\n                  getX(batch, ").concat(b," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===m,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(b,", d2),\n                getW(wR, wC, ").concat(b," + 1, d2),\n                getW(wR, wC, ").concat(b," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(b,"),\n                  getX(batch, xR, xC, ").concat(b," + 1),\n                  getX(batch, xR, xC, ").concat(b," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(b,", xR, xC),\n                  getX(batch, ").concat(b," + 1, xR, xC),\n                  getX(batch, ").concat(b," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")},Po=function t(e){Object(h.a)(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var n=e.padInfo.front,r=e.padInfo.top,a=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,p=e.filterWidth,b=4*Math.floor(e.inChannels/4),m=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(o,", ").concat(i,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(d,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,"; wR++) {\n            int xR = xRCorner + wR * ").concat(s,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(b,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===m,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(b,") *\n                  getW(wF, wR, wC, ").concat(b,", d2);\n              } else if (").concat(2===m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(b,"),\n                  getX(batch, xF, xR, xC, ").concat(b," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(b,", d2),\n                  getW(wF, wR, wC, ").concat(b," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(b,"),\n                  getX(batch, xF, xR, xC, ").concat(b," + 1),\n                  getX(batch, xF, xR, xC, ").concat(b," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(b,", d2),\n                  getW(wF, wR, wC, ").concat(b," + 1, d2),\n                  getW(wF, wR, wC, ").concat(b," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Lo=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var a=r.filterWidth,o=r.inChannels,i=r.strideWidth,c=r.strideHeight,u=r.padInfo,s=r.outWidth,l=r.dilationWidth,d=r.dilationHeight,f=r.dataFormat,p=u.left,b=u.top,m=o*a,v=kt(),g="channelsLast"===f,y=g?0:1,x=g?1:2,O="",w=0;w<=1;w++)for(var k=0;k<=1;k++)O+="\n          blockIndex = rc.y + ".concat(k,";\n          pos = rc.x + ").concat(w,";\n\n          if(blockIndex < ").concat(e[1]," && pos < ").concat(e[0],") {\n            offsetY = int(blockIndex / (").concat(s,")) * ").concat(c," - ").concat(b,";\n            d0 = offsetY + ").concat(d," * (pos / ").concat(m,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(s,".) * ").concat(i,". - ").concat(p,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(m,".) / ").concat(o,".));\n\n              if(d1 < ").concat(n[x]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(o,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*w+k,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*w+k,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(O,"\n\n        ").concat(v.output," = result;\n      }\n    ")};function Bo(t){var e,n=t.x,r=t.filter,a=t.convInfo,o=t.backend,i=t.bias,c=void 0===i?null:i,s=t.preluActivationWeights,l=void 0===s?null:s,d=t.leakyreluAlpha,f=void 0===d?0:d,p=t.activation,h=void 0===p?null:p,b=n.shape,m=o.texData.get(n.dataId),v=a.inChannels,g=b[0]*b[1]*b[2],y=a.outChannels,x="channelsLast"===a.dataFormat,O=[],w=(1===g||1===y)&&v>1e3,k=b[2]%2!==0&&!!m.isPacked;if(!w&&Object(u.env)().getBool("WEBGL_LAZILY_UNPACK")&&Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&k){var j=x?b[0]*b[1]*(b[2]+1):b[0]*b[2]*(b[3]+1),T={dataId:n.dataId,shape:[1,j,a.inChannels],dtype:n.dtype},S=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,u.util.assert(st(m.shape,T.shape),(function(){return"packed reshape ".concat(m.shape," to ").concat(T.shape," isn't free")}));var N=ra({inputs:{x:r},backend:o,attrs:{shape:[1,a.inChannels,a.outChannels]}});O.push(N);var C=ba({a:T,b:N,backend:o,transposeA:false,transposeB:false,bias:c,activation:h,preluActivationWeights:l,leakyreluAlpha:f}),I=o.texData.get(C.dataId);u.util.assert(I.isPacked,(function(){return"batchMatMul result is expected to be packed"})),m.shape=S,I.shape=a.outShape,(e=Pr({inputs:{x:C},backend:o})).shape=a.outShape,O.push(C)}else{var E=ra({inputs:{x:n},backend:o,attrs:{shape:[1,x?b[0]*b[1]*b[2]:b[0]*b[2]*b[3],a.inChannels]}}),A=ra({inputs:{x:r},backend:o,attrs:{shape:[1,a.inChannels,a.outChannels]}}),R=ba({a:E,b:A,transposeA:false,transposeB:false,backend:o,bias:c,activation:h,preluActivationWeights:l,leakyreluAlpha:f});e=ra({inputs:{x:R},backend:o,attrs:{shape:a.outShape}}),O.push(E),O.push(A),O.push(R)}for(var _=0,F=O;_<F.length;_++){var D=F[_];o.disposeIntermediateTensorInfo(D)}return e}function Vo(t){var e=t.x,n=t.filter,r=t.convInfo,a=t.backend,o=t.bias,i=void 0===o?null:o,c=t.preluActivationWeights,s=void 0===c?null:c,l=t.leakyreluAlpha,d=void 0===l?0:l,f=t.activation,p=void 0===f?null:f,h=r.filterWidth,b=r.filterHeight,m=r.inChannels,v=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,x=h*b*m,O=g*v,w=[x,O],k=[],j=ra({inputs:{x:e},backend:a,attrs:{shape:e.shape.slice(1)}}),T=ra({inputs:{x:n},backend:a,attrs:{shape:[1,x,u.util.sizeFromShape(n.shape)/x]}});k.push(j),k.push(T);var S=new Lo(w,j.shape,r),N=a.runWebGLProgram(S,[j],"float32"),C=ra({inputs:{x:N},backend:a,attrs:{shape:[1,w[0],w[1]]}});k.push(N),k.push(C);var I=null!=i,E=null!=s,A="leakyrelu"===p,R=p?Yr(p,!0):null,_=new Qr(C.shape,T.shape,[1,O,r.outChannels],!0,!1,I,R,E,A),F=[C,T];if(i&&F.push(i),E&&F.push(s),A){var D=a.makeTensorInfo([],"float32",u.util.createScalarValue(d,"float32"));F.push(D),k.push(D)}var M=a.runWebGLProgram(_,F,"float32"),P=ra({inputs:{x:M},backend:a,attrs:{shape:y?[1,g,v,r.outChannels]:[1,r.outChannels,g,v]}});k.push(M);for(var L=0,B=k;L<B.length;L++){var V=B[L];a.disposeIntermediateTensorInfo(V)}return P}var zo={kernelName:u.Conv2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=n.filter,c=a.strides,s=a.pad,l=a.dataFormat,d=a.dilations,f=a.dimRoundingMode,p=u.backend_util.convertConv2DDataFormat(l),h=u.backend_util.computeConv2DInfo(o.shape,i.shape,c,d,s,f,!1,p);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(Object(u.env)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])e=Vo({x:o,filter:i,convInfo:h,backend:r});else{var b=new Mo(h);e=r.runWebGLProgram(b,[o,i],"float32")}else e=Bo({x:o,filter:i,convInfo:h,backend:r});var m=ra({inputs:{x:e},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(e),m}},Uo=function t(e){Object(h.a)(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape;var n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              if (").concat(i,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Wo=function t(e){Object(h.a)(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i="channelsLast"===e.dataFormat,c=n-1-e.padInfo.top,u=r-1-e.padInfo.left,s=i?1:2,l=i?2:3,d=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(d,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(s,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Go=function t(e){Object(h.a)(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape;var n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,c=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(o,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(c,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ho=function t(e){Object(h.a)(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,o=e.strideDepth,i=e.strideHeight,c=e.strideWidth,u=n-1-e.padInfo.front,s=r-1-e.padInfo.top,l=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(s,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(o,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(c,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var qo={kernelName:u.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.dy,i=r.strides,c=r.pad,s=r.dataFormat,l=r.dimRoundingMode,d=r.filterShape,f=u.backend_util.convertConv2DDataFormat(s),p=u.backend_util.computeConv2DInfo(a.shape,d,i,1,c,l,!1,f),h=new Uo(p);return n.runWebGLProgram(h,[a,o],"float32")}};var Ko={kernelName:u.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.filter,i=r.inputShape,c=r.strides,s=r.pad,l=r.dataFormat,d=r.dimRoundingMode,f=u.backend_util.convertConv2DDataFormat(l),p=u.backend_util.computeConv2DInfo(i,o.shape,c,1,s,d,!1,f),h=new Wo(p);return n.runWebGLProgram(h,[a,o],"float32")}};var Xo={kernelName:u.Conv3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.filter,i=r.strides,c=r.pad,s=r.dilations,l=u.backend_util.computeConv3DInfo(a.shape,o.shape,i,s,c),d=new Po(l);return n.runWebGLProgram(d,[a,o],"float32")}};var Yo={kernelName:u.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.dy,i=r.strides,c=r.pad,s=r.filterShape,l=u.backend_util.computeConv3DInfo(a.shape,s,i,1,c),d=new Go(l);return n.runWebGLProgram(d,[a,o],"float32")}};var Qo={kernelName:u.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.filter,i=r.pad,c=r.strides,s=r.inputShape,l=u.backend_util.computeConv3DInfo(s,o.shape,c,1,i),d=new Ho(l);return n.runWebGLProgram(d,[a,o],"float32")}},Zo=Kr({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),Jo={kernelName:u.Cos,backendName:"webgl",kernelFunc:Zo},$o=Kr({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),ti={kernelName:u.Cosh,backendName:"webgl",kernelFunc:$o},ei=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=Object(s.a)(e,4),c=i[0],u=i[1],l=i[2],d=i[3],f=Object(s.a)(n,1)[0],p=Object(s.a)(r,2),b=p[0],m=p[1];this.outputShape=[f,b,m,d];var v="bilinear"===a?1:0,g="".concat(u-1,".0"),y="".concat(l-1,".0"),x=b>1?["".concat((u-1)/(b-1)),"(y2-y1) * height_ratio","y1*".concat(g," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(g)],O=Object(s.a)(x,3),w=O[0],k=O[1],j=O[2],T=m>1?["".concat((l-1)/(m-1)),"(x2-x1) * width_ratio","x1*".concat(y," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(y)],S=Object(s.a)(T,3),N=S[0],C=S[1],I=S[2];this.userCode="\n      const float height_ratio = float(".concat(w,");\n      const float width_ratio = float(").concat(N,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(c,") {\n          return;\n        }\n\n        float height_scale = ").concat(k,";\n        float width_scale = ").concat(C,";\n\n        float in_y = ").concat(j,";\n        if( in_y < 0.0 || in_y > ").concat(g," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat(I,";\n        if( in_x < 0.0 || in_x > ").concat(y," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},ni={kernelName:u.CropAndResize,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.image,o=e.boxes,i=e.boxInd,c=r.cropSize,u=r.method,s=r.extrapolationValue,l=new ei(a.shape,o.shape,c,u,s);return n.runWebGLProgram(l,[a,o,i],"float32")}},ri=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}],this.outputShape=e;var a=e.length,o=n?"0.0":"getX(".concat(ai(a,"coords"),")"),i=e[e.length-1],c="",u="";n?(c=r?"end != ".concat(i-1):"end != 0",u=r?"end + 1":"end - 1"):(c=r?"end + pow2 < ".concat(i):"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(we(a)," coords = getOutputCoords();\n        int end = ").concat(oi(a,"coords"),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(u,";\n          ").concat(oi(a,"coords")," = idx;\n          val += getX(").concat(ai(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")};function ai(t,e){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}function oi(t,e){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}var ii={kernelName:u.Cumsum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=r.exclusive,c=r.reverse,s=a.shape.length,l=u.backend_util.getAxesPermutation([o],s),d=a;null!=l&&(d=pa({inputs:{x:a},backend:n,attrs:{perm:l}}));var f=u.backend_util.getInnerMostAxes(1,s)[0];if(f!==s-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," ")+"but got axis=".concat(o));for(var p=d.shape[f],h=Pr({inputs:{x:d},backend:n}),b=0;b<=Math.ceil(Math.log2(p))-1;b++){var m=new ri(d.shape,!1,c),v=[[b]],g=h;h=n.runWebGLProgram(m,[h],h.dtype,v),n.disposeIntermediateTensorInfo(g)}if(i){var y=new ri(d.shape,i,c),x=h;h=n.runWebGLProgram(y,[h],h.dtype),n.disposeIntermediateTensorInfo(x)}if(null!=l){var O=pa({inputs:{x:h},backend:n,attrs:{perm:u.backend_util.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),O}return h}};var ci={kernelName:u.DenseBincount,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.weights,i=r.size,c=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),s=n.readSync(o.dataId),l=yn(u,s,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,l)}if(2===a.shape.length){var d=n.bufferSync(a),f=n.bufferSync(o),p=xn(d,f,i,c);return n.makeTensorInfo(p.shape,o.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},ui=function(){function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return Object(b.a)(t,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),t}();var si={kernelName:u.DepthToSpace,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.blockSize,i=r.dataFormat;u.util.assert(o>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(o)}));var c=a.shape[0],s="NHWC"===i?a.shape[1]:a.shape[2],l="NHWC"===i?a.shape[2]:a.shape[3],d="NHWC"===i?a.shape[3]:a.shape[1],f=s*o,p=l*o,h=d/(o*o),b=new ui("NHWC"===i?[c,f,p,h]:[c,h,f,p],o,i);return n.runWebGLProgram(b,[a],a.dtype)}},li=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,c=e.inWidth,u=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,d=e.strideWidth,f=e.dilationHeight,p=e.dilationWidth,b=e.filterHeight,m=e.filterWidth,v=e.outChannels/e.inChannels,g="",y="";r&&(g=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):o?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),y="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(g,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(d,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(v,";\n        int q = d2 - d1 * ").concat(v,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(b,"; wR++) {\n          int xR = xRCorner + wR * ").concat(f,";\n\n          if (xR < 0 || xR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(m,"; wC++) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            if (xC < 0 || xC >= ").concat(c,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(x,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")},di=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,t),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.outChannels/e.inChannels,c=e.inHeight,s=e.inWidth,l=e.padInfo.top,d=e.padInfo.left,f=e.strideHeight,p=e.strideWidth,b=e.dilationHeight,m=e.dilationWidth,v=e.filterHeight,g=e.filterWidth,y=g,x="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",O=0;O<g;O++)x+="\n          vec4 xTexelC".concat(2*O,";\n          int xTexelC").concat(2*O,"Ready;\n          vec4 xTexelC").concat(2*O+1,";\n          int xTexelC").concat(2*O+1,"Ready;\n          vec4 xC").concat(O,";");for(var w=0;w<v;w++){for(var k=0;k<g;k++)x+="\n          xTexelC".concat(2*k," = vec4(0.0);\n          xTexelC").concat(2*k,"Ready = 0;\n          xTexelC").concat(2*k+1," = vec4(0.0);\n          xTexelC").concat(2*k+1,"Ready = 0;\n          xC").concat(k," = vec4(0.0);");x+="\n        xR = xRCorner + ".concat(w*b,";\n        if (xR >=0 && xR < ").concat(c,") {\n      ");for(var j=0;j<(y+1)/2;j++){var T=2*j,S=T*m;if(x+="\n          xC = xCCorner + ".concat(S,";\n          "),1===p){if(T<g&&(d%2===1?(x+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < ".concat(s," && xTexelC").concat(T,"Ready == 0) {\n                  xTexelC").concat(T," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(T,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(T,"Ready = 1;\n                }\n              "),x+=1===m&&S>0?"\n                xC".concat(T," = vec4(xTexelC").concat(T-2,".zw, xTexelC").concat(T,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < ".concat(s,") {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(s,") {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC").concat(T," = vec4(previous.zw, xTexelC").concat(T,".xy);\n                  } else {\n                    xC").concat(T," = vec4(0.0, 0.0, xTexelC").concat(T,".xy);\n                  }\n                  ")):x+="\n                if (xC >= 0 && xC < ".concat(s," && xTexelC").concat(T,"Ready == 0) {\n                  xTexelC").concat(T," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(s,") {\n                    xTexelC").concat(T,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(T,"Ready = 1;\n                }\n\n                xC").concat(T," = xTexelC").concat(T,";\n                "),S+1<g)){var N=d%2===0?u.util.nearestLargerEven(m):m;m%2===0&&d%2===1||m%2!==0&&d%2!==1?(x+="\n                  xCOffset = xC + ".concat(d%2," + ").concat(N,";\n\n                  if (xCOffset >= 0 && xCOffset < ").concat(s," && xTexelC").concat(T+1,"Ready == 0) {\n                    xTexelC").concat(T+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(s,") {\n                      xTexelC").concat(T+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(T+1,"Ready = 1;\n                  }\n                  "),m>1&&(x+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < ".concat(s," && xTexelC").concat(T,"Ready == 0) {\n                      xTexelC").concat(T," = getX(batch, xR, xCOffset, d1);\n                      xTexelC").concat(T,"Ready = 1;\n                    }\n                    ")),x+="\n                  xC".concat(T+1," = vec4(xTexelC").concat(T,".zw, xTexelC").concat(T+1,".xy);\n                  ")):x+=1===N?"\n                    xC".concat(T+1," = xTexelC").concat(T,";\n                    "):"\n                    xCOffset = xC + ".concat(N,";\n\n                    if (xCOffset >= 0 && xCOffset < ").concat(s," && xTexelC").concat(T+1,"Ready == 0) {\n                      xTexelC").concat(T+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= ").concat(s,") {\n                        xTexelC").concat(T+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(T+1,"Ready = 1;\n                    }\n\n                    xC").concat(T+1," = xTexelC").concat(T+1,";\n                    ")}}else S<g&&(d%2===1?(x+="\n                xCOffset = xC + 1 - ".concat(p,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s," && xTexelC").concat(T,"Ready == 0) {\n                  xTexelC").concat(T," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(T,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(T,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s," && xTexelC").concat(T+1,"Ready == 0) {\n                  xTexelC").concat(T+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= ").concat(s,") {\n                    xTexelC").concat(T+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(T+1,"Ready = 1;\n                }\n\n                xC").concat(T," = vec4(xTexelC").concat(T,".zw, xTexelC").concat(T+1,".zw);\n              "),S+1<g&&(x+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + ".concat(p,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC").concat(T+1," = vec4(xTexelC").concat(T+1,".xy, final.xy);\n                "))):(x+="\n                if(xC >= 0 && xC < ".concat(s," && xTexelC").concat(T,"Ready == 0) {\n                  xTexelC").concat(T," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(s,") {\n                    xTexelC").concat(T,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(T,"Ready = 1;\n                }\n\n                xCOffset = xC + ").concat(p,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s," && xTexelC").concat(T+1,"Ready == 0) {\n                  xTexelC").concat(T+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(T+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(T+1,"Ready = 1;\n                }\n\n                xC").concat(T," = vec4(\n                  xTexelC").concat(T,".xy, xTexelC").concat(T+1,".xy);\n              "),S+1<g&&(x+="\n                  xC".concat(T+1," = vec4(xTexelC").concat(T,".zw, xTexelC").concat(T+1,".zw);\n                "))));T<g&&(x+="\n            wTexel = getW(".concat(w,", ").concat(S,", d1, q);\n            dotProd += xC").concat(T," * vec4(wTexel.xz, wTexel.xz);\n          "),S+1<g&&(x+="\n              wTexel = getW(".concat(w,", ").concat(S+1,", d1, q);\n              dotProd += xC").concat(T+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}x+="\n        }\n      "}var C="",I="";r&&(C=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):o?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),I="result = activation(result);");var E=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(C,"\n\n      const ivec2 strides = ivec2(").concat(f,", ").concat(p,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(d,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(x,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(E,"\n        ").concat(I,"\n        setOutput(result);\n      }\n    ")};var fi={kernelName:u.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.filter,i=r.strides,c=r.pad,s=r.dilations,l=r.dimRoundingMode,d=s;null==d&&(d=[1,1]),u.util.assert(u.backend_util.eitherStridesOrDilationsAreOne(i,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(d,"'")}));var f,p=u.backend_util.computeConv2DInfo(a.shape,o.shape,i,d,c,l,!0);return f=Object(u.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new di(p):new li(p),n.runWebGLProgram(f,[a,o],"float32")}},pi=function t(e){Object(h.a)(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape;var n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},hi=function t(e){Object(h.a)(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,c=r-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var bi={kernelName:u.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.dy,i=r.strides,c=r.dilations,s=r.pad,l=r.dimRoundingMode,d=r.filterShape,f=u.backend_util.computeConv2DInfo(a.shape,d,i,c,s,l,!0),p=new pi(f);return n.runWebGLProgram(p,[a,o],"float32")}};var mi={kernelName:u.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.filter,i=r.strides,c=r.dilations,s=r.pad,l=r.dimRoundingMode,d=r.inputShape,f=u.backend_util.computeConv2DInfo(d,o.shape,i,c,s,l,!0),p=new hi(f);return n.runWebGLProgram(p,[a,o],"float32")}},vi=function t(e){Object(h.a)(this,t),this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "};var gi={kernelName:u.Diag,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=[].concat(Object(f.a)(r.shape),Object(f.a)(r.shape)),o=u.util.sizeFromShape(r.shape),i=ra({inputs:{x:r},backend:n,attrs:{shape:[o]}}),c=new vi(o),s=n.runWebGLProgram(c,[i],i.dtype),l=ra({inputs:{x:s},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),l}},yi=function t(e){Object(h.a)(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var n=e.inHeight,r=e.inWidth,a=e.padInfo,o=e.strideHeight,i=e.strideWidth,c=e.filterHeight,u=e.filterWidth,s=e.dilationHeight,l=e.dilationWidth,d=a.top,f=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(c,"; h++) {\n          int hIn = hBeg + h * ").concat(s,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")};var xi={kernelName:u.Dilation2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=n.filter,c=a.strides,s=a.pad,l=a.dilations,d=u.backend_util.computeDilation2DInfo(o.shape,i.shape,c,s,"NHWC",l),f=new yi(d),p=ra({inputs:{x:e=r.runWebGLProgram(f,[o,i],"float32")},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(e),p}},Oi=n(94);var wi={kernelName:u.Einsum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.equation,a=e,o=u.backend_util.decodeEinsumEquation(r,a.length),i=o.allDims,c=o.summedDims,s=o.idDims;u.backend_util.checkEinsumDimSizes(i.length,s,a);for(var l=u.backend_util.getEinsumComputePath(c,s),d=l.path,f=l.steps,p=f.length,h=null,b=i.length,m=[],v=0;v<p;++v){var g,y=Object(Oi.a)(f[v]);try{for(y.s();!(g=y.n()).done;){var x=g.value,O=u.backend_util.getEinsumPermutation(b,s[x]),w=O.permutationIndices,k=O.expandDims,j=void 0;u.backend_util.isIdentityPermutation(w)?j=a[x]:(j=pa({inputs:{x:a[x]},backend:n,attrs:{perm:w}}),m.push(j));for(var T=j.shape.slice(),S=0;S<k.length;++S)T.splice(k[S],0,1);u.util.arraysEqual(j.shape,T)||(j=ra({inputs:{x:j},backend:n,attrs:{shape:T}}),m.push(j)),null===h?h=j:(h=ea({inputs:{a:j,b:h},backend:n}),m.push(h))}}catch(E){y.e(E)}finally{y.f()}v<p-1&&(d[v]>=0&&(h=da({inputs:{x:h},backend:n,attrs:{axis:d[v]-(i.length-b),keepDims:!1}}),m.push(h)),b--)}for(var N=0,C=m;N<C.length;N++){var I=C[N];I!==h&&n.disposeIntermediateTensorInfo(I)}return h}},ki=Kr({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),ji={kernelName:u.Elu,backendName:"webgl",kernelFunc:ki},Ti={kernelName:u.EluGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.dy,a=e.y,o=Object(u.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new Dr("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)}},Si=Xr({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:kn}),Ni={kernelName:u.Equal,backendName:"webgl",kernelFunc:Si},Ci=Kr({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(u.backend_util.ERF_P,";\n  float a1 = ").concat(u.backend_util.ERF_A1,";\n  float a2 = ").concat(u.backend_util.ERF_A2,";\n  float a3 = ").concat(u.backend_util.ERF_A3,";\n  float a4 = ").concat(u.backend_util.ERF_A4,";\n  float a5 = ").concat(u.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),Ii={kernelName:u.Erf,backendName:"webgl",kernelFunc:Ci},Ei="return exp(x);",Ai=Kr({opSnippet:Ei,packedOpSnippet:Ei,cpuKernelImpl:jn}),Ri={kernelName:u.Exp,backendName:"webgl",kernelFunc:Ai};function _i(t){var e=t.inputs,n=t.attrs,r=t.backend,a=n.dim,o=e.input,i=o.shape.length,c=o.shape.slice(),s=a;return a<0&&(u.util.assert(-(i+1)<=a,(function(){return"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")})),s=i+a+1),c.splice(s,0,1),ra({inputs:{x:o},backend:r,attrs:{shape:c}})}var Fi={kernelName:u.ExpandDims,backendName:"webgl",kernelFunc:_i},Di="return exp(x) - 1.0;",Mi=Kr({opSnippet:Di,packedOpSnippet:Di,cpuKernelImpl:Tn}),Pi={kernelName:u.Expm1,backendName:"webgl",kernelFunc:Mi},Li=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var o,i=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),c=r?"".concat(a,".0"):"1.0";if("real"===e)o="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(c,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function Bi(t,e,n){var r=n.texData.get(t.dataId),a=u.util.sizeFromShape(t.shape),o=t.shape[t.shape.length-1],i=ra({inputs:{x:t},backend:n,attrs:{shape:[a/o,o]}}),c=i.shape,s=new Li("real",c,e),l=new Li("imag",c,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],f=n.runWebGLProgram(s,d,"float32"),p=n.runWebGLProgram(l,d,"float32"),h=Br({inputs:{real:f,imag:p},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p);var b=ra({inputs:{x:h},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(h),b}var Vi={kernelName:u.FFT,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;return Bi(e.input,!1,n)}},zi=function t(e,n){Object(h.a)(this,t),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "};function Ui(t){var e=t.backend,n=t.attrs,r=n.shape,a=n.value,o=n.dtype;if("string"===(o=o||u.util.inferDtype(a))){var i=u.util.getArrayFromDType(o,u.util.sizeFromShape(r));return i.fill(a),e.makeTensorInfo(r,o,i)}var c=new zi(r,a),s=[[a]];return e.runWebGLProgram(c,[],o,s)}var Wi,Gi={kernelName:u.Fill,backendName:"webgl",kernelFunc:Ui},Hi=function t(e){Object(h.a)(this,t),this.variableNames=["Image"],this.outputShape=[];var n=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},qi={kernelName:u.FlipLeftRight,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.image,a=n,o=new Hi(r.shape);return a.runWebGLProgram(o,[r],r.dtype)}},Ki="return floor(x);",Xi=Kr({opSnippet:Ki,packedOpSnippet:Ki,cpuKernelImpl:Sn}),Yi={kernelName:u.Floor,backendName:"webgl",kernelFunc:Xi},Qi=Xr({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Zi={kernelName:u.FloorDiv,backendName:"webgl",kernelFunc:Qi},Ji=function t(e){Object(h.a)(this,t),this.variableNames=["A"];var n=kt(),r=Object(s.a)(e,2),a=r[0],o=r[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(o,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},$i=function t(e){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=kt(),r=Object(s.a)(e,2),a=r[0],o=r[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(o,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},tc={kernelName:u.FromPixels,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.pixels,o=r.numChannels,c="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,l="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,d=c?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=Object(s.a)(d,2),p=f[0],h=f[1],b=[h,p],m=[h,p,o];(l||c)&&(null==Wi&&(Wi=document.createElement("canvas").getContext("2d")),Wi.canvas.width=p,Wi.canvas.height=h,Wi.drawImage(a,0,0,p,h),a=Wi.canvas);var v=n.makeTensorInfo(b,"int32");n.texData.get(v.dataId).usage=i.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(v.dataId),a);var g=Object(u.env)().getBool("WEBGL_PACK")?new $i(m):new Ji(m),y=n.runWebGLProgram(g,[v],"int32");return n.disposeData(v.dataId),y}};var ec={kernelName:u.FusedConv2D,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=n.filter,c=n.bias,s=n.preluActivationWeights,l=a.strides,d=a.pad,f=a.dataFormat,p=a.dilations,h=a.dimRoundingMode,b=a.activation,m=a.leakyreluAlpha,v=u.backend_util.convertConv2DDataFormat(f),g=u.backend_util.computeConv2DInfo(o.shape,i.shape,l,p,d,h,!1,v),y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Object(u.env)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])e=Vo({x:o,filter:i,convInfo:g,backend:r,bias:c,activation:b,preluActivationWeights:s,leakyreluAlpha:m});else{var x=null!=c,O=null!=s,w="leakyrelu"===b,k=b?Yr(b,!1):null,j=new Mo(g,x,k,O,w),T=[o,i];if(c&&T.push(c),s&&T.push(s),w){var S=r.makeTensorInfo([],"float32",u.util.createScalarValue(m,"float32"));T.push(S),y.push(S)}e=r.runWebGLProgram(j,T,"float32")}else e=Bo({x:o,filter:i,convInfo:g,backend:r,bias:c,activation:b,preluActivationWeights:s,leakyreluAlpha:m});var N=ra({inputs:{x:e},backend:r,attrs:{shape:g.outShape}});return y.push(e),y.forEach((function(t){return r.disposeIntermediateTensorInfo(t)})),N}};var nc={kernelName:u.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.filter,i=e.bias,c=e.preluActivationWeights,s=r.strides,l=r.pad,d=r.dilations,f=r.dimRoundingMode,p=r.activation,h=r.leakyreluAlpha,b=[],m=d;null==m&&(m=[1,1]),u.util.assert(u.backend_util.eitherStridesOrDilationsAreOne(s,m),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(m,"'")}));var v,g=u.backend_util.computeConv2DInfo(a.shape,o.shape,s,m,l,f,!0),y=Object(u.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=p?Yr(p,y):null,O=[a,o],w=null!=i,k=null!=c,j="leakyrelu"===p;if(w&&O.push(i),k&&O.push(c),j){var T=n.makeTensorInfo([],"float32",u.util.createScalarValue(h,"float32"));O.push(T),b.push(T)}v=y?new di(g,w,x,k,j):new li(g,w,x,k,j);var S=n.runWebGLProgram(v,O,"float32");return b.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),S}},rc=function t(e,n,r){Object(h.a)(this,t),this.sliceDim=e,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=we(n.length),o=we(r.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(o," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(i,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};var ac={kernelName:u.GatherNd,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.params,a=e.indices,o=a.shape,i=o[o.length-1],c=u.util.sizeFromShape(r.shape),l=u.backend_util.prepareAndValidate(r,a),d=Object(s.a)(l,4),f=d[0],p=d[1],h=d[2],b=d[3],m=ra({inputs:{x:a},backend:n,attrs:{shape:[p,i]}}),v=ra({inputs:{x:r},backend:n,attrs:{shape:[u.util.sizeFromShape(r.shape)/h,h]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var g=n.readSync(a.dataId),y=n.bufferSync(r),x=Nn(g,y,r.dtype,p,i,h,b,r.shape,c);return n.makeTensorInfo(f,r.dtype,x.values)}var O=new rc(i,b,[p,h]),w=n.runWebGLProgram(O,[v,m],v.dtype),k=ra({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w),k}},oc=function t(e,n){Object(h.a)(this,t),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=we(this.rank),a=function(t,e){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<t.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")};function ic(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.indices,i=r.axis,c=r.batchDims,s=u.util.parseAxisParam(i,a.shape)[0],l=u.backend_util.segment_util.collectGatherOpShapeInfo(a,o,s,c),d=u.util.sizeFromShape(o.shape),f=[],p=ra({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),h=ra({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,d/l.batchSize]}});f.push(p),f.push(h);var b=[l.batchSize,l.outerSize,d/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,o])||"string"===a.dtype){var m=n.bufferSync(h),v=n.bufferSync(p),g=Cn(v,m,b);return f.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),n.makeTensorInfo(l.outputShape,g.dtype,g.values)}var y=new oc(p.shape,b),x=n.runWebGLProgram(y,[p,h],p.dtype);f.push(x);var O=ra({inputs:{x:x},backend:n,attrs:{shape:l.outputShape}});return f.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),O}var cc={kernelName:u.GatherV2,backendName:"webgl",kernelFunc:ic},uc=Xr({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:In,dtype:"bool"}),sc={kernelName:u.Greater,backendName:"webgl",kernelFunc:uc},lc=Xr({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:En}),dc={kernelName:u.GreaterEqual,backendName:"webgl",kernelFunc:lc};var fc={kernelName:u.IFFT,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;return Bi(e.input,!0,n)}},pc=Kr({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),hc={kernelName:u.IsFinite,backendName:"webgl",kernelFunc:pc},bc=Kr({opSnippet:"return float(isinf(x));",dtype:"bool"}),mc={kernelName:u.IsInf,backendName:"webgl",kernelFunc:bc},vc=Kr({opSnippet:"return float(isnan(x));",dtype:"bool"}),gc={kernelName:u.IsNan,backendName:"webgl",kernelFunc:vc},yc=Xr({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:An,dtype:"bool"}),xc={kernelName:u.Less,backendName:"webgl",kernelFunc:yc},Oc=Xr({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Rn,dtype:"bool"}),wc={kernelName:u.LessEqual,backendName:"webgl",kernelFunc:Oc};var kc={kernelName:u.LinSpace,backendName:"webgl",kernelFunc:function(t){var e=t.backend,n=t.attrs,r=n.start,a=n.stop,o=n.num,i=_n(r,a,o);return e.makeTensorInfo([i.length],"float32",i)}},jc=Kr({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Fn}),Tc={kernelName:u.Log,backendName:"webgl",kernelFunc:jc},Sc=Kr({opSnippet:"return log(1.0 + x);"}),Nc={kernelName:u.Log1p,backendName:"webgl",kernelFunc:Sc},Cc=Xr({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Ic={kernelName:u.LogicalAnd,backendName:"webgl",kernelFunc:Cc},Ec=Kr({opSnippet:"return float(!(x >= 1.0));"}),Ac={kernelName:u.LogicalNot,backendName:"webgl",kernelFunc:Ec},Rc=Xr({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),_c={kernelName:u.LogicalOr,backendName:"webgl",kernelFunc:Rc},Fc=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["x"],this.outputShape=[];var i,c=n,u=e[3]-1;this.outputShape=e;var s="float(".concat(r,") + float(").concat(a,") * sum");i=.5===o?"inversesqrt(".concat(s,")"):1===o?"1.0/(".concat(s,")"):"exp(log(".concat(s,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(c,"; j <= ").concat(c,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(i,";\n        setOutput(val);\n      }\n    ")},Dc=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,c=n,u=e[3]-1;this.outputShape=e;var s="float(".concat(r,") + float(").concat(a,") * sum");i=.5===o?"inversesqrt(".concat(s,")"):1===o?"1.0/(".concat(s,")"):"exp(log(".concat(s,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(c,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(c,"; j <= ").concat(c,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(i,";\n        setOutput(result);\n      }\n    ")},Mc={kernelName:u.LRN,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.depthRadius,i=r.bias,c=r.alpha,s=r.beta,l=Object(u.env)().getBool("WEBGL_PACK_NORMALIZATION")?new Dc(a.shape,o,i,c,s):new Fc(a.shape,o,i,c,s);return n.runWebGLProgram(l,[a],a.dtype)}},Pc=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(o,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(o,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},Lc={kernelName:u.LRNGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.y,i=e.dy,c=r.depthRadius,u=r.bias,s=r.alpha,l=r.beta,d=new Pc(a.shape,c,u,s,l);return n.runWebGLProgram(d,[a,o,i],a.dtype)}};function Bc(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.reductionIndices,i=r.keepDims,c=a.shape.length,l=u.util.parseAxisParam(o,a.shape),d=l,f=u.backend_util.getAxesPermutation(d,c),p=null!=f,h=n.shouldExecuteOnCPU([a]),b=a;if(p){if(h){for(var m=n.texData.get(b.dataId).values,v=new Array(c),g=0;g<v.length;g++)v[g]=a.shape[f[g]];var y=nr(m,a.shape,a.dtype,f,v);b=n.makeTensorInfo(v,a.dtype),n.texData.get(b.dataId).values=y}else b=la(a,f,n);d=u.backend_util.getInnerMostAxes(d.length,c)}u.backend_util.assertAxesAreInnerMostDims("max",d,c);var x,O=u.backend_util.computeOutAndReduceShapes(b.shape,d),w=Object(s.a)(O,2),k=w[0],j=w[1],T=k;if(i&&(T=u.backend_util.expandShapeToKeepDim(k,l)),h){var S=n.texData.get(b.dataId).values,N=Dn(S,u.util.sizeFromShape(j),T,a.dtype);x=n.makeTensorInfo(T,a.dtype),n.texData.get(x.dataId).values=N}else x=function(t,e,n,r){var a=u.util.sizeFromShape(e),o=ra({inputs:{x:t},attrs:{shape:[u.util.sizeFromShape(t.shape)/a,a]},backend:r}),i=ca(o,t.dtype,"max",r),c=ra({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),c}(b,j,T,n);return p&&n.disposeIntermediateTensorInfo(b),x}var Vc={kernelName:u.Max,backendName:"webgl",kernelFunc:Bc},zc=Xr({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Mn}),Uc={kernelName:u.Maximum,backendName:"webgl",kernelFunc:zc};var Wc={kernelName:u.MaxPool,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x;Ot(a,"maxPool");var o=r.filterSize,i=r.strides,c=r.pad,s=r.dimRoundingMode;u.util.assert(u.backend_util.eitherStridesOrDilationsAreOne(i,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")}));var l=u.backend_util.computePool2DInfo(a.shape,o,i,1,c,s);if(1===l.filterWidth&&1===l.filterHeight&&u.util.arraysEqual(l.inShape,l.outShape))return Pr({inputs:{x:a},backend:n});var d=new Xa(l,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}};var Gc={kernelName:u.MaxPool3D,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.filterSize,i=r.strides,c=r.pad,s=r.dataFormat,l=r.dimRoundingMode,d=u.backend_util.computePool3DInfo(a.shape,o,i,[1,1,1],c,l,s),f=new Ya(d,"max",!1);return n.runWebGLProgram(f,[a],a.dtype)}},Hc=function t(e){Object(h.a)(this,t),this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var n=e.strideHeight,r=e.strideWidth,a=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=i-1-e.padInfo.left,s=o*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(s," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},qc=function t(e){Object(h.a)(this,t),this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,d=u-1-e.padInfo.front,f=s-1-e.padInfo.top,p=l-1-e.padInfo.left,b=u*s*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(f,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(s,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(b," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(s," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Kc={kernelName:u.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.input,i=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode,d=u.backend_util.computePool3DInfo(o.shape,i,c,[1,1,1],s,l),f=new Ya(d,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),h=new qc(d),b=n.runWebGLProgram(h,[a,p],o.dtype);return n.disposeIntermediateTensorInfo(p),b}};var Xc={kernelName:u.MaxPoolGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.dy,o=e.input,i=o;Ot([o,e.output],"maxPoolGrad");var c=r.filterSize,s=r.strides,l=r.pad,d=r.dimRoundingMode,f=u.backend_util.computePool2DInfo(i.shape,c,s,1,l,d),p=new Xa(f,"max",!0),h=n.runWebGLProgram(p,[i],i.dtype),b=new Hc(f),m=n.runWebGLProgram(b,[a,h],i.dtype);return n.disposeIntermediateTensorInfo(h),m}};var Yc={kernelName:u.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,o=n.filterSize,i=n.strides,c=n.pad,l=n.includeBatchInIndex,d=r;u.util.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var f=[1,1];u.util.assert(u.backend_util.eitherStridesOrDilationsAreOne(i,f),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(f,"'")}));var p=u.backend_util.computePool2DInfo(a.shape,o,i,f,c),h=function(t,e,n,r){var a=new Xa(n,"max",!1),o=r.runWebGLProgram(a,[t],"float32");return a=new Xa(n,"max",!0,!0,e),[o,r.runWebGLProgram(a,[t],"float32")]}(a,l,p,d),b=Object(s.a)(h,2);return[b[0],b[1]]}};var Qc={kernelName:u.Mean,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,o=n.keepDims,i=n.axis,c=r,l=a.shape.length,d=u.util.parseAxisParam(i,a.shape),f=d,p=u.backend_util.getAxesPermutation(f,l),h=null!=p,b=c.shouldExecuteOnCPU([a]),m=[],v=a;if(h){if(b){for(var g=c.texData.get(v.dataId).values,y=new Array(l),x=0;x<y.length;x++)y[x]=a.shape[p[x]];var O=nr(g,a.shape,a.dtype,p,y);v=c.makeTensorInfo(y,a.dtype),c.texData.get(v.dataId).values=O}else v=la(a,p,c);m.push(v),f=u.backend_util.getInnerMostAxes(f.length,l)}u.backend_util.assertAxesAreInnerMostDims("sum",f,l);var w=u.backend_util.computeOutAndReduceShapes(v.shape,f),k=Object(s.a)(w,2),j=k[0],T=k[1],S=j;o&&(S=u.backend_util.expandShapeToKeepDim(j,d));for(var N=function(t,e,n,r){var a=u.util.sizeFromShape(e),o=ra({inputs:{x:t},attrs:{shape:[u.util.sizeFromShape(t.shape)/a,a]},backend:r}),i=ca(o,"float32","mean",r),c=ra({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),c}(v,T,S,c),C=0,I=m;C<I.length;C++){var E=I[C];c.disposeIntermediateTensorInfo(E)}return N}};var Zc={kernelName:u.Min,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.axis,i=r.keepDims,c=a.shape.length,l=u.util.parseAxisParam(o,a.shape),d=l,f=u.backend_util.getAxesPermutation(d,c),p=a;null!=f&&(p=pa({inputs:{x:a},backend:n,attrs:{perm:f}}),d=u.backend_util.getInnerMostAxes(d.length,a.shape.length)),u.backend_util.assertAxesAreInnerMostDims("min",d,c);var h,b=u.backend_util.computeOutAndReduceShapes(p.shape,d),m=Object(s.a)(b,2),v=m[0],g=m[1],y=ra({inputs:{x:p},backend:n,attrs:{shape:[-1,u.util.sizeFromShape(g)]}}),x=ca(y,y.dtype,"min",n);return h=ra(i?{inputs:{x:x},backend:n,attrs:{shape:u.backend_util.expandShapeToKeepDim(v,l)}}:{inputs:{x:x},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=f&&n.disposeIntermediateTensorInfo(p),h}},Jc=Xr({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Pn}),$c={kernelName:u.Minimum,backendName:"webgl",kernelFunc:Jc},tu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));var a=e.length,o=we(a),i=n.map((function(t){return t[0]})).join(","),c=n.map((function(t,n){return t[0]+e[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),s="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(s,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(s,";\n          }\n        }\n        ").concat(o," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(s,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(s,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},eu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));var a=e.length,o=we(a),i=n.map((function(t){return t[0]})).join(","),c=n.map((function(t,n){return t[0]+e[n]})).join(","),u=or("rc",a),s=or("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(s.slice(-2).join(),")"),f="reflect"===r?0:1,p="";if(1===a){var b="\n        ".concat(o," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(f,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(f,";\n        }\n        source -= start;\n      ");p="\n        ".concat(o," rc = outputLoc;\n        ").concat(b,"\n        result[0] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(b,"\n          result[1] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n        }\n      ")}else{var m="\n        ".concat(o," source = rc;\n        ").concat(o," lt = ").concat(o,"(lessThan(source, start));\n        ").concat(o," gte = ").concat(o,"(greaterThanEqual(source, end));\n        ").concat(o," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(f,") +\n                gte * ((end - 1) * 2 - source + ").concat(f,");\n        source -= start;\n      ");p="\n        ".concat(o," rc = outputLoc;\n        ").concat(m,"\n        result[0] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(m,"\n          result[1] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(m,"\n          result[2] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(m,"\n            result[3] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},nu={kernelName:u.MirrorPad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.paddings,i=r.mode,c=Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eu(a.shape,o,i):new tu(a.shape,o,i);return n.runWebGLProgram(c,[a],a.dtype)}},ru=Xr({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),au={kernelName:u.Mod,backendName:"webgl",kernelFunc:ru},ou=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")},iu=Xr({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),cu={kernelName:u.RealDiv,backendName:"webgl",kernelFunc:iu},uu="return a - b;",su=Xr({opSnippet:uu,packedOpSnippet:uu,supportsComplex:!0,cpuKernelImpl:$n}),lu={kernelName:u.Sub,backendName:"webgl",kernelFunc:su};function du(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.logits,o=r.dim,i=u.util.parseAxisParam([o],a.shape),c=Bc({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=u.backend_util.expandShapeToKeepDim(c.shape,i),l=ra({inputs:{x:c},backend:n,attrs:{shape:s}}),d=su({inputs:{a:a,b:l},backend:n}),f=Ai({inputs:{x:d},backend:n}),p=da({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:!1}}),h=ra({inputs:{x:p},backend:n,attrs:{shape:s}}),b=iu({inputs:{a:f,b:h},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),b}var fu={kernelName:u.Softmax,backendName:"webgl",kernelFunc:du};var pu={kernelName:u.Multinomial,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.logits,o=r.numSamples,i=r.seed,c=r.normalized,u=c?a:du({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),s=u.shape[0],l=u.shape[1],d=new ou(s,l,o),f=[[i]],p=n.runWebGLProgram(d,[u],"int32",f);return c||n.disposeIntermediateTensorInfo(u),p}},hu="return -x;";var bu={kernelName:u.Neg,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var o=r.texData.get(a.dataId),i=Bn(o.values,a.shape,a.dtype),c=Object(s.a)(i,2),l=c[0],d=c[1];return r.makeTensorInfo(d,a.dtype,l)}return e=Object(u.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Sr(a.shape,hu):new fr(a.shape,hu),r.runWebGLProgram(e,[a],a.dtype)}},mu=u.kernel_impls.nonMaxSuppressionV3Impl;var vu={kernelName:u.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(t){u.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,r=t.attrs,a=e.boxes,o=e.scores,i=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=n.readSync(a.dataId),d=n.readSync(o.dataId),f=mu(l,d,i,c,s).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},gu=u.kernel_impls.nonMaxSuppressionV4Impl;var yu={kernelName:u.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(t){u.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,r=t.attrs,a=e.boxes,o=e.scores,i=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=r.padToMaxOutputSize,d=n.readSync(a.dataId),f=n.readSync(o.dataId),p=gu(d,f,i,c,s,l),h=p.selectedIndices,b=p.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([b]))]}},xu=u.kernel_impls.nonMaxSuppressionV5Impl;var Ou={kernelName:u.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(t){u.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var e=t.inputs,n=t.backend,r=t.attrs,a=e.boxes,o=e.scores,i=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=r.softNmsSigma,d=n.readSync(a.dataId),f=n.readSync(o.dataId),p=xu(d,f,i,c,s,l),h=p.selectedIndices,b=p.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}},wu=function t(e,n,r,a){Object(h.a)(this,t),this.variableNames=["indices"],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},ku={kernelName:u.OneHot,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.indices,o=r.depth,i=r.onValue,c=r.offValue,s=u.util.sizeFromShape(a.shape),l=new wu(s,o,i,c),d=ra({inputs:{x:a},backend:n,attrs:{shape:[s]}}),p=n.runWebGLProgram(l,[d],a.dtype);n.disposeIntermediateTensorInfo(d);var h=ra({inputs:{x:p},backend:n,attrs:{shape:[].concat(Object(f.a)(a.shape),[o])}});return n.disposeIntermediateTensorInfo(p),h}};function ju(t){var e=t.inputs,n=t.backend,r=e.x;if("complex64"===r.dtype){var a=mo({inputs:{input:r},backend:n}),o=ju({inputs:{x:a},backend:n}),i=Ao({inputs:{input:r},backend:n}),c=ju({inputs:{x:i},backend:n}),u=Br({inputs:{real:o,imag:c},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),u}return Ui({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var Tu={kernelName:u.ZerosLike,backendName:"webgl",kernelFunc:ju};var Su={kernelName:u.OnesLike,backendName:"webgl",kernelFunc:function t(e){var n=e.inputs,r=e.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var o=mo({inputs:{input:a},backend:r}),i=t({inputs:{x:o},backend:r}),c=Ao({inputs:{input:a},backend:r}),u=ju({inputs:{x:c},backend:r}),s=Br({inputs:{real:i,imag:u},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(u),s}return Ui({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var Nu={kernelName:u.Pack,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.axis;if(1===e.length)return _i({inputs:{input:e[0]},backend:n,attrs:{dim:r}});var a=e[0].shape,o=e[0].dtype;e.forEach((function(t){u.util.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),u.util.assert(o===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var i=[],c=Fo({inputs:e.map((function(t){var e=_i({inputs:{input:t},backend:n,attrs:{dim:r}});return i.push(e),e})),backend:n,attrs:{axis:r}});return i.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),c}},Cu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));var a=e.length,o=we(a),i=n.map((function(t){return t[0]})).join(","),c=n.map((function(t,n){return t[0]+e[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(o," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(c,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")},Iu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));for(var a=e.length,o=we(a),i=n.map((function(t){return t[0]})).join(","),c=n.map((function(t,n){return t[0]+e[n]})).join(","),u=or("rc",a),s=or("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(s.slice(-2).join(),")"),f=["".concat(o," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],p=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",b="",m=0,v=1===a?2:4;m<v;m++)b+="\n        ".concat(f[m],"\n        if (").concat(p,") {\n          result[").concat(m,"] = float(value);\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(m,"] = getChannel(getX(").concat(s.join(),"), ").concat(d,");\n        }\n      ");b+=1===a?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")},Eu=function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.paddings,i=r.constantValue,c=Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Iu(a.shape,o,i):new Cu(a.shape,o,i),s=[[i]];return n.runWebGLProgram(c,[a],a.dtype,s)},Au={kernelName:u.PadV2,backendName:"webgl",kernelFunc:Eu},Ru=Xr({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),_u={kernelName:u.Pow,backendName:"webgl",kernelFunc:Ru};var Fu={kernelName:u.Prod,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=a.axis,c=a.keepDims,l=o.shape.length,d=[],f=u.util.parseAxisParam(i,o.shape),p=f,h=u.backend_util.getAxesPermutation(p,l),b=o;if(null!=h&&(b=pa({inputs:{x:o},backend:r,attrs:{perm:h}}),p=u.backend_util.getInnerMostAxes(p.length,l),d.push(b)),u.backend_util.assertAxesAreInnerMostDims("prod",p,l),r.shouldExecuteOnCPU([b])){var m=r.texData.get(b.dataId).values,v=zn(b.shape,b.dtype,m,p),g=v.outVals,y=v.outShape,x=v.outDtype;e=r.makeTensorInfo(y,x,g)}else{var O=u.backend_util.computeOutAndReduceShapes(b.shape,p),w=Object(s.a)(O,2),k=w[0],j=w[1],T=u.util.sizeFromShape(j),S=ra({inputs:{x:b},backend:r,attrs:{shape:[-1,T]}}),N=ca(S,Object(u.sumOutType)(o.dtype),"prod",r);e=ra({inputs:{x:N},backend:r,attrs:{shape:k}}),d.push(S),d.push(N)}if(c){d.push(e);var C=u.backend_util.expandShapeToKeepDim(e.shape,f);e=ra({inputs:{x:e},backend:r,attrs:{shape:C}})}return d.forEach((function(t){return r.disposeIntermediateTensorInfo(t)})),e}},Du=function(t){var e=t.backend,n=t.attrs,r=n.start,a=n.stop,o=n.step,i=n.dtype,c=Un(r,a,o,i);return e.makeTensorInfo([c.length],i,c)},Mu={kernelName:u.Range,backendName:"webgl",kernelFunc:Du},Pu=Kr({opSnippet:"return 1.0 / x;"}),Lu={kernelName:u.Reciprocal,backendName:"webgl",kernelFunc:Pu},Bu=Kr({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Vu={kernelName:u.Relu,backendName:"webgl",kernelFunc:Bu},zu=Kr({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Uu={kernelName:u.Relu6,backendName:"webgl",kernelFunc:zu},Wu=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["A"],this.outputShape=[];var i=Object(s.a)(e,4),c=i[0],u=i[1],l=i[2],d=i[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],b=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=o?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/b[0],",\n          ").concat(p[1]/b[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},Gu=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=Object(s.a)(e,4),c=i[0],u=i[1],l=i[2],d=i[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],b=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=o?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/b[0],",\n          ").concat(p[1]/b[1],",\n          ").concat(p[1]/b[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(d-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")};var Hu={kernelName:u.ResizeBilinear,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.images,o=r.alignCorners,i=r.halfPixelCenters,c=r.size,l=Object(s.a)(c,2),d=l[0],f=l[1],p=Object(u.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Gu(a.shape,d,f,o,i):new Wu(a.shape,d,f,o,i);return n.runWebGLProgram(p,[a],"float32")}},qu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(s.a)(n,3),o=a[1],i=a[2],c=Object(s.a)(e,3),u=c[1],l=c[2],d=[r&&u>1?o-1:o,r&&l>1?i-1:i],f=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=d[0]/f[0],b=d[1]/f[1],m=1/p,v=1/b,g=2*Math.ceil(m)+2,y=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(b,");\n\n        const float invHeightScale = float(").concat(m,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(o-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(i-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Ku={kernelName:u.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.images,o=e.dy,i=r.alignCorners,c=new qu(o.shape,a.shape,i);return n.runWebGLProgram(c,[o],o.dtype)}},Xu=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["A"],this.outputShape=[];var i=Object(s.a)(e,4),c=i[0],u=i[1],l=i[2],d=i[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],b=[a&&n>1?n-1:n,a&&r>1?r-1:r],m=a?"0.5":"0.0";f=o?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/b[0],",\n          ").concat(p[1]/b[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(m,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},Yu=function t(e,n,r,a,o){Object(h.a)(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=Object(s.a)(e,4),c=i[0],u=i[1],l=i[2],d=i[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],b=[a&&n>1?n-1:n,a&&r>1?r-1:r],m=a?"0.5":"0.0";f=o?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/b[0],",\n          ").concat(p[1]/b[1],",\n          ").concat(p[1]/b[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(m,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(d-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")};var Qu={kernelName:u.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.images,o=r.alignCorners,i=r.halfPixelCenters,c=r.size,l=Object(s.a)(c,2),d=l[0],f=l[1],p=Object(u.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Yu(a.shape,d,f,o,i):new Xu(a.shape,d,f,o,i);return n.runWebGLProgram(p,[a],a.dtype)}},Zu=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(s.a)(n,3),o=a[1],i=a[2],c=Object(s.a)(e,3),u=c[1],l=c[2],d=[r&&u>1?o-1:o,r&&l>1?i-1:i],f=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=d[0]/f[0],b=d[1]/f[1],m=1/p,v=1/b,g=2*Math.ceil(m)+2,y=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(b,");\n\n        const float invHeightScale = float(").concat(m,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(d[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(d[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Ju={kernelName:u.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.images,o=e.dy,i=r.alignCorners,c=new Zu(o.shape,a.shape,i);return n.runWebGLProgram(c,[o],o.dtype)}},$u=function t(e,n){Object(h.a)(this,t),this.variableNames=["x"];var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=e,1!==r){var a=e.map((function(t,r){return function(t){return-1!==n.indexOf(t)&&1!==e[t]?"".concat(e[t]," - coords[").concat(t,"] - 1"):"coords[".concat(t,"]")}(r)})).join(","),o=we(r);this.userCode="\n      void main() {\n        ".concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ")},ts=function t(e,n){Object(h.a)(this,t),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=e;var a=or("rc",r),o="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),i="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),c=we(r);function u(t){var r=e.map((function(r,a){return function(t,r){return-1!==n.indexOf(t)&&1!==e[t]?"".concat(e[t]," - ").concat(r[t]," - 1"):"".concat(r[t])}(a,t)})),a=r.join(","),o=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(o,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(c," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return u(t)}(a.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(function(t){return t[r-1]="("+t[r-1]+" + 1)",u(t)}(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(t){return t[r-2]="("+t[r-2]+" + 1)",u(t)}(a.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(function(t){return t[r-1]="("+t[r-1]+" + 1)",t[r-2]="("+t[r-2]+" + 1)",u(t)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")};var es={kernelName:u.Reverse,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.dims,i=a.shape.length,c=u.util.parseAxisParam(o,a.shape);if(0===i)return Pr({inputs:{x:a},backend:n});var s=Object(u.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ts(a.shape,c):new $u(a.shape,c);return n.runWebGLProgram(s,[a],a.dtype)}},ns=function t(e,n){Object(h.a)(this,t),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=e[1],a=e[2];this.outputShape=e;var o="";o="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(o,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},rs={kernelName:u.RotateWithOffset,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.image,o=n.radians,i=n.fillValue,c=n.center,l=r,d=new ns(a.shape,i),f=u.backend_util.getImageCenter(c,a.shape[1],a.shape[2]),p=Object(s.a)(f,2),h=[[p[0],p[1],Math.sin(o),Math.cos(o)]];return l.runWebGLProgram(d,[a],a.dtype,h)}},as=Kr({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),os={kernelName:u.Round,backendName:"webgl",kernelFunc:as},is=Kr({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Wn}),cs={kernelName:u.Rsqrt,backendName:"webgl",kernelFunc:is},us=function t(e,n,r,a,o,i){Object(h.a)(this,t),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var c=we(o.length),u=we(i.length),s="";1===r?s="i":2===r&&(s="i, j");var l="getIndices(".concat(s,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var f="getUpdates(".concat(d,")"),p=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(c," strides = ").concat(c,"(").concat(o,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(p,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(f,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")};var ss={kernelName:u.ScatterNd,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.indices,o=e.updates,i=r.shape,c=u.backend_util.calculateShapes(o,a,i),s=c.sliceRank,l=c.numUpdates,d=c.sliceSize,f=c.strides,p=c.outputSize,h=[p/d,d];if(0===p)return n.makeTensorInfo(i,a.dtype);var b=ra({inputs:{x:a},backend:n,attrs:{shape:[l,s]}}),m=ra({inputs:{x:o},backend:n,attrs:{shape:[l,d]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new us(l,s,b.shape.length,m.shape.length,f,h),y=n.runWebGLProgram(g,[m,b,v],m.dtype),x=ra({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),x}},ls=function t(e,n,r){var a,o;if(Object(h.a)(this,t),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)o="resRC",a="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],u=[],s=0;s<n.length;s++)u.push("".concat(i[s])),s<e&&c.push("".concat(i[s]));a=c.join(),o=u.join()}var l=we(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(o,"));\n        } else {\n          setOutput(getB(").concat(o,"));\n        }\n      }\n    ")};var ds={kernelName:u.Select,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.condition,a=e.t,o=e.e,i=new ls(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(i,[r,a,o],Object(u.upcastType)(a.dtype,o.dtype))}},fs=Kr({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(u.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(u.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),ps={kernelName:u.Selu,backendName:"webgl",kernelFunc:fs},hs=Kr({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),bs={kernelName:u.Sigmoid,backendName:"webgl",kernelFunc:hs},ms=Kr({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),vs={kernelName:u.Sign,backendName:"webgl",kernelFunc:ms},gs=Kr({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),ys={kernelName:u.Sin,backendName:"webgl",kernelFunc:gs},xs=Kr({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),Os={kernelName:u.Sinh,backendName:"webgl",kernelFunc:xs},ws=Kr({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),ks={kernelName:u.Softplus,backendName:"webgl",kernelFunc:ws},js={kernelName:u.SpaceToBatchND,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.blockShape,i=r.paddings;u.util.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var c=o.reduce((function(t,e){return t*e})),s=[[0,0]];s.push.apply(s,Object(f.a)(i));for(var l=1+o.length;l<a.shape.length;++l)s.push([0,0]);var d=[],p=Eu({inputs:{x:a},backend:n,attrs:{paddings:s,constantValue:0}}),h=u.backend_util.getReshaped(p.shape,o,c,!1),b=u.backend_util.getPermuted(h.length,o.length,!1),m=u.backend_util.getReshapedPermuted(p.shape,o,c,!1),v=ra({inputs:{x:p},backend:n,attrs:{shape:h}}),g=pa({inputs:{x:v},backend:n,attrs:{perm:b}}),y=ra({inputs:{x:g},backend:n,attrs:{shape:m}});return d.push(p),d.push(v),d.push(g),d.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),y}};var Ts={kernelName:u.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.indices,a=e.values,o=e.denseShape,i=e.defaultValue;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));var c=n.readSync(r.dataId),u=n.readSync(a.dataId),l=n.readSync(o.dataId),d=n.readSync(i.dataId)[0],f=qn(c,r.shape,r.dtype,u,a.dtype,l,d),p=Object(s.a)(f,5),h=p[0],b=p[1],m=p[2],v=p[3],g=p[4];return[n.makeTensorInfo(b,r.dtype,h),n.makeTensorInfo([b[0]],a.dtype,m),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(t){return Number(t)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};var Ss={kernelName:u.SparseReshape,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.inputIndices,a=e.inputShape,o=e.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));var i=Array.from(n.readSync(a.dataId)),c=n.readSync(r.dataId),u=Array.from(n.readSync(o.dataId)),l=Kn(c,r.shape,r.dtype,i,u),d=Object(s.a)(l,3),f=d[0],p=d[1],h=d[2];return[n.makeTensorInfo(p,r.dtype,f),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}};var Ns={kernelName:u.SparseSegmentMean,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,a=e.indices,o=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));var i=n.readSync(r.dataId),c=n.readSync(a.dataId),u=n.readSync(o.dataId),l=Xn(i,r.shape,r.dtype,c,u,!0),d=Object(s.a)(l,2),f=d[0],p=d[1];return n.makeTensorInfo(p,r.dtype,f)}};var Cs={kernelName:u.SparseSegmentSum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.data,a=e.indices,o=e.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));var i=n.readSync(r.dataId),c=n.readSync(a.dataId),u=n.readSync(o.dataId),l=Xn(i,r.shape,r.dtype,c,u),d=Object(s.a)(l,2),f=d[0],p=d[1];return n.makeTensorInfo(p,r.dtype,f)}};var Is={kernelName:u.SparseToDense,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.sparseIndices,o=e.sparseValues,i=e.defaultValue,c=r.outputShape,s=u.backend_util.calculateShapes(o,a,c),l=s.sliceRank,d=s.numUpdates,f=s.strides,p=s.outputSize,h=new us(d,l,a.shape.length,o.shape.length,f,[p,1],!1),b=n.runWebGLProgram(h,[o,a,i],o.dtype),m=ra({inputs:{x:b},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(b),m}};var Es={kernelName:u.SplitV,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.numOrSizeSplits,i=r.axis,c=u.util.parseAxisParam(i,a.shape)[0],s=u.backend_util.prepareSplitSize(a,o,c),l=a.shape.length,d=new Array(l).fill(0),p=a.shape.slice();return s.map((function(t){var e=Object(f.a)(p);e[c]=t;var r=so({inputs:{x:a},backend:n,attrs:{begin:d,size:e}});return d[c]+=t,r}))}},As=Kr({opSnippet:"return sqrt(x);"}),Rs={kernelName:u.Sqrt,backendName:"webgl",kernelFunc:As},_s=Kr({opSnippet:"return x * x;"}),Fs={kernelName:u.Square,backendName:"webgl",kernelFunc:_s},Ds="return (a - b) * (a - b);",Ms=Xr({opSnippet:Ds,packedOpSnippet:Ds}),Ps={kernelName:u.SquaredDifference,backendName:"webgl",kernelFunc:Ms};var Ls={kernelName:u.Step,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,o=pr+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),i=new fr(a.shape,o);return r.runWebGLProgram(i,[a],a.dtype)}},Bs=function t(e,n,r){Object(h.a)(this,t),this.variableNames=["x"],this.outputShape=r;var a=r.length,o=we(r.length),i=we(r.length),c="";if(1===a)c="coords * strides + begin";else{var u=0;c=r.map((function(t,e){return u++,1===r.length?"coords * strides[".concat(e,"] + begin[").concat(e,"]"):"coords[".concat(u-1,"] * strides[").concat(e,"] + begin[").concat(e,"]")})).join(",")}this.userCode="\n      ".concat(o," begin = ").concat(o,"(").concat(e,");\n      ").concat(o," strides = ").concat(o,"(").concat(n,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(c,"));\n      }\n    ")};var Vs={kernelName:u.StridedSlice,backendName:"webgl",kernelFunc:function(t){var e,n=t.inputs,r=t.backend,a=t.attrs,o=n.x,i=a.begin,c=a.end,s=a.strides,l=a.beginMask,d=a.endMask,f=a.ellipsisMask,p=a.newAxisMask,h=a.shrinkAxisMask,b=u.slice_util.sliceInfo(o.shape,i,c,s,l,d,f,p,h),m=b.nonStrided,v=b.$begin,g=b.$strides,y=b.size,x=b.newShape,O=b.outShape,w=ra({inputs:{x:o},backend:r,attrs:{shape:x}});if(m){var k=so({inputs:{x:w},backend:r,attrs:{begin:v,size:y}});e=ra({inputs:{x:k},backend:r,attrs:{shape:O}}),r.disposeIntermediateTensorInfo(k)}else if(O.some((function(t){return 0===t})))e=r.makeTensorInfo(O,o.dtype,[]);else{if(r.shouldExecuteOnCPU([w])){var j=r.texData.get(w.dataId).values,T=Object(u.buffer)(w.shape,w.dtype,j),S=Yn(O,T,g,v);e=r.makeTensorInfo(O,w.dtype,S.values)}else{var N=new Bs(v,g,O);e=r.runWebGLProgram(N,[w],w.dtype)}}var C=ra({inputs:{x:e},backend:r,attrs:{shape:O}});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(e),C}};var zs={kernelName:u.StringNGrams,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=r.separator,o=r.nGramWidths,i=r.leftPad,c=r.rightPad,u=r.padWidth,l=r.preserveShortSequences,d=e.data,f=e.dataSplits,p=n.readSync(d.dataId),h=n.readSync(f.dataId),b=Qn(p,h,a,o,i,c,u,l),m=Object(s.a)(b,2),v=m[0],g=m[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(f.shape,"int32",g)]}};var Us={kernelName:u.StringSplit,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.skipEmpty,a=e.input,o=e.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));var i=n.readSync(a.dataId),c=n.readSync(o.dataId)[0],u=Zn(i,c,r),l=Object(s.a)(u,3),d=l[0],f=l[1],p=l[2],h=f.length;return[n.makeTensorInfo([h,2],"int32",d),n.makeTensorInfo([h],"string",f),n.makeTensorInfo([2],"int32",new Int32Array(p))]}};var Ws={kernelName:u.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs.numBuckets,a=e.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var o=n.readSync(a.dataId),i=Jn(o,r);return n.makeTensorInfo(a.shape,"int32",i)}},Gs=Kr({opSnippet:"return tan(x);"}),Hs={kernelName:u.Tan,backendName:"webgl",kernelFunc:Gs},qs=Kr({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Ks={kernelName:u.Tanh,backendName:"webgl",kernelFunc:qs},Xs=function t(e,n){Object(h.a)(this,t),this.variableNames=["A"];for(var r=new Array(e.length),a=0;a<r.length;a++)r[a]=e[a]*n[a];this.outputShape=r,this.rank=r.length;var o=we(this.rank),i=function(t){var e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<t.length;a++)r.push("imod(".concat(n[a],", ").concat(t[a],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")};function Ys(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.reps;if("string"===a.dtype||a.shape.length>5){var i=n.readSync(a.dataId),c="string"===a.dtype?i.map((function(t){return u.util.decodeString(t)})):i,s=Object(u.buffer)(a.shape,a.dtype,c),l=tr(s,o);return n.makeTensorInfo(l.shape,l.dtype,l.values)}var d=new Xs(a.shape,o);return n.runWebGLProgram(d,[a],a.dtype)}var Qs={kernelName:u.Tile,backendName:"webgl",kernelFunc:Ys},Zs=function t(e){Object(h.a)(this,t),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "},Js=function t(e){Object(h.a)(this,t),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "};function $s(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function tl(t){for(var e=1;e<t;)e*=2;return e}var el={kernelName:u.TopK,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=r.k,i=r.sorted,c=Object(u.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Object(u.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),d=a.shape,f=d[d.length-1];if(n.shouldExecuteOnCPU([a])||f<c||o>l){var p=n.readSync(a.dataId),h=er(p,d,a.dtype,o,i),b=Object(s.a)(h,2),m=b[0],v=b[1];return[n.makeTensorInfo(m.shape,m.dtype,m.values),n.makeTensorInfo(v.shape,v.dtype,v.values)]}if(0===o)return d[d.length-1]=0,[n.makeTensorInfo(d,a.dtype,[]),n.makeTensorInfo(d,"int32",[])];if(1===f)return[a,Ui({attrs:{shape:d,dtype:"int32",value:0},backend:n})];var g=n.texData.get(a.dataId),y=null!==g&&g.isPacked,x=y?n.unpackTensor(a):a,O=u.util.sizeFromShape(d)/f,w=ra({inputs:{x:x},attrs:{shape:[O,f]},backend:n});y&&$s(n,x);for(var k=tl(o),j=tl(f),T=null,S=function(){return null===T?[w,w]:[w,T]},N=function(t,e,r){var a=S(),o=new Zs(r),i=[[f],[null===T?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],c=T;T=n.runWebGLProgram(o,a,"int32",i),$s(n,c)},C=1;C<k;C*=2)for(var I=2*C,E=C;E>=1;E/=2)N(I,E,[O,j]);for(var A=j;A>k;A/=2){var R=S(),_=new Js([O,A/2]),F=[[f],[null===T?1:0],[k]],D=T;T=n.runWebGLProgram(_,R,"int32",F),$s(n,D);for(var M=k/2,P=2*M,L=M;L>=1;L/=2)N(P,L,T.shape)}var B=T;T=so({inputs:{x:T},backend:n,attrs:{begin:0,size:[O,o]}}),$s(n,B);var V=ic({inputs:{x:w,indices:T},backend:n,attrs:{axis:1,batchDims:1}});$s(n,w);var z=d.slice(0,-1);z.push(o),B=T,T=ra({inputs:{x:T},attrs:{shape:z},backend:n}),$s(n,B);var U=V;return V=ra({inputs:{x:V},attrs:{shape:z},backend:n}),$s(n,U),[V,T]}},nl=function t(e,n,r,a,o,i){Object(h.a)(this,t),this.variableNames=["Image","Transforms"],this.outputShape=i;var c,u="nearest"===r?1:2;switch(a){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(c," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(c," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(c," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(o,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(o,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")};var rl={kernelName:u.Transform,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.image,o=e.transforms,i=r.interpolation,c=r.fillMode,u=r.fillValue,l=r.outputShape,d=Object(s.a)(a.shape,4),f=d[0],p=d[1],h=d[2],b=d[3],m=null!=l?l:[p,h],v=Object(s.a)(m,2),g=v[0],y=v[1],x=new nl(p,h,i,c,u,[f,g,y,b]);return n.runWebGLProgram(x,[a,o],"float32")}};var al={kernelName:u.Unique,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=n.axis,o=e.x;Ot(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var i=r.readSync(o.dataId),c=rr(i,a,o.shape,o.dtype),u=c.outputValues,s=c.outputShape,l=c.indices;return[r.makeTensorInfo(s,o.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var ol={kernelName:u.Unpack,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.value,o=r.axis;o<0&&(o+=a.shape.length);for(var i=a,c=i.shape.length,u=a.shape[o],s=new Array(c-1),l=0,d=0;d<c;d++)d!==o&&(s[l++]=i.shape[d]);var f=[],p=new Array(c).fill(0),h=i.shape.slice();h[o]=1;for(var b=new Array(u),m=0;m<b.length;m++){p[o]=m;var v=so({inputs:{x:i},backend:n,attrs:{begin:p,size:h}}),g=ra({inputs:{x:v},backend:n,attrs:{shape:s}});b[m]=g,f.push(v)}return f.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),b}},il=function t(e,n){Object(h.a)(this,t),this.variableNames=["x","segmentIds"];var r=e.windowSize,a=e.batchSize,o=e.inSize,i=e.numSegments,c=i*Math.ceil(o/r);this.outputShape=[a,c];var u=4*Math.floor(r/4),s=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",d="";o%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      "));var f="";o%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(f,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")};for(var cl=0,ul=[Mc,Lc,ma,ga,xa,wa,Ta,Ca,Ia,Ea,Ma,Pa,Ba,za,Ha,Wa,Ka,Za,Qa,to,eo,no,oo,fo,po,go,Oo,jo,No,Vr,Do,qo,Ko,zo,Yo,Qo,Xo,Jo,ti,ni,ii,ci,si,bi,mi,fi,gi,xi,wi,ji,Ti,Ni,Ii,Ri,Fi,Pi,Vi,Gi,qi,Yi,Zi,tc,ec,nc,ac,cc,sc,dc,Lr,fc,Ro,hc,mc,gc,Wr,xc,wc,kc,Nc,Tc,Ic,Ac,_c,Vc,Gc,Wc,Kc,Xc,Yc,Uc,Qc,Zc,$c,nu,au,pu,na,bu,vu,yu,Ou,bo,ku,Su,Nu,Au,_u,qr,Fu,Mu,vo,cu,Lu,Uu,Vu,aa,Hu,Ku,Qu,Ju,es,rs,os,cs,ss,ds,ps,bs,vs,ys,Os,lo,fu,ks,js,Ts,Ss,Ns,Cs,Is,Es,Rs,Fs,Ps,Ls,Vs,zs,Us,Ws,lu,fa,Hs,Ks,Qs,el,rl,ha,al,ol,{kernelName:u.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=e.segmentIds,i=r.numSegments,c=a.shape.length,s=[],l=0,d=u.backend_util.getAxesPermutation([l],c),f=a;null!=d&&(f=pa({inputs:{x:a},backend:n,attrs:{perm:d}}),s.push(f),l=u.backend_util.getInnerMostAxes(1,c)[0]);var p=u.backend_util.segment_util.computeOutShape(f.shape,l,i),h=u.util.sizeFromShape([f.shape[l]]),b=ra({inputs:{x:f},backend:n,attrs:{shape:[-1,h]}});s.push(b);var m=ra({inputs:{x:function t(e,r,a,o,i){var c=e.shape[0],l=e.shape[1],d=u.backend_util.segment_util.segOpComputeOptimalWindowSize(l,i),f=new il({windowSize:d,inSize:l,batchSize:c,numSegments:i},r),p=n.compileAndRun(f,[e,a],o);if(s.push(p),p.shape[1]===i)return p;var h=Du({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),b=Ys({inputs:{x:h},backend:n,attrs:{reps:[l/d]}});return s.push(h),s.push(b),t(p,r,b,o,i)}(b,"unsortedSegmentSum",o,Object(u.sumOutType)(a.dtype),i)},backend:n,attrs:{shape:p}}),v=m;if(null!=d){s.push(m);var g=u.backend_util.getUndoAxesPermutation(d);v=pa({inputs:{x:v},backend:n,attrs:{perm:g}})}return s.forEach((function(t){return n.disposeIntermediateTensorInfo(t)})),v}},Tu];cl<ul.length;cl++){var sl=ul[cl];Object(u.registerKernel)(sl)}}])]);
//# sourceMappingURL=3.d233d165.chunk.js.map