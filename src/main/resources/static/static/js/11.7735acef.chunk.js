(this["webpackJsonpstudent-monitoring"]=this["webpackJsonpstudent-monitoring"]||[]).push([[11],{324:function(e,t){},325:function(e,t){},334:function(e,t){},480:function(e,t,n){"use strict";n.r(t);var s=n(70),c=n(73),a=n(81),o=n(80),r=n(75),i=n.n(r),l=n(76),d=n(94),j=n(1),m=n(5),u=n.n(m),b=n(0);function g(e){return Object(b.jsxs)("div",{className:"col-md-5 col-sm-12 p-2 attendance-card card-online m-2",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(b.jsx)("span",{className:"text-2xl",children:e.data.attendance_title}),Object(b.jsx)("br",{}),Object(b.jsx)("span",{style:{color:"gray"},children:e.data.attendance_id})]}),Object(b.jsxs)("div",{className:"col-md-6 col-sm-12 sgs-right",children:["Status : ","true"===e.data.status?"online":"offline"]})]}),Object(b.jsx)("hr",{}),Object(b.jsx)("br",{}),Object(b.jsxs)("p",{children:["\xa0\xa0\xa0\xa0",e.data.attendance_desc]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("span",{className:"text-gray-500",children:"You've already done this."})})]})}function x(e){return Object(b.jsxs)("div",{className:"col-md-5 col-sm-12 p-2 attendance-card card-offline m-2",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(b.jsx)("span",{className:"text-2xl",children:e.data.attendance_title}),Object(b.jsx)("br",{}),Object(b.jsx)("span",{style:{color:"gray"},children:e.data.attendance_id})]}),Object(b.jsxs)("div",{className:"col-md-6 col-sm-12 sgs-right text-green-500",children:["Status : ","true"===e.data.status?"online":"offline",Object(b.jsx)("br",{}),"Type : ","once"===e.data.type?"Once":"Continuous"]})]}),Object(b.jsx)("hr",{}),Object(b.jsx)("br",{}),Object(b.jsxs)("p",{children:["\xa0\xa0\xa0\xa0",e.data.attendance_desc]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-right",children:Object(b.jsxs)("button",{type:"button",onClick:function(){sessionStorage.setItem("attnId",e.data.attendance_id),sessionStorage.setItem("atn_type",e.data.type)},className:"btn btn-success open-once-attn",style:{marginRight:"15px",marginBottom:"10px"},children:[Object(b.jsx)("i",{className:"material-icons small",children:"play_arrow"})," Mark Attendance"]})})]})}var h=n(12),p=(n(18),n(9)),O=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),v=sessionStorage.getItem("registerNo"),f=null;u.a.get(p.ip+"api/student-details/get?class_group="+O+"&register_no="+v,(function(e,t){f=e[0].name.toUpperCase()}));var y=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e){var c;return Object(s.a)(this,n),(c=t.call(this)).state={meet:null},u.a.get(p.ip+"api/meet/get-meets?class_group="+O,(function(e,t){"success"===t&&c.setState({meet:e})})).fail((function(){u.a.toaster("Request Failed...","","danger")})),c}return Object(c.a)(n,[{key:"render",value:function(){return this.state.meet?Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"meet-create-div",children:[Object(b.jsx)("h3",{className:"text-xl sgs-center",children:"Available Meetings"}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{className:"row sgs-center",children:[Object(b.jsx)("div",{className:"col-sm-4 ",style:{color:"gray"},children:"Meet Name"}),Object(b.jsx)("div",{className:"col-sm-4 hide-onphone",style:{color:"gray"},children:"Description"}),Object(b.jsx)("div",{className:"col-sm-4"})]}),this.state.meet.map((function(e,t){return Object(b.jsx)(N,{data:e},t)}))]})}):Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{class:"text-center",children:Object(b.jsx)("div",{class:"spinner-border",role:"status",children:Object(b.jsx)("span",{class:"sr-only",children:"Loading..."})})})})}}]),n}(j.Component);function N(e){return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"row meet-list sgs-center",children:[Object(b.jsx)("div",{className:"col-sm-4",children:e.data.title}),Object(b.jsx)("div",{className:"col-sm-4",children:e.data.desc}),Object(b.jsx)("div",{className:"col-sm-4",children:Object(b.jsxs)("button",{onClick:function(){return function(){var t="https://simclair-sms.azurewebsites.net/build?groupId="+e.data.meet_id+"&name="+v+"%20"+(f||"Student")+"&auth=bmkfbvf224vgcbhb7vjsv45vfnnmbd";window.open(t,"_blank").focus()}()},style:{marginRight:"10px"},type:"button",id:"join-meet",className:"btn btn-success",children:[Object(b.jsx)("i",{style:{marginRight:"6px"},className:"material-icons small left",children:"send"}),"Join"]})})]})})}n(65),n(316),n(471);var w,I,k,E,_,S,L,B=n(357),C=0,T=0;function A(){return Object(b.jsx)("div",{id:"once-atn-modal",className:"modal font-roboto",children:Object(b.jsxs)("div",{className:"modal-content",children:[Object(b.jsxs)("div",{className:"modal-container sgs-center",children:[Object(b.jsx)("span",{className:"text-xl",children:"Single Attendance"}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{children:[Object(b.jsx)("span",{style:{fontSize:"12px"},className:"hide-onpc text-gray-500",children:"Use Landscape mode for better performance"}),Object(b.jsxs)("div",{style:{color:"white",margin:"0 auto"},children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("video",{id:"video",style:{display:"none"},autoPlay:!0}),Object(b.jsx)("canvas",{id:"canvas",width:"600px",height:"400px",style:{margin:"0 auto"}}),Object(b.jsx)("br",{})]})}),Object(b.jsxs)("span",{children:["Face count : ",Object(b.jsx)("span",{id:"span-count",children:C})]}),Object(b.jsx)("br",{}),Object(b.jsx)("button",{onClick:function(){!function(){if(1===C){var e=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),t=sessionStorage.getItem("registerNo"),n=sessionStorage.getItem("attnId");u.a.get(p.ip+"api/attn/give-attendance?class_group="+e+"&register_no="+t+"&attendance_id="+n,(function(e,t){"success"===t&&u.a.toaster(e,"","success"),setTimeout((function(){R(),document.getElementById("once-atn-modal").style.display="none",window.location.reload()}),800)}))}else 0===C?u.a.toaster("No face detected","","danger"):C>1&&u.a.toaster("More than 1 face detected..","","warning")}()},className:"btn btn-success",children:"Give Attendance"})]})]})]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("button",{id:"close-once-atn-modal",className:"btn btn-danger",children:"Close"})})]})})}function F(){return Object(b.jsx)("div",{id:"cont-atn-modal",className:"modal font-roboto",children:Object(b.jsxs)("div",{className:"modal-content",children:[Object(b.jsxs)("div",{className:"modal-container sgs-center",children:[Object(b.jsx)("span",{className:"text-xl",children:"Continuous Monitoring"}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{children:[Object(b.jsx)("span",{style:{fontSize:"12px"},className:"hide-onpc text-gray-500",children:"Use Landscape mode for better performance"}),Object(b.jsxs)("div",{style:{color:"white",margin:"0 auto"},children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("video",{id:"cvideo",style:{display:"none"},autoPlay:!0}),Object(b.jsx)("canvas",{id:"ccanvas",width:"600px",height:"400px",style:{margin:"0 auto"}}),Object(b.jsx)("br",{})]})}),Object(b.jsxs)("span",{children:["Face count : ",Object(b.jsx)("span",{id:"cspan-count",children:T})]}),Object(b.jsx)("br",{})]})]})]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("button",{id:"close-cont-atn-modal",className:"btn btn-danger",children:"Exit"})})]})})}function R(){try{clearInterval(w);var e,t=document.getElementById("video"),n=Object(d.a)(t.srcObject.getTracks());try{for(n.s();!(e=n.n()).done;){e.value.stop()}}catch(s){n.e(s)}finally{n.f()}t.srcObject=null,L.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()}))}catch(c){console.log("Exception at closing/stop video from webcam - once")}}function M(){try{clearInterval(I),clearInterval(k);var e,t=document.getElementById("cvideo"),n=Object(d.a)(t.srcObject.getTracks());try{for(n.s();!(e=n.n()).done;){e.value.stop()}}catch(s){n.e(s)}finally{n.f()}t.srcObject=null,S.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()}))}catch(c){console.log("Exception at closing/stop video from webcam - cont")}}function G(){var e,t=document.getElementById("cvideo"),n=document.getElementById("ccanvas").getContext("2d");_=function(){var s=Object(l.a)(i.a.mark((function s(){var c;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,e.estimateFaces(t,!1);case 3:c=s.sent,T=c.length,document.getElementById("cspan-count").innerText=T,n.drawImage(t,0,0,600,400),c.forEach((function(e){n.beginPath(),n.lineWidth="3",n.strokeStyle="green",n.rect(e.topLeft[0],e.topLeft[1],e.bottomRight[0]-e.topLeft[0],e.bottomRight[1]-e.topLeft[1]),n.stroke()})),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(0),console.log("Exception occured at face detection");case 13:case"end":return s.stop()}}),s,null,[[0,10]])})));return function(){return s.apply(this,arguments)}}(),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:600,height:400}}).then((function(e){S=e,t.srcObject=e})),t.addEventListener("loadeddata",Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.load();case 2:e=t.sent,_();case 4:case"end":return t.stop()}}),t)})))),setTimeout((function(){I=setInterval((function(){_()}),200)}),2e3),setTimeout((function(){k=setInterval((function(){!function(){console.log("2mins interval faces-"+T);var e=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),t=sessionStorage.getItem("registerNo"),n=sessionStorage.getItem("attnId");T>0?u.a.get(p.ip+"/api/attn/count-cont?class_group="+e+"&attn_id="+n+"&register_no="+t,(function(e,t){"success"===t&&("continue"===e?console.log("cont - continue"):"stop"===e&&(u.a.toaster("Attendance Ended and Submitted Successfully","","success"),setTimeout((function(){document.getElementById("cont-atn-modal").style.display="none",M(),window.location.reload()}),1500)))})).fail((function(){u.a.toaster("Attendance failed...","","danger")})):0===T?u.a.toaster("No face detected","","warning"):u.a.toaster("Attendance failed...","","danger")}()}),12e4)}),2500)}var P=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e){var c;Object(s.a)(this,n),(c=t.call(this)).state={data:null};var a=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),o=sessionStorage.getItem("registerNo");return u.a.get(p.ip+"api/attn/get-enabled?class_group="+a+"&register_no="+o,(function(e,t){"success"===t&&c.setState({data:e})})),c}return Object(c.a)(n,[{key:"render",value:function(){if(this.state.data){u()(document).ready((function(){var e=document.getElementById("once-atn-modal"),t=document.getElementsByClassName("open-once-attn")[0],n=document.getElementById("close-once-atn-modal");t&&(t.onclick=function(){u.a.toaster("Please wait...","","success"),setTimeout((function(){"once"===sessionStorage.getItem("atn_type")?(!function(){var e,t=document.getElementById("video"),n=document.getElementById("canvas").getContext("2d");E=function(){var s=Object(l.a)(i.a.mark((function s(){var c;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,e.estimateFaces(t,!1);case 3:c=s.sent,C=c.length,document.getElementById("span-count").innerText=C,n.drawImage(t,0,0,600,400),c.forEach((function(e){n.beginPath(),n.lineWidth="3",n.strokeStyle="green",n.rect(e.topLeft[0],e.topLeft[1],e.bottomRight[0]-e.topLeft[0],e.bottomRight[1]-e.topLeft[1]),n.stroke()})),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(0),console.log("Exception occured at face detection");case 13:case"end":return s.stop()}}),s,null,[[0,10]])})));return function(){return s.apply(this,arguments)}}(),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:600,height:400}}).then((function(e){L=e,t.srcObject=e})),t.addEventListener("loadeddata",Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.load();case 2:e=t.sent,E();case 4:case"end":return t.stop()}}),t)})))),setTimeout((function(){w=setInterval((function(){E()}),200)}),2e3)}(),e.style.display="block"):(G(),document.getElementById("cont-atn-modal").style.display="block")}),1e3)},n.onclick=function(){R(),e.style.display="none"});var s=document.getElementById("cont-atn-modal");document.getElementById("close-cont-atn-modal").onclick=function(){M(),s.style.display="none"},window.onclick=function(t){t.target===e&&(M(),e.style.display="none",s.style.display="none")}}));var e=Object(b.jsxs)("div",{className:"sgs-center text-green-400",children:[Object(b.jsx)("img",{style:{margin:"0 auto"},alt:"mkce",className:"mkce-logo-dash",src:h.a}),Object(b.jsx)("br",{}),"No attendance available at the moment..."]});return this.state.data.length>0&&(e=this.state.data.map((function(e,t){return"present"===e.atn_status?Object(b.jsx)(g,{data:e},t):Object(b.jsx)(x,{data:e},t)}))),Object(b.jsxs)("div",{className:"dashboard-cont",children:[Object(b.jsx)("div",{children:Object(b.jsx)("span",{className:"text-2xl",children:"Dashboard"})}),Object(b.jsx)(F,{}),Object(b.jsx)(A,{}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col-md-4 col-sm-12",children:Object(b.jsx)(y,{})}),Object(b.jsxs)("div",{className:"col-md-8 col-sm-12 meet-create-div",children:[Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("span",{className:"text-xl",children:"Available Attendance"})}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"row font-roboto",children:e})]})]})]})}return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{class:"text-center",children:Object(b.jsx)("div",{class:"spinner-border",role:"status",children:Object(b.jsx)("span",{class:"sr-only",children:"Loading..."})})})})}}]),n}(j.Component);t.default=P}}]);
//# sourceMappingURL=11.7735acef.chunk.js.map