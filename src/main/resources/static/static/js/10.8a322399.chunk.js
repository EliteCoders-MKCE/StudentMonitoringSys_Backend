(this["webpackJsonpstudent-monitoring"]=this["webpackJsonpstudent-monitoring"]||[]).push([[10],{324:function(e,t){},325:function(e,t){},334:function(e,t){},479:function(e,t,n){"use strict";n.r(t);var a=n(71),c=n(73),s=n(83),o=n(82),r=n(75),i=n.n(r),d=n(76),l=n(94),j=n(1),u=n(5),m=n.n(u),b=n(0);function g(e){return Object(b.jsxs)("div",{className:"col-md-5 col-sm-12 p-2 attendance-card card-online m-2",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(b.jsx)("span",{className:"text-2xl",children:e.data.attendance_title}),Object(b.jsx)("br",{}),Object(b.jsx)("span",{style:{color:"gray"},children:e.data.attendance_id})]}),Object(b.jsxs)("div",{className:"col-md-6 col-sm-12 sgs-right",children:["Status : ","true"===e.data.status?"online":"offline"]})]}),Object(b.jsx)("hr",{}),Object(b.jsx)("br",{}),Object(b.jsxs)("p",{children:["\xa0\xa0\xa0\xa0",e.data.attendance_desc]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("span",{className:"text-gray-500",children:"You've already done this."})})]})}function x(e){return Object(b.jsxs)("div",{className:"col-md-5 col-sm-12 p-2 attendance-card card-offline m-2",children:[Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-md-6 col-sm-12",children:[Object(b.jsx)("span",{className:"text-2xl",children:e.data.attendance_title}),Object(b.jsx)("br",{}),Object(b.jsx)("span",{style:{color:"gray"},children:e.data.attendance_id})]}),Object(b.jsxs)("div",{className:"col-md-6 col-sm-12 sgs-right text-green-500",children:["Status : ","true"===e.data.status?"online":"offline",Object(b.jsx)("br",{}),"Type : ","once"===e.data.type?"Once":"Continuous"]})]}),Object(b.jsx)("hr",{}),Object(b.jsx)("br",{}),Object(b.jsxs)("p",{children:["\xa0\xa0\xa0\xa0",e.data.attendance_desc]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-right",children:Object(b.jsxs)("button",{type:"button",onClick:function(){sessionStorage.setItem("attnId",e.data.attendance_id),sessionStorage.setItem("atn_type",e.data.type)},className:"btn btn-success open-once-attn",style:{marginRight:"15px",marginBottom:"10px"},children:[Object(b.jsx)("i",{className:"material-icons small",children:"play_arrow"})," Mark Attendance"]})})]})}var h=n(12),p=(n(18),n(9));n(65),n(316),n(471);var f,O,v,y,N,I,w,k=n(357),E=0,S=0;function _(){return Object(b.jsx)("div",{id:"once-atn-modal",className:"modal font-roboto",children:Object(b.jsxs)("div",{className:"modal-content",children:[Object(b.jsxs)("div",{className:"modal-container sgs-center",children:[Object(b.jsx)("span",{className:"text-xl",children:"Single Attendance"}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{children:[Object(b.jsx)("span",{style:{fontSize:"12px"},className:"hide-onpc text-gray-500",children:"Use Landscape mode for better performance"}),Object(b.jsxs)("div",{style:{color:"white",margin:"0 auto"},children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("video",{id:"video",style:{display:"none"},autoPlay:!0}),Object(b.jsx)("canvas",{id:"canvas",width:"600px",height:"400px",style:{margin:"0 auto"}}),Object(b.jsx)("br",{})]})}),Object(b.jsxs)("span",{children:["Face count : ",Object(b.jsx)("span",{id:"span-count",children:E})]}),Object(b.jsx)("br",{}),Object(b.jsx)("button",{onClick:function(){!function(){if(1===E){var e=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),t=sessionStorage.getItem("registerNo"),n=sessionStorage.getItem("attnId");m.a.get(p.ip+"api/attn/give-attendance?class_group="+e+"&register_no="+t+"&attendance_id="+n,(function(e,t){"success"===t&&m.a.toaster(e,"","success"),setTimeout((function(){L(),document.getElementById("once-atn-modal").style.display="none",window.location.reload()}),800)}))}else 0===E?m.a.toaster("No face detected","","danger"):E>1&&m.a.toaster("More than 1 face detected..","","warning")}()},className:"btn btn-success",children:"Give Attendance"})]})]})]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("button",{id:"close-once-atn-modal",className:"btn btn-danger",children:"Close"})})]})})}function B(){return Object(b.jsx)("div",{id:"cont-atn-modal",className:"modal font-roboto",children:Object(b.jsxs)("div",{className:"modal-content",children:[Object(b.jsxs)("div",{className:"modal-container sgs-center",children:[Object(b.jsx)("span",{className:"text-xl",children:"Continuous Monitoring"}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{children:[Object(b.jsx)("span",{style:{fontSize:"12px"},className:"hide-onpc text-gray-500",children:"Use Landscape mode for better performance"}),Object(b.jsxs)("div",{style:{color:"white",margin:"0 auto"},children:[Object(b.jsx)("div",{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("br",{}),Object(b.jsx)("video",{id:"cvideo",style:{display:"none"},autoPlay:!0}),Object(b.jsx)("canvas",{id:"ccanvas",width:"600px",height:"400px",style:{margin:"0 auto"}}),Object(b.jsx)("br",{})]})}),Object(b.jsxs)("span",{children:["Face count : ",Object(b.jsx)("span",{id:"cspan-count",children:S})]}),Object(b.jsx)("br",{})]})]})]}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"sgs-center",children:Object(b.jsx)("button",{id:"close-cont-atn-modal",className:"btn btn-danger",children:"Exit"})})]})})}function L(){try{clearInterval(f);var e,t=document.getElementById("video"),n=Object(l.a)(t.srcObject.getTracks());try{for(n.s();!(e=n.n()).done;){e.value.stop()}}catch(a){n.e(a)}finally{n.f()}t.srcObject=null,w.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()}))}catch(c){console.log("Exception at closing/stop video from webcam - once")}}function T(){try{clearInterval(O),clearInterval(v);var e,t=document.getElementById("cvideo"),n=Object(l.a)(t.srcObject.getTracks());try{for(n.s();!(e=n.n()).done;){e.value.stop()}}catch(a){n.e(a)}finally{n.f()}t.srcObject=null,I.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()}))}catch(c){console.log("Exception at closing/stop video from webcam - cont")}}function C(){var e,t=document.getElementById("cvideo"),n=document.getElementById("ccanvas").getContext("2d");N=function(){var a=Object(d.a)(i.a.mark((function a(){var c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.estimateFaces(t,!1);case 3:c=a.sent,S=c.length,document.getElementById("cspan-count").innerText=S,n.drawImage(t,0,0,600,400),c.forEach((function(e){n.beginPath(),n.lineWidth="3",n.strokeStyle="green",n.rect(e.topLeft[0],e.topLeft[1],e.bottomRight[0]-e.topLeft[0],e.bottomRight[1]-e.topLeft[1]),n.stroke()})),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.log("Exception occured at face detection");case 13:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(){return a.apply(this,arguments)}}(),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:600,height:400}}).then((function(e){I=e,t.srcObject=e})),t.addEventListener("loadeddata",Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.load();case 2:e=t.sent,N();case 4:case"end":return t.stop()}}),t)})))),setTimeout((function(){O=setInterval((function(){N()}),200)}),2e3),setTimeout((function(){v=setInterval((function(){!function(){console.log("2mins interval faces-"+S);var e=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),t=sessionStorage.getItem("registerNo"),n=sessionStorage.getItem("attnId");S>0?m.a.get(p.ip+"/api/attn/count-cont?class_group="+e+"&attn_id="+n+"&register_no="+t,(function(e,t){"success"===t&&("continue"===e?console.log("cont - continue"):"stop"===e&&(m.a.toaster("Attendance Ended and Submitted Successfully","","success"),setTimeout((function(){document.getElementById("cont-atn-modal").style.display="none",T(),window.location.reload()}),1500)))})).fail((function(){m.a.toaster("Attendance failed...","","danger")})):0===S?m.a.toaster("No face detected","","warning"):m.a.toaster("Attendance failed...","","danger")}()}),12e4)}),2500)}var A=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var c;Object(a.a)(this,n),(c=t.call(this)).state={data:null};var s=sessionStorage.getItem("classGroup").toLowerCase().replace(/-/g,"_"),o=sessionStorage.getItem("registerNo");return m.a.get(p.ip+"api/attn/get-enabled?class_group="+s+"&register_no="+o,(function(e,t){"success"===t&&c.setState({data:e})})),c}return Object(c.a)(n,[{key:"render",value:function(){if(this.state.data){m()(document).ready((function(){var e=document.getElementById("once-atn-modal"),t=document.getElementsByClassName("open-once-attn")[0],n=document.getElementById("close-once-atn-modal");t&&(t.onclick=function(){m.a.toaster("Please wait...","","success"),setTimeout((function(){"once"===sessionStorage.getItem("atn_type")?(!function(){var e,t=document.getElementById("video"),n=document.getElementById("canvas").getContext("2d");y=function(){var a=Object(d.a)(i.a.mark((function a(){var c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.estimateFaces(t,!1);case 3:c=a.sent,E=c.length,document.getElementById("span-count").innerText=E,n.drawImage(t,0,0,600,400),c.forEach((function(e){n.beginPath(),n.lineWidth="3",n.strokeStyle="green",n.rect(e.topLeft[0],e.topLeft[1],e.bottomRight[0]-e.topLeft[0],e.bottomRight[1]-e.topLeft[1]),n.stroke()})),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.log("Exception occured at face detection");case 13:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(){return a.apply(this,arguments)}}(),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:600,height:400}}).then((function(e){w=e,t.srcObject=e})),t.addEventListener("loadeddata",Object(d.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.load();case 2:e=t.sent,y();case 4:case"end":return t.stop()}}),t)})))),setTimeout((function(){f=setInterval((function(){y()}),200)}),2e3)}(),e.style.display="block"):(C(),document.getElementById("cont-atn-modal").style.display="block")}),1e3)},n.onclick=function(){L(),e.style.display="none"});var a=document.getElementById("cont-atn-modal");document.getElementById("close-cont-atn-modal").onclick=function(){T(),a.style.display="none"},window.onclick=function(t){t.target===e&&(T(),e.style.display="none",a.style.display="none")}}));var e=Object(b.jsxs)("div",{className:"sgs-center text-green-400",children:[Object(b.jsx)("img",{style:{margin:"0 auto"},alt:"mkce",className:"mkce-logo-dash",src:h.a}),Object(b.jsx)("br",{}),"No attendance available at the moment..."]});return this.state.data.length>0&&(e=this.state.data.map((function(e,t){return"present"===e.atn_status?Object(b.jsx)(g,{data:e},t):Object(b.jsx)(x,{data:e},t)}))),Object(b.jsxs)("div",{className:"dashboard-cont ",children:[Object(b.jsx)("div",{children:Object(b.jsx)("span",{className:"text-2xl",children:"Dashboard"})}),Object(b.jsx)(B,{}),Object(b.jsx)(_,{}),Object(b.jsx)("br",{}),Object(b.jsx)("div",{className:"row font-roboto",children:e})]})}return Object(b.jsx)(b.Fragment,{children:"Loading..."})}}]),n}(j.Component);t.default=A}}]);
//# sourceMappingURL=10.8a322399.chunk.js.map